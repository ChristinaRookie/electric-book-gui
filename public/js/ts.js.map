{"version":3,"file":"ts.js","sources":["../../src/ts/APIWs.ts","../../src/ts/Context.ts","../../src/ts/Toast.ts","../../src/ts/Templates.ts","../../src/ts/querySelectorAll-extensions.ts","../../src/ts/Eventify.ts","../../src/ts/AddNewBookDialog.ts","../../src/ts/LoginTokenList.ts","../../src/ts/RepoMergeDirectButton.ts","../../src/ts/RepoDetailPage.ts","../../src/ts/ControlTag.ts","../../src/ts/FoundationRevealDialog.ts","../../src/ts/FileListDialog_Item.ts","../../src/ts/FileListDialog.ts","../../src/ts/PrintListenerTerminal.ts","../../src/ts/PrintListener.ts","../../src/ts/BoundFilename.ts","../../src/ts/EditorCodeMirror.ts","../../src/ts/DOM.ts","../../src/ts/EditorImage.ts","../../src/ts/FS/FS.ts","../../src/ts/ImageIdentify.ts","../../src/ts/RepoFileEditorCM.ts","../../src/ts/FS/FSFileEdit.ts","../../src/ts/RepoEditorPage_NewFileDialog.ts","../../src/ts/RepoEditorPage_RenameFileDialog.ts","../../src/ts/FS/FSNotify.ts","../../src/ts/FS/FSOverlay.ts","../../src/ts/FS/FSRemote.ts","../../src/ts/FS/Store.ts","../../src/ts/FS/FSSession.ts","../../src/ts/FS/FSReadCache.ts","../../src/ts/FSFileList_File.ts","../../src/ts/FSFileList.ts","../../src/ts/FS/File.ts","../../src/ts/FS/Directory.ts","../../src/ts/FS/FSPrimeFromJS.ts","../../src/ts/RepoEditorPage.ts","../../src/ts/conflict/FileStatus.ts","../../src/ts/conflict/File.ts","../../src/ts/conflict/FileList.ts","../../src/ts/conflict/FileDisplay.ts","../../src/ts/conflict/FileListDisplay.ts","../../src/ts/conflict/MergeEditorControlBar.ts","../../src/ts/conflict/MergeImageEditor.ts","../../src/ts/conflict/MergeEditor.ts","../../src/ts/conflict/MergeInstructions.ts","../../src/ts/CommitMessageDialog.ts","../../src/ts/conflict/ClosePRDialog.ts","../../src/ts/conflict/MergingInfo.ts","../../src/ts/conflict/SingleEditor.ts","../../src/ts/RepoConflictPage.ts","../../src/ts/MergeEditor.ts","../../src/ts/PRDiffModel.ts","../../src/ts/PullRequestDiffList_File.ts","../../src/ts/PullRequestMergePage.ts","../../src/ts/DOMInsert.ts","../../src/ts/RepoFileViewerFile.ts","../../src/ts/RepoFileViewerPage.ts","../../src/ts/EBW.ts"],"sourcesContent":["enum WSState {\n\tNull = 0,\n\tConnecting = 1,\n\tConnected = 2\n}\n\n\nexport class APIWs {\n\tprotected id: number;\n\tprotected url: string;\n\tprotected live:Map<number,[(...a:any[])=>void,(a:any)=>void]>;\n\tprotected queue: string[];\n\tprotected errorHandler: (a:any)=>void;\n\tprotected ws: WebSocket;\n\tprotected wsState: WSState;\n\n\tconstructor(path:string=\"/rpc/API/json/ws\", server:string=\"\") {\n\t\tif (\"\"== server) {\n\t\t\tserver = \"ws\" +\n\t\t\t\t (\"https:\" == document.location.protocol ? \"s\" : \"\") +\n\t\t\t\t \"://\" +\n\t\t\t\t document.location.host\n\t\t}\n\t\tthis.id = 0;\n\t\tthis.url = server+path;\n\t\tthis.live = new Map<number,[(...a:any[])=>void,(a:any)=>void]>();\n\t\tthis.queue = new Array<string>();\n\t\tthis.setRPCErrorHandler(null);\n\t\tthis.wsState = WSState.Null;\n\t\tthis.startWs();\n\t}\t\n\tsetRPCErrorHandler(handler?:(a:any)=>void) :void {\n\t\tthis.errorHandler = handler;\n\t}\n\treject(reject:(a:any)=>void,err:Error):void {\n\t\tif (this.errorHandler) {\n\t\t\tthis.errorHandler(err);\n\t\t}\n\t\treject(err);\n\t\treturn;\n\t}\n\tstartWs():void {\n\t\tif (this.wsState!=WSState.Null) {\n\t\t\treturn;\n\t\t}\n\t\tthis.wsState = WSState.Connecting;\n\n\t\tthis.ws = new WebSocket(this.url);\n\t\tthis.ws.onmessage = (evt)=> {\n\t\t\tlet res:any = JSON.parse(evt.data);\n\t\t\tif (undefined == res || undefined==res.id) {\n\t\t\t\tconsole.error(`Failed to parse response: ${evt.data}`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet id = res.id as number;\n\t\t\tlet promises = this.live.get(id);\n\t\t\tif (! promises) {\n\t\t\t\tconsole.error(`Failed to find promise for ${evt.data}`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.live.delete(id);\n\t\t\tlet [resolve,reject] = promises;\n\n\t\t\tif (res.error) {\n\t\t\t\tthis.reject(reject, res.error);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (res.result) {\n\t\t\t\tresolve(res.result);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresolve(undefined);\n\t\t};\n\t\tthis.ws.onerror = (err)=> {\n\t\t\tconsole.error(\"ERROR on websocket:\", err);\n\t\t\tthis.wsState = WSState.Null;\n\t\t};\n\t\tthis.ws.onopen = (evt)=> {\n\t\t\tthis.wsState = WSState.Connected;\n\t\t\tconsole.log(\"Connected websocket\");\n\t\t\tfor (let q of this.queue) {\n\t\t\t\tthis.ws.send(q);\n\t\t\t}\n\t\t\tconsole.log(`Emptied queue of ${this.queue.length} queued messages`);\n\t\t\tthis.queue = [];\n\t\t};\n\t\tthis.ws.onclose = (evt)=> {\n\t\t\tconsole.log(\"Websocket closed - attempting reconnect in 1s\");\n\t\t\tthis.wsState = WSState.Null;\n\t\t\tsetTimeout( ()=> this.startWs(), 1000 );\n\t\t}\n\t}\n\trpc(method:string, params:any[]) {\n\t\tlet id = this.id++;\n\t\t// // params comes in as an 'arguments' object, so we need to convert\n\t\t// // it to an array\n\t\t// params = Array.prototype.slice.call(params);\n\t\t// // let p = [];\n\t\t// // for (let i=0; i<p.length; i++) {\n\t\t// // \tp[i] = params[i]\n\t\t// // }\n\n\t\tlet data = JSON.stringify({ id:id, method:method, params:params });\n\t\tthis.live.set(id, [undefined,undefined]);\n\t\treturn new Promise( (resolve:(...a:any[])=>void,reject:(a:any)=>void)=> {\n\t\t\tif (this.wsState==WSState.Null) {\n\t\t\t\tthis.startWs();\n\t\t\t}\n\t\t\tthis.live.set(id,[resolve,reject]);\n\t\t\tif ((this.wsState == WSState.Connected) && (1==this.ws.readyState)) {\n\t\t\t\tthis.ws.send(data);\n\t\t\t} else {\n\t\t\t\tthis.queue.push(data);\n\t\t\t}\n\t\t});\n\t}\n\n\t\n\tVersion () {\n\t\treturn this.rpc(\"Version\",  [] );\n\t}\n\t\n\tRenameFile (repoOwner:string,repoName:string,fromPath:string,toPath:string) {\n\t\treturn this.rpc(\"RenameFile\",  [repoOwner,repoName,fromPath,toPath] );\n\t}\n\t\n\tRemoveFile (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"RemoveFile\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tListFiles (repoOwner:string,repoName:string,pathregex:string) {\n\t\treturn this.rpc(\"ListFiles\",  [repoOwner,repoName,pathregex] );\n\t}\n\t\n\tFileExists (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"FileExists\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tListAllRepoFiles (repoOwner:string,repoName:string) {\n\t\treturn this.rpc(\"ListAllRepoFiles\",  [repoOwner,repoName] );\n\t}\n\t\n\tGetFile (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"GetFile\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tGetFileString (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"GetFileString\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tUpdateFile (repoOwner:string,repoName:string,path:string,content:string) {\n\t\treturn this.rpc(\"UpdateFile\",  [repoOwner,repoName,path,content] );\n\t}\n\t\n\tStageFile (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"StageFile\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tIsRepoConflicted (repoOwner:string,repoName:string) {\n\t\treturn this.rpc(\"IsRepoConflicted\",  [repoOwner,repoName] );\n\t}\n\t\n\tStageFileAndReturnMergingState (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"StageFileAndReturnMergingState\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tSaveWorkingFile (repoOwner:string,repoName:string,path:string,content:string) {\n\t\treturn this.rpc(\"SaveWorkingFile\",  [repoOwner,repoName,path,content] );\n\t}\n\t\n\tListPullRequests (repoOwner:string,repoName:string) {\n\t\treturn this.rpc(\"ListPullRequests\",  [repoOwner,repoName] );\n\t}\n\t\n\tPullRequestDiffList (repoOwner:string,repoName:string,prNumber:number) {\n\t\treturn this.rpc(\"PullRequestDiffList\",  [repoOwner,repoName,prNumber] );\n\t}\n\t\n\tPullRequestVersions (repoOwner:string,repoName:string,remoteUrl:string,remoteSha:string,filePath:string) {\n\t\treturn this.rpc(\"PullRequestVersions\",  [repoOwner,repoName,remoteUrl,remoteSha,filePath] );\n\t}\n\t\n\tPullRequestUpdate (repoOwner:string,repoName:string,remoteSHA:string,filePath:string,data:string) {\n\t\treturn this.rpc(\"PullRequestUpdate\",  [repoOwner,repoName,remoteSHA,filePath,data] );\n\t}\n\t\n\tCommit (repoOwner:string,repoName:string,message:string) {\n\t\treturn this.rpc(\"Commit\",  [repoOwner,repoName,message] );\n\t}\n\t\n\tCommitAll (repoOwner:string,repoName:string,message:string,notes:string) {\n\t\treturn this.rpc(\"CommitAll\",  [repoOwner,repoName,message,notes] );\n\t}\n\t\n\tCommitOnly (repoOwner:string,repoName:string,message:string,notes:string) {\n\t\treturn this.rpc(\"CommitOnly\",  [repoOwner,repoName,message,notes] );\n\t}\n\t\n\tPrintPdfEndpoint (repoOwner:string,repoName:string,book:string,format:string,fileList:string) {\n\t\treturn this.rpc(\"PrintPdfEndpoint\",  [repoOwner,repoName,book,format,fileList] );\n\t}\n\t\n\tMergedFileCat (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"MergedFileCat\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tMergedFileGit (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"MergedFileGit\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tFileExistsOurHeadTheirHead (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"FileExistsOurHeadTheirHead\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tIsOurHeadInWd (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"IsOurHeadInWd\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tSaveOurHeadToWd (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"SaveOurHeadToWd\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tSaveTheirHeadToWd (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"SaveTheirHeadToWd\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tSaveMergingFile (repoOwner:string,repoName:string,path:string,workingExists:boolean,workingContent:string,theirExists:boolean,theirContent:string) {\n\t\treturn this.rpc(\"SaveMergingFile\",  [repoOwner,repoName,path,workingExists,workingContent,theirExists,theirContent] );\n\t}\n\t\n\tMergeFileOriginal (repoOwner:string,repoName:string,path:string,version:string) {\n\t\treturn this.rpc(\"MergeFileOriginal\",  [repoOwner,repoName,path,version] );\n\t}\n\t\n\tFindFileLists (repoOwner:string,repoName:string) {\n\t\treturn this.rpc(\"FindFileLists\",  [repoOwner,repoName] );\n\t}\n\t\n\tSearchForFiles (repoOwner:string,repoName:string,fileRegex:string) {\n\t\treturn this.rpc(\"SearchForFiles\",  [repoOwner,repoName,fileRegex] );\n\t}\n\t\n\tUpdateFileBinary (repoOwner:string,repoName:string,path:string,contentB64:string) {\n\t\treturn this.rpc(\"UpdateFileBinary\",  [repoOwner,repoName,path,contentB64] );\n\t}\n\t\n}\n","import {API} from './API';\nimport {EBW} from './EBW';\n\n// Context is a general class passed through to most sub-classes that allows\n// us to track the repo- and user-specific things that are common to pretty\n// much all requests. In some senses, it's a bit like a global namespace,\n// just much better controlled because it's a class we defined and pass around,\n// and can therefore modify for children if that is appropriate at some point.\nexport class Context {\n\tconstructor(protected el: HTMLElement, public RepoOwner: string, public RepoName: string) {\n\t\t// I should probably also pass the EBW in the context,\n\t\t// but since _all_ of the EBW methods are static, it is\n\t\t// pretty unnecessary\n\t}\n\tAPI() : API {\n\t\treturn EBW.API();\n\t}\n\tEBW() : EBW {\n\t\treturn new EBW();\n\t}\n\tGetAttribute(key: string): string {\n\t\tif (this.el) {\n\t\t\treturn this.el.getAttribute(key);\n\t\t}\n\t\treturn ``;\n\t}\n\tRepoRedirect(path: string, args?: Map<string,any>) : void {\n\t\tlet params = \"\";\n\t\tif (args) {\n\t\t\tlet a : string[] = [];\n\t\t\targs.forEach( (v,k)=>{\n\t\t\t\tv = String(v).trim();\n\t\t\t\tif (v) {\n\t\t\t\t\ta.push(encodeURIComponent(k) + `=` + encodeURIComponent(v));\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (0<a.length) {\n\t\t\t\tparams = \"?\" + a.join(\"&\");\n\t\t\t}\n\t\t}\n\t\tlet href =`/repo/${this.RepoOwner}/${this.RepoName}/${path}${params}`;\n\t\tdocument.location.href = href;\n\t}\n}","export class Toast {\n\tprotected static singleton? : Toast;\n\tprotected parent: HTMLElement;\n\tconstructor(el?:HTMLElement) {\n\t\tif (!Toast.singleton) {\n\t\t\tif (!el) {\n\t\t\t\tel = document.createElement(`div`);\n\t\t\t\tdocument.body.appendChild(el);\n\t\t\t}\n\t\t\tthis.parent = el;\n\t\t\tthis.parent.classList.add(`Toast`);\n\t\t\tToast.singleton = this;\n\t\t}\n\t\treturn Toast.singleton;\n\t}\n\tstatic Show(msg:string) {\n\t\tlet T = new Toast();\n\t\tlet div = document.createElement(`div`);\n\t\tdiv.innerHTML = msg;\n\t\tT.parent.appendChild(div);\n\t\tsetTimeout( function() {\n\t\t\tdiv.remove();\n\t\t},4500);\n\t\treturn div;\n\t}\n}\n","// dtemplate generated - do not edit\nexport namespace EL {\n\texport type AddNewBookDialog =\tHTMLDivElement;\n\texport type BoundFilename =\tHTMLDivElement;\n\texport type CommitMessageDialog =\tHTMLDivElement;\n\texport type EditorImage =\tHTMLDivElement;\n\texport type FSFileList_File =\tHTMLUListElement;\n\texport type FileListDialog =\tHTMLDivElement;\n\texport type FileListDialog_Item =\tHTMLUListElement;\n\texport type FoundationRevealDialog =\tHTMLDivElement;\n\texport type LoginTokenDisplay =\tHTMLUListElement;\n\texport type LoginTokenList =\tHTMLDivElement;\n\texport type MergeEditor =\tHTMLDivElement;\n\texport type PrintListenerTerminal =\tHTMLDivElement;\n\texport type PullRequestDiffList_File =\tHTMLDivElement;\n\texport type RepoEditorPage_NewFileDialog =\tHTMLDivElement;\n\texport type RepoEditorPage_RenameFileDialog =\tHTMLDivElement;\n\texport type RepoFileEditorCM =\tHTMLDivElement;\n\texport type RepoFileViewerFile =\tHTMLDivElement;\n\texport type RepoFileViewerPage =\tHTMLDivElement;\n\texport type RepoMergeDialog =\tHTMLDivElement;\n\texport type conflict_ClosePRDialog =\tHTMLDivElement;\n\texport type conflict_FileDisplay =\tHTMLLIElement;\n\texport type conflict_FileListDisplay =\tHTMLUListElement;\n\texport type conflict_MergeImageEditor =\tHTMLDivElement;\n\texport type conflict_MergeInstructions =\tHTMLDivElement;\n\t\n}\nexport namespace R {\n\texport interface AddNewBookDialog {\n\t\tchooseType: HTMLDivElement,\n\t\tnewBookRadio: HTMLInputElement,\n\t\tcollaborateRadio: HTMLInputElement,\n\t\tadaptationRadio: HTMLInputElement,\n\t\tnewBook: HTMLDivElement,\n\t\trepo_name: HTMLInputElement,\n\t\torg_name: HTMLInputElement,\n\t\tprivate_new: HTMLInputElement,\n\t\tadaptation: HTMLDivElement,\n\t\tadaptation_repo_name: HTMLInputElement,\n\t\tadaptation_org_name: HTMLInputElement,\n\t\ttemplate: HTMLInputElement,\n\t\tprivate_adapt: HTMLInputElement,\n\t\tcollaborate: HTMLDivElement,\n\t\tcollaborate_repo: HTMLInputElement,\n\t\tprivate_collaborate: HTMLInputElement,\n\t\t};\n\texport interface BoundFilename {\n\t\tfilename: HTMLSpanElement,\n\t\ta: HTMLAnchorElement,\n\t\t};\n\texport interface CommitMessageDialog {\n\t\ttitle: HTMLHeadingElement,\n\t\tinstructions: HTMLDivElement,\n\t\tmessage: HTMLInputElement,\n\t\tcommit: HTMLButtonElement,\n\t\t};\n\texport interface EditorImage {\n\t\t};\n\texport interface FSFileList_File {\n\t\tname: HTMLDivElement,\n\t\t};\n\texport interface FileListDialog {\n\t\tlist: HTMLUListElement,\n\t\t};\n\texport interface FileListDialog_Item {\n\t\tinput: HTMLInputElement,\n\t\ttitle: HTMLSpanElement,\n\t\t};\n\texport interface FoundationRevealDialog {\n\t\tcontent: HTMLDivElement,\n\t\t};\n\texport interface LoginTokenDisplay {\n\t\tlink: HTMLAnchorElement,\n\t\tdelete: HTMLAnchorElement,\n\t\t};\n\texport interface LoginTokenList {\n\t\tname: HTMLInputElement,\n\t\ttoken: HTMLInputElement,\n\t\tadd: HTMLButtonElement,\n\t\tlist: HTMLUListElement,\n\t\t};\n\texport interface MergeEditor {\n\t\tmergely: HTMLDivElement,\n\t\t};\n\texport interface PrintListenerTerminal {\n\t\theader: HTMLDivElement,\n\t\ttitle: HTMLDivElement,\n\t\tclose: HTMLDivElement,\n\t\tterminal: HTMLDivElement,\n\t\t};\n\texport interface PullRequestDiffList_File {\n\t\t};\n\texport interface RepoEditorPage_NewFileDialog {\n\t\tfilename: HTMLInputElement,\n\t\t};\n\texport interface RepoEditorPage_RenameFileDialog {\n\t\terror: HTMLDivElement,\n\t\tcurrent_name: HTMLSpanElement,\n\t\tfilename: HTMLInputElement,\n\t\t};\n\texport interface RepoFileEditorCM {\n\t\ttextEditor: HTMLDivElement,\n\t\timageEditor: HTMLDivElement,\n\t\t};\n\texport interface RepoFileViewerFile {\n\t\timg: HTMLImageElement,\n\t\tfilename: HTMLDivElement,\n\t\t};\n\texport interface RepoFileViewerPage {\n\t\tsearch: HTMLInputElement,\n\t\tdata: HTMLDivElement,\n\t\t};\n\texport interface RepoMergeDialog {\n\t\ttitle: HTMLHeadingElement,\n\t\tresolveOur: HTMLInputElement,\n\t\tresolveGit: HTMLInputElement,\n\t\tresolveTheir: HTMLInputElement,\n\t\tconflicted: HTMLInputElement,\n\t\tmergeButton: HTMLButtonElement,\n\t\t};\n\texport interface conflict_ClosePRDialog {\n\t\ttitle: HTMLHeadingElement,\n\t\tinstructions: HTMLDivElement,\n\t\tclosePR_no: HTMLInputElement,\n\t\tclosePR_yes: HTMLInputElement,\n\t\tcloseMessage: HTMLInputElement,\n\t\t};\n\texport interface conflict_FileDisplay {\n\t\tpath: HTMLSpanElement,\n\t\tstatus: HTMLSpanElement,\n\t\t};\n\texport interface conflict_FileListDisplay {\n\t\t};\n\texport interface conflict_MergeImageEditor {\n\t\tours: HTMLDivElement,\n\t\ttheirs: HTMLDivElement,\n\t\t};\n\texport interface conflict_MergeInstructions {\n\t\tshow: HTMLDivElement,\n\t\ttext: HTMLDivElement,\n\t\ttheirSide: HTMLSpanElement,\n\t\tourSide: HTMLSpanElement,\n\t\t};\n\t\n}\t// end namespace R\nexport class AddNewBookDialog {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.AddNewBookDialog;\n\tconstructor() {\n\t\tlet t = AddNewBookDialog._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div><div><h1>Add a project</h1><fieldset><label><input type=\"radio\" value=\"new\" name=\"new-project-type\"/>\n\t\t\t\tStart a new project.\n\t\t\t</label><label><input type=\"radio\" value=\"collaborate\" name=\"new-project-type\"/>\n\t\t\t\tContribute to an existing project.\n\t\t\t</label><label><input type=\"radio\" value=\"adaptation\" name=\"new-project-type\"/>\n\t\t\t\tCreate an adaptation of an existing project.\n\t\t\t</label></fieldset><button data-event=\"click:choseType\" class=\"btn\">Next</button></div><div><h1>New project</h1><form method=\"post\" action=\"/github/create/new\"><input type=\"hidden\" name=\"action\" value=\"new\"/><label>Enter the name for your new project. Use only letters and dashes; no spaces.\n\t\t<input type=\"text\" name=\"repo_new\" placeholder=\"e.g. MobyDick\"/>\n\t\t</label><label>Enter the organization this project should belong to, or leave this field\n\t\tblank if you will yourself be the owner of this project.\n\t\t<input type=\"text\" name=\"org_name\" placeholder=\"e.g. electricbookworks\"/>\n\t\t</label><label><input type=\"checkbox\" name=\"private\" value=\"private\"/>\n\t\t\tMake this project private (must be supported by user's Github plan).\n\t\t</label><input type=\"submit\" class=\"btn\" value=\"New project\"/></form></div><div><h1>Adaptation</h1><form method=\"post\" action=\"/github/create/new\"><input type=\"hidden\" name=\"action\" value=\"new\"/><label>Enter the name for your new project. Use only letters and dashes; no spaces.\n\t\t<input type=\"text\" name=\"repo_new\" placeholder=\"e.g. MobyDick\"/>\n\t\t</label><label>Enter the organization this project should belong to, or leave this field\n\t\tblank if you will yourself be the owner of this project.\n\t\t<input type=\"text\" name=\"org_name\" placeholder=\"e.g. electricbookworks\"/>\n\t\t</label><label>Enter the series that you will be adapting.\n\t\t<input type=\"text\" name=\"template\" placeholder=\"e.g. electricbookworks/electric-book\"/>\n\t\t</label><label><input type=\"checkbox\" name=\"private\" value=\"private\"/>\n\t\t\tMake this project private (must be supported by user's Github plan).\n\t\t</label><input type=\"submit\" class=\"btn\" value=\"New adaptation\"/></form></div><div><h1>Contributing</h1><form method=\"post\" action=\"/github/create/fork\"><input type=\"hidden\" name=\"action\" value=\"fork\"/><label>Enter the GitHub owner and repo for the project you will contribute to.\n\t\t<input type=\"text\" name=\"collaborate_repo\" placeholder=\"e.g. electricbooks/core\"/>\n\t\t</label><label style=\"display:none;\"><input type=\"checkbox\" name=\"private\" value=\"private\"/>\n\t\t\tMake this project private (must be supported by user's Github plan).\n\t\t</label><input type=\"submit\" class=\"btn\" value=\"Copy project\"/></form></div></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tAddNewBookDialog._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\tchooseType: n.childNodes[0] as HTMLDivElement,\n\t\t\tnewBookRadio: n.childNodes[0].childNodes[1].childNodes[0].childNodes[0] as HTMLInputElement,\n\t\t\tcollaborateRadio: n.childNodes[0].childNodes[1].childNodes[1].childNodes[0] as HTMLInputElement,\n\t\t\tadaptationRadio: n.childNodes[0].childNodes[1].childNodes[2].childNodes[0] as HTMLInputElement,\n\t\t\tnewBook: n.childNodes[1] as HTMLDivElement,\n\t\t\trepo_name: n.childNodes[1].childNodes[1].childNodes[1].childNodes[1] as HTMLInputElement,\n\t\t\torg_name: n.childNodes[1].childNodes[1].childNodes[2].childNodes[1] as HTMLInputElement,\n\t\t\tprivate_new: n.childNodes[1].childNodes[1].childNodes[3].childNodes[0] as HTMLInputElement,\n\t\t\tadaptation: n.childNodes[2] as HTMLDivElement,\n\t\t\tadaptation_repo_name: n.childNodes[2].childNodes[1].childNodes[1].childNodes[1] as HTMLInputElement,\n\t\t\tadaptation_org_name: n.childNodes[2].childNodes[1].childNodes[2].childNodes[1] as HTMLInputElement,\n\t\t\ttemplate: n.childNodes[2].childNodes[1].childNodes[3].childNodes[1] as HTMLInputElement,\n\t\t\tprivate_adapt: n.childNodes[2].childNodes[1].childNodes[4].childNodes[0] as HTMLInputElement,\n\t\t\tcollaborate: n.childNodes[3] as HTMLDivElement,\n\t\t\tcollaborate_repo: n.childNodes[3].childNodes[1].childNodes[1].childNodes[1] as HTMLInputElement,\n\t\t\tprivate_collaborate: n.childNodes[3].childNodes[1].childNodes[2].childNodes[0] as HTMLInputElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class BoundFilename {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.BoundFilename;\n\tconstructor() {\n\t\tlet t = BoundFilename._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div class=\"bound-filename\"><span>Select a file to edit</span><a href=\"#\" target=\"_github\"><img src=\"/img/github-dark.svg\"/></a></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tBoundFilename._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\tfilename: n.childNodes[0] as HTMLSpanElement,\n\t\t\ta: n.childNodes[1] as HTMLAnchorElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class CommitMessageDialog {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.CommitMessageDialog;\n\tconstructor() {\n\t\tlet t = CommitMessageDialog._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div><h1>Title</h1><div>Instructions</div><fieldset><label for=\"commitMessage\">Describe your changes\n\t\t<input type=\"text\" name=\"commitMessage\" id=\"commitMessage\"/>\n\t\t</label></fieldset><button class=\"btn\">Commit</button></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tCommitMessageDialog._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\ttitle: n.childNodes[0] as HTMLHeadingElement,\n\t\t\tinstructions: n.childNodes[1] as HTMLDivElement,\n\t\t\tmessage: n.childNodes[2].childNodes[0].childNodes[1] as HTMLInputElement,\n\t\t\tcommit: n.childNodes[3] as HTMLButtonElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class EditorImage {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.EditorImage;\n\tconstructor() {\n\t\tlet t = EditorImage._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div> </div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tEditorImage._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class FSFileList_File {\n\tpublic static _template : HTMLUListElement;\n\tpublic el : HTMLUListElement;\n\tpublic $ : R.FSFileList_File;\n\tconstructor() {\n\t\tlet t = FSFileList_File._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<ul><li data-set=\"this\" class=\"allfiles-file\"><div data-event=\"click:clickFile\">NAME\n\t\t</div></li></ul>`;\n\t\t\tt = d.firstElementChild.childNodes[0] as HTMLUListElement;\n\t\t\tFSFileList_File._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLUListElement;\n\t\tthis.$ = {\n\t\t\tname: n.childNodes[0] as HTMLDivElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class FileListDialog {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.FileListDialog;\n\tconstructor() {\n\t\tlet t = FileListDialog._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div><h1>Print Version</h1><p>Choose the project version you want to print:</p><ul class=\"file-list-dialog-list\">\n\t</ul></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tFileListDialog._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\tlist: n.childNodes[2] as HTMLUListElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class FileListDialog_Item {\n\tpublic static _template : HTMLUListElement;\n\tpublic el : HTMLUListElement;\n\tpublic $ : R.FileListDialog_Item;\n\tconstructor() {\n\t\tlet t = FileListDialog_Item._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<ul><li data-set=\"this\"><input type=\"radio\" name=\"file-list\"/><span/></li></ul>`;\n\t\t\tt = d.firstElementChild.childNodes[0] as HTMLUListElement;\n\t\t\tFileListDialog_Item._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLUListElement;\n\t\tthis.$ = {\n\t\t\tinput: n.childNodes[0] as HTMLInputElement,\n\t\t\ttitle: n.childNodes[1] as HTMLSpanElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class FoundationRevealDialog {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.FoundationRevealDialog;\n\tconstructor() {\n\t\tlet t = FoundationRevealDialog._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div class=\"reveal\" id=\"new-file-dialog\" data-reveal=\"\"><div class=\"content\">\n\t</div><button class=\"close-button\" aria-label=\"Close popup\" type=\"button\" data-close=\"\"><span aria-hidden=\"true\">×</span></button></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tFoundationRevealDialog._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\tcontent: n.childNodes[0] as HTMLDivElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class LoginTokenDisplay {\n\tpublic static _template : HTMLUListElement;\n\tpublic el : HTMLUListElement;\n\tpublic $ : R.LoginTokenDisplay;\n\tconstructor() {\n\t\tlet t = LoginTokenDisplay._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<ul><li data-set=\"this\" class=\"token-display\"><a href=\"\">LINK</a><a href=\"\">X</a></li></ul>`;\n\t\t\tt = d.firstElementChild.childNodes[0] as HTMLUListElement;\n\t\t\tLoginTokenDisplay._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLUListElement;\n\t\tthis.$ = {\n\t\t\tlink: n.childNodes[0] as HTMLAnchorElement,\n\t\t\tdelete: n.childNodes[1] as HTMLAnchorElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class LoginTokenList {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.LoginTokenList;\n\tconstructor() {\n\t\tlet t = LoginTokenList._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div class=\"login-token-list\"><div class=\"token-input\"><input type=\"text\" placeholder=\"name\"/><input type=\"text\" placeholder=\"token\"/><button class=\"btn\">Add</button></div><ul class=\"token-list\">\n\t</ul></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tLoginTokenList._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\tname: n.childNodes[0].childNodes[0] as HTMLInputElement,\n\t\t\ttoken: n.childNodes[0].childNodes[1] as HTMLInputElement,\n\t\t\tadd: n.childNodes[0].childNodes[2] as HTMLButtonElement,\n\t\t\tlist: n.childNodes[1] as HTMLUListElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class MergeEditor {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.MergeEditor;\n\tconstructor() {\n\t\tlet t = MergeEditor._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div class=\"merge-editor\"><div class=\"action-group\"><button data-event=\"click:save\" class=\"btn\">Save</button></div><div class=\"merge-mergely\">\n\t</div></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tMergeEditor._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\tmergely: n.childNodes[1] as HTMLDivElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class PrintListenerTerminal {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.PrintListenerTerminal;\n\tconstructor() {\n\t\tlet t = PrintListenerTerminal._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div id=\"print-listener\"><div class=\"header\"><div class=\"title\">Printing in progress...\n\t\t</div><div class=\"close\">X</div></div><div class=\"terminal\">\n\t</div></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tPrintListenerTerminal._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\theader: n.childNodes[0] as HTMLDivElement,\n\t\t\ttitle: n.childNodes[0].childNodes[0] as HTMLDivElement,\n\t\t\tclose: n.childNodes[0].childNodes[1] as HTMLDivElement,\n\t\t\tterminal: n.childNodes[1] as HTMLDivElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class PullRequestDiffList_File {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.PullRequestDiffList_File;\n\tconstructor() {\n\t\tlet t = PullRequestDiffList_File._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div>\n</div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tPullRequestDiffList_File._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class RepoEditorPage_NewFileDialog {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.RepoEditorPage_NewFileDialog;\n\tconstructor() {\n\t\tlet t = RepoEditorPage_NewFileDialog._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div><fieldset><label>\n\t\t\tEnter the full path to your new file.\n\t\t\t<input type=\"text\" placeholder=\"book/text/chapter-7.md\" data-event=\"change\"/>\n\t\t</label></fieldset><button class=\"btn\" data-event=\"click\">Create File</button></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tRepoEditorPage_NewFileDialog._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\tfilename: n.childNodes[0].childNodes[0].childNodes[1] as HTMLInputElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class RepoEditorPage_RenameFileDialog {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.RepoEditorPage_RenameFileDialog;\n\tconstructor() {\n\t\tlet t = RepoEditorPage_RenameFileDialog._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div><div class=\"error\">\n\t</div><fieldset><div>Renaming <span> </span></div><label>\n\t\t\tEnter the full path to your new file.\n\t\t\t<input type=\"text\" placeholder=\"/book/text/chapter-7.md\" data-event=\"change\"/>\n\t\t</label></fieldset><button class=\"btn\" data-event=\"click\">Rename</button></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tRepoEditorPage_RenameFileDialog._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\terror: n.childNodes[0] as HTMLDivElement,\n\t\t\tcurrent_name: n.childNodes[1].childNodes[0].childNodes[1] as HTMLSpanElement,\n\t\t\tfilename: n.childNodes[1].childNodes[1].childNodes[1] as HTMLInputElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class RepoFileEditorCM {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.RepoFileEditorCM;\n\tconstructor() {\n\t\tlet t = RepoFileEditorCM._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div class=\"repo-file-editor-workspace\"><div class=\"repo-file-editor\">\n\t</div><div class=\"repo-image-editor\">\n\t</div></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tRepoFileEditorCM._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\ttextEditor: n.childNodes[0] as HTMLDivElement,\n\t\t\timageEditor: n.childNodes[1] as HTMLDivElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class RepoFileViewerFile {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.RepoFileViewerFile;\n\tconstructor() {\n\t\tlet t = RepoFileViewerFile._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div class=\"repo-file-viewer-file\"><div class=\"image\"><img/></div><div class=\"filename\"/></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tRepoFileViewerFile._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\timg: n.childNodes[0].childNodes[0] as HTMLImageElement,\n\t\t\tfilename: n.childNodes[1] as HTMLDivElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class RepoFileViewerPage {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.RepoFileViewerPage;\n\tconstructor() {\n\t\tlet t = RepoFileViewerPage._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div class=\"repo-file-viewer\"><div class=\"searchbar\"><input type=\"text\" placeholder=\"Enter search text to find images.\"/></div><div class=\"data\">\n\t</div></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tRepoFileViewerPage._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\tsearch: n.childNodes[0].childNodes[0] as HTMLInputElement,\n\t\t\tdata: n.childNodes[1] as HTMLDivElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class RepoMergeDialog {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.RepoMergeDialog;\n\tconstructor() {\n\t\tlet t = RepoMergeDialog._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div><h1>Updating a Repo</h1><p>How do you want to try this merge?</p><fieldset><label for=\"resolveOur\"><input type=\"radio\" name=\"resolve\" value=\"our\" id=\"resolveOur\"/>\n\t\t\tI will do the merge.\n\t\t</label><label for=\"resolveGit\"><input type=\"radio\" name=\"resolve\" value=\"git\" id=\"resolveGit\"/>\n\t\t\tGit can try to merge.\n\t\t</label><label for=\"resolveTheir\"><input type=\"radio\" name=\"resolve\" value=\"their\" id=\"resolveTheir\"/>\n\t\t\tChoose their files by preference.\n\t\t</label></fieldset><label for=\"conflicted\"><input type=\"checkbox\" name=\"conflicted\" value=\"only\" id=\"conflicted\"/>\n\t\t\tOnly apply above resolution to conflicted files.\n\t</label><button class=\"btn\" data-event=\"click:\">Do the Merge</button></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tRepoMergeDialog._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\ttitle: n.childNodes[0] as HTMLHeadingElement,\n\t\t\tresolveOur: n.childNodes[2].childNodes[0].childNodes[0] as HTMLInputElement,\n\t\t\tresolveGit: n.childNodes[2].childNodes[1].childNodes[0] as HTMLInputElement,\n\t\t\tresolveTheir: n.childNodes[2].childNodes[2].childNodes[0] as HTMLInputElement,\n\t\t\tconflicted: n.childNodes[3].childNodes[0] as HTMLInputElement,\n\t\t\tmergeButton: n.childNodes[4] as HTMLButtonElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class conflict_ClosePRDialog {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.conflict_ClosePRDialog;\n\tconstructor() {\n\t\tlet t = conflict_ClosePRDialog._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div><h1>Title</h1><div>Instructions</div><fieldset><label for=\"closePR-no\"><input type=\"radio\" name=\"closePR\" id=\"closePR-no\" value=\"no\" data-event=\"change\"/>No\n\t\t</label><label for=\"closePR-yes\"><input type=\"radio\" name=\"closePR\" id=\"closePR-yes\" value=\"yes\" data-event=\"change\"/>Yes\n\t\t</label><label for=\"closeMessage\">Close message\n\t\t<input type=\"text\" name=\"closeMessage\" id=\"closeMessage\"/>\n\t\t</label></fieldset><button class=\"btn\" data-event=\"click:done\">Done</button></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tconflict_ClosePRDialog._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\ttitle: n.childNodes[0] as HTMLHeadingElement,\n\t\t\tinstructions: n.childNodes[1] as HTMLDivElement,\n\t\t\tclosePR_no: n.childNodes[2].childNodes[0].childNodes[0] as HTMLInputElement,\n\t\t\tclosePR_yes: n.childNodes[2].childNodes[1].childNodes[0] as HTMLInputElement,\n\t\t\tcloseMessage: n.childNodes[2].childNodes[2].childNodes[1] as HTMLInputElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class conflict_FileDisplay {\n\tpublic static _template : HTMLLIElement;\n\tpublic el : HTMLLIElement;\n\tpublic $ : R.conflict_FileDisplay;\n\tconstructor() {\n\t\tlet t = conflict_FileDisplay._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<li class=\"file-display\"><span class=\"path\"> </span><span class=\"status\"> </span></li>`;\n\t\t\tt = d.firstElementChild as HTMLLIElement;\n\t\t\tconflict_FileDisplay._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLLIElement;\n\t\tthis.$ = {\n\t\t\tpath: n.childNodes[0] as HTMLSpanElement,\n\t\t\tstatus: n.childNodes[1] as HTMLSpanElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class conflict_FileListDisplay {\n\tpublic static _template : HTMLUListElement;\n\tpublic el : HTMLUListElement;\n\tpublic $ : R.conflict_FileListDisplay;\n\tconstructor() {\n\t\tlet t = conflict_FileListDisplay._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<ul class=\"conflict-file-list-display\">\n</ul>`;\n\t\t\tt = d.firstElementChild as HTMLUListElement;\n\t\t\tconflict_FileListDisplay._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLUListElement;\n\t\tthis.$ = {\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class conflict_MergeImageEditor {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.conflict_MergeImageEditor;\n\tconstructor() {\n\t\tlet t = conflict_MergeImageEditor._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div id=\"merge-image-editor\" class=\"merge-image-editor\"><div>\n\t</div><div>\n\t</div></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tconflict_MergeImageEditor._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\tours: n.childNodes[0] as HTMLDivElement,\n\t\t\ttheirs: n.childNodes[1] as HTMLDivElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class conflict_MergeInstructions {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.conflict_MergeInstructions;\n\tconstructor() {\n\t\tlet t = conflict_MergeInstructions._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div class=\"merge-instructions\"><div class=\"instructions-button\">?</div><div class=\"instructions-text\"><h1>Working with the merge editor</h1><p>The file being submitted is displayed in the editor on the <span class=\"editor-side\">THEIRSIDE</span> side.</p><p>The final file you will save is displayed in the editor on the <span class=\"editor-side\">OURSIDE</span> side.</p><p>Use the small buttons to the left of lines to transfer changes between sides.</p><p>When you are satisfied with your changes, press 'Save these changes' to save your changes.</p><p>When you have resolved all the issues between all the files, press 'Resolve this merge' to resolve the conflicted state.</p></div></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tconflict_MergeInstructions._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\tshow: n.childNodes[0] as HTMLDivElement,\n\t\t\ttext: n.childNodes[1] as HTMLDivElement,\n\t\t\ttheirSide: n.childNodes[1].childNodes[1].childNodes[1] as HTMLSpanElement,\n\t\t\tourSide: n.childNodes[1].childNodes[2].childNodes[1] as HTMLSpanElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\n\n","export function QuerySelectorAllIterate(el:HTMLElement, query:string) : HTMLElement[] {\n\tlet els :HTMLElement[] = [];\n\tif ('function'==typeof el.matches) {\n\t\tif (el.matches(query)) {\n\t\t\tels.push(el);\n\t\t}\n\t} else if ('function'==typeof (el as any).matchesSelector) {\n\t\tif ((el as any).matchesSelector(query)) {\n\t\t\tels.push(el as HTMLElement);\n\t\t}\n\t}\n\tlet childSelector = el.querySelectorAll(query);\n\tfor (let i=0; i<childSelector.length; i++) {\n\t\tels.push(childSelector.item(i) as HTMLElement);\n\t}\n\treturn els;\n}\t\n\n","import {QuerySelectorAllIterate} from './querySelectorAll-extensions';\n\n/**\n * Eventify adds eventListeners to the given object\n * for each node in the given element and it's sub-elements\n * that has an attribute of the form:\n * data-event=\"event:method,event:method,...\"\n * When the named event occurs on the element, the named\n * method will be called on the object.\n */\nexport function Eventify (el:HTMLElement, methods:any) {\n\n\tfor (let e of QuerySelectorAllIterate(el, `[data-event]`)) {\n\t\tlet evtList = e.getAttribute(`data-event`)\n\t\tfor (let p of evtList.split(`,`)) {\n\t\t\tlet [event, method] = p.split(':');\n\t\t\tif (!method) {\n\t\t\t\tmethod=event;\n\t\t\t}\n\t\t\tif (undefined == methods[method]) {\n\t\t\t\tconsole.error(`No method ${method} (from ${p}) defined on `, methods, \n\t\t\t\t\t` while eventifying `, e);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\te.addEventListener(event, function(evt) {\n\t\t\t\tmethods[method](evt);\n\t\t\t});\n\t\t}\n\t}\n}","import { AddNewBookDialog as Template } from './Templates';\nimport { Eventify } from './Eventify';\nimport $ = require('jquery');\n\n// AddNewBookDialog steps the user through two pages\n// determining what sort of new book they want to create,\n// and where the original of that book should be found:\n// ie copy the ebw electricbook template, or fork an existing\n// book.\nexport class AddNewBookDialog extends Template {\n\tconstructor(parent:HTMLElement) {\n\t\tsuper();\n\t\tEventify(this.el, {\n\t\t\t'choseType': ()=>{\n\t\t\t\tlet newBook = this.$.newBookRadio.checked;\n\t\t\t\tlet collaborate = this.$.collaborateRadio.checked;\n\t\t\t\tlet adaptation = this.$.adaptationRadio.checked;\n\n\t\t\t\tif (!newBook && !collaborate && !adaptation) {\n\t\t\t\t\talert(`You need to choose one or the other`);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (newBook) {\n\t\t\t\t\tthis.$.newBook.style.display = 'block';\n\t\t\t\t\tthis.$.repo_name.focus();\n\t\t\t\t} else if (collaborate) {\n\t\t\t\t\tthis.$.collaborate.style.display = 'block';\n\t\t\t\t\tthis.$.collaborate_repo.focus();\n\t\t\t\t} else {\n\t\t\t\t\tthis.$.adaptation.style.display = 'block';\n\t\t\t\t\tthis.$.adaptation_repo_name.focus();\n\t\t\t\t}\n\t\t\t\tthis.$.chooseType.style.display = 'none';\n\t\t\t}\n\t\t});\n\n\t\t$(parent).bind(`open.zf.reveal`, (evt)=>{\n\t\t\tthis.$.chooseType.style.display = 'block';\n\t\t\tthis.$.newBookRadio.checked = false;\n\t\t\tthis.$.collaborateRadio.checked = false;\n\t\t\tthis.$.adaptationRadio.checked = false;\n\n\t\t\tthis.$.newBook.style.display = 'none';\n\t\t\tthis.$.repo_name.value = '';\n\n\t\t\tthis.$.collaborate.style.display = 'none';\n\t\t\tthis.$.collaborate_repo.value = '';\n\n\t\t\tthis.$.adaptation.style.display = 'none';\n\t\t\tthis.$.adaptation_repo_name.value = '';\n\n\t\t\tthis.$.private_new.checked = false;\n\t\t\tthis.$.private_adapt.checked = false;\n\t\t\tthis.$.private_collaborate.checked = false;\n\t\t\t\t\n\t\t});\n\n\t\tparent.appendChild(this.el);\n\t}\n\tstatic instantiate() {\n\t\tlet list = document.querySelectorAll(`[data-instance='AddNewBookDialog']`);\n\t\tfor (let i=0; i<list.length; i++) {\n\t\t\tlet el = list.item(i) as HTMLElement;\n\t\t\t// console.log(`qsa.forEach(`, el, `)`);\n\t\t\tnew AddNewBookDialog(el);\n\t\t}\n\t}\n}\n\n","import {LoginTokenList as Template, LoginTokenDisplay} from './Templates';\n\ninterface Token {\n\tname:string;\n\ttoken:string;\n}\n\nclass TokenDisplay extends LoginTokenDisplay {\n\tconstructor(parent:HTMLElement, protected t:Token, protected list:LoginTokenList) {\n\t\tsuper();\n\n\t\tthis.$.link.href = `/github/token/${this.t.token}`;\n\t\tthis.$.link.innerText = this.t.name;\n\n\t\tthis.$.delete.addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault();\n\t\t\tthis.el.remove();\n\t\t\tthis.list.RemoveToken(this.t);\n\t\t})\n\t\tparent.appendChild(this.el);\n\t}\n\tstatic removeToken(name:string) {\n\t\tlet d = document.getElementById(`token-list-item-` + t.name);\n\t\tif (d) {\n\t\t\td.remove();\n\t\t}\n\t}\n}\n\nexport class LoginTokenList extends Template {\n\tconstructor(parent:HTMLElement) {\n\t\tsuper();\n\n\t\tthis.GetTokens().map( (t)=>{\n\t\t\tnew TokenDisplay(this.$.list, t, this);\n\t\t});\n\n\t\tthis.$.add.addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault();\n\t\t\tlet name = this.$.name.value;\n\t\t\tlet token = this.$.token.value;\n\t\t\tif (``==name) {\n\t\t\t\talert(`You need to provide a name for the new token`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (``==token) {\n\t\t\t\talert(`You need to provide a token value`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.AddToken({name:name,token:token});\n\t\t\tthis.$.name.value = ``;\n\t\t\tthis.$.token.value = ``;\n\t\t});\n\t\tparent.appendChild(this.el);\n\t}\n\tGetTokens() : Token[] {\n\t\tlet js = localStorage.getItem(`ebw-token-list`);\n\t\tif (!js) {\n\t\t\treturn [];\n\t\t}\n\t\tlet t = JSON.parse(js) as Token[];\n\t\treturn t;\n\t}\n\tAddToken(t:Token):void {\n\t\tlet tokens = this.GetTokens();\n\t\ttokens.push(t);\n\t\tlocalStorage.setItem(`ebw-token-list`, JSON.stringify(tokens));\n\t\tnew TokenDisplay(this.$.list, t, this);\n\t}\n\tRemoveToken(t:Token):void {\n\t\tlet tokens = this.GetTokens();\n\t\tlet newt = [] as Token[];\n\t\tfor (let ot of tokens) {\n\t\t\tif ((ot.name != t.name) || (ot.token!=t.token)) {\n\t\t\t\tnewt.push(ot);\n\t\t\t}\n\t\t}\n\t\tlocalStorage.setItem(`ebw-token-list`, JSON.stringify(newt));\n\t}\n\tstatic init() {\n\t\tconsole.log(`seeking LoginTokenList`); \n\t\tlet nodes = document.querySelectorAll(`[data-instance=\"LoginTokenList\"]`);\n\t\tfor (let i=0; i<nodes.length; i++) {\n\t\t\tlet l = nodes.item(i) as HTMLElement;\n\t\t\tnew LoginTokenList(l);\n\t\t}\n\t}\n}\n","import {Context} from './Context';\n\nexport class RepoMergeDirectButton {\n\tconstructor(protected context:Context, protected el:HTMLElement) {\n\t\tlet href = `/repo/${context.RepoOwner}/` +\n\t\t\t\t`${context.RepoName}/merge/` + \n\t\t\t\tel.getAttribute('data-repo-merge');\n\t\tconsole.log(`RepoMergeDirectButton: onclick for `, el , `  = `, href);\n\t\tel.addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\tdocument.location.href = `/repo/${context.RepoOwner}/` +\n\t\t\t\t`${context.RepoName}/merge/` + \n\t\t\t\tel.getAttribute('data-repo-merge') ;\n\t\t});\n\t\tel.classList.add(`btn`);\n\t}\n\n\tstatic init(context:Context) {\n\t\tlet els = document.querySelectorAll(`[data-instance=\"RepoMergeButton\"]`);\n\t\tfor(let i=0; i<els.length; i++) {\n\t\t\tnew RepoMergeDirectButton(context, els.item(i) as HTMLElement);\n\t\t}\n\t}\n}","import {Context} from './Context';\nimport {EBW} from './EBW';\nimport {RepoMergeDirectButton} from './RepoMergeDirectButton';\nimport {RepoMergeDialog} from './RepoMergeDialog';\n\nexport class RepoDetailPage {\n\tconstructor(protected context:Context) {\n\t\tRepoMergeDirectButton.init(this.context);\n\n\t\tlet el = document.getElementById(`cancelAllChanges`);\n\t\tif (el) {\n\t\t\tel.addEventListener(`click`, (evt)=>{\n\t\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\t\tEBW.Confirm(`All your changes will be lost. This is non-recoverable. Continue?`)\n\t\t\t\t.then( (b:boolean)=>{\n\t\t\t\t\tif (b) {\n\t\t\t\t\t\tdocument.location.href = `/repo/${context.RepoOwner}/${context.RepoName}/conflict/abort`;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\t\t// let dialog = new RepoMergeDialog(context, undefined);\n\t\t// RepoMergeButton.init(this.context, dialog);\n\t\t// dialog.MergeEvent.add(this.mergeEvent, this);\n\t}\n\t// mergeEvent(dialog:RepoMergeDialog) : void {\n\t// \tlet resolve = dialog.GetResolve();\n\t// \tlet conflicted = dialog.GetConflicted();\n\t// \tlet context = dialog.GetContext();\n\t// \tdocument.location.href = `/repo/${context.RepoOwner}/${context.RepoName}/merge/${dialog.GetRepoRemote()}` +\n\t// \t\t`?resolve=${resolve}&conflicted=${conflicted}`;\n\t// }\n}\n","// A ControlTag controls the appearance of another div, most likely changing\n// it's width or making it appear / disappear\nexport class ControlTag {\n\tconstructor(protected el: HTMLElement, protected callback:(showing:boolean)=>void) {\n\t\tthis.el.addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\tthis.el.classList.toggle(`showing`);\n\t\t\tthis.callback(this.el.classList.contains(`showing`));\n\t\t})\n\t}\n}","/// <reference path=\"./typescript-foundation.d.ts\" />\nimport * as TSFoundation from 'TSFoundation';\nimport {FoundationRevealDialog as Template} from './Templates';\n\nimport jQuery = require('jquery');\nimport signals = require('signals');\n\nexport enum DialogEvents {\n\tOpened = 1,\n\tClosed\n}\n\n/**\n * FoundationRevealDialog is a class that implements\n * a Foundation Reveal dialog. It has a public 'Events' \n * signals.Signal that receives 'opened' and 'closed'\n * events when the respective action happens on the dialog.\n */\nexport class FoundationRevealDialog extends Template {\n\tprotected $el : any;\n\tpublic Events: signals.Signal;\n\n\tconstructor(\n\t\topenElement?:HTMLElement,\n\t\tcontent?:HTMLElement\n\t) {\n\t\tsuper();\n\t\tthis.Events = new signals.Signal();\n\t\tthis.$el = jQuery(this.el);\n\n\t\tif (openElement) {\n\t\t\topenElement.addEventListener('click', (evt)=>{\n\t\t\t\tevt.preventDefault();\n\t\t\t\tevt.stopPropagation();\n\t\t\t\tthis.$el.foundation('open');\n\t\t\t});\n\t\t}\n\t\tthis.$el.bind('open.zf.reveal', (evt:any)=>{\n\t\t\tthis.Events.dispatch(DialogEvents.Opened);\n\t\t});\n\t\tthis.$el.bind('closed.zf.reveal', (evt:any)=>{\n\t\t\tthis.Events.dispatch(DialogEvents.Closed);\n\t\t});\n\t\tif (content) {\n\t\t\tthis.Set(content);\n\t\t}\n\n\t\t// The el must be inserted into the DOM before Foundation is\n\t\t// called on it, otherwise Foundation doesn't properly position\n\t\t// the dialog.\n\t\tdocument.body.appendChild(this.el);\n\t\t// TSFoundation required because Typescript can be really stupid.\n\t\tTSFoundation.Reveal(this.$el);\n\t}\n\t// Set the content of the dialog to the given\n\t// element.\n\tpublic Set(el: HTMLElement):void {\n\t\tthis.$.content.innerText = '';\n\t\tthis.$.content.appendChild(el);\n\t}\n\tpublic Open(): void {\n\t\tthis.$el.foundation('open');\n\t}\n\tpublic Close(): void {\n\t\tthis.$el.foundation('close');\n\t}\n}","import {FileListDialog_Item as Template} from './Templates';\nimport {FileListDialog} from './FileListDialog';\n\nexport class FileListDialogItem extends Template {\n\tconstructor(protected path:string, protected dialog:FileListDialog) {\n\t\tsuper();\n\t\tthis.$.title.textContent = path;\n\t\tthis.$.input.addEventListener('click', (evt)=>{\n\t\t\tevt.preventDefault();\n\t\t\tevt.stopPropagation();\n\t\t\tthis.dialog.Close(this.path);\n\t\t})\n\t}\n\tisSet() {\n\t\treturn (this.$.input.checked);\n\t}\n}","import {DialogEvents as FoundationRevealDialogEvents, FoundationRevealDialog} from './FoundationRevealDialog';\nimport {FileListDialog as Template} from './Templates';\nimport {FileListDialogItem} from './FileListDialog_Item';\nimport {Eventify} from './Eventify';\n\nexport class FileListDialogResult {\n\tFileList?: string;\n\tCancelled: boolean;\n}\n\nexport class FileListDialog extends Template {\n\tprotected resolve: (m:FileListDialogResult)=>void;\n\tprotected dialog: FoundationRevealDialog;\n\tprotected items: Array<FileListDialogItem>;\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis.dialog = new FoundationRevealDialog(undefined, this.el);\n\t\tthis.dialog.Events.add( this.dialogEvent, this );\n\t}\n\n\tClose(filePath:string) {\n\t\tthis.resolve({\n\t\t\tFileList: filePath,\n\t\t\tCancelled: false});\n\t\tthis.resolve = undefined;\n\t\tthis.dialog.Close();\n\t}\n\n\tdialogEvent(evt:FoundationRevealDialogEvents) {\n\t\tswitch (evt) { \n\t\t\tcase FoundationRevealDialogEvents.Closed:\n\t\t\t\t// If the commit button was pressed, we have resolved\n\t\t\t\t// the promise, and have cleared this.resolve\n\t\t\t\tif (this.resolve) {\n\t\t\t\t\tthis.resolve({Cancelled:true});\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\tcase FoundationRevealDialogEvents.Opened:\n\t\t\t\treturn;\n\t\t};\n\t}\n\n\t// Open returns a Promise that will return a string[]. The string[]\n\t// will either contain two elements: \n\tOpen(fileList:string[]) : Promise<FileListDialogResult> {\n\t\tthis.$.list.innerText = ``;\n\t\tthis.items = [];\n\t\tfor (let f of fileList) {\n\t\t\tlet i = new FileListDialogItem(f, this);\n\t\t\tthis.$.list.appendChild(i.el);\n\t\t\tthis.items.push(i);\n\t\t}\n\n\t\treturn new Promise<FileListDialogResult>(\n\t\t\t(resolve,reject)=>{\n\t\t\t\tthis.resolve = resolve;\n\t\t\t\tthis.dialog.Open();\n\t\t\t});\n\t}\n}","import {PrintListenerTerminal as Template} from './Templates';\n\nexport class PrintListenerTerminal extends Template {\n\tconstructor() {\n\t\tsuper();\n\t\tlet el = document.getElementById('print-listener');\n\t\tif (el) {\n\t\t\tel.remove();\n\t\t}\n\t\tthis.$.close.addEventListener(`click`, (evt)=>{\n\t\t\tthis.el.remove();\n\t\t});\n\t\tdocument.body.appendChild(this.el);\n\t}\n\taddLine(msg:string, err:boolean=false) {\n\t\tlet line = document.createElement(`div`);\n\t\tline.innerText = msg;\n\t\tif (err) {\n\t\t\tline.classList.add('error-line');\n\t\t}\n\t\tthis.$.terminal.appendChild(line);\n\t\tthis.scrollBottom();\n\t}\n\tscrollBottom() {\n\t\tthis.$.terminal.scrollTop = this.$.terminal.scrollHeight - this.$.terminal.clientHeight;\n\t}\n\taddError(msg:string) {\n\t\tthis.addLine(msg, true);\n\t}\n\tticktock() {\n\t\tthis.$.header.classList.toggle(`tick`);\n\t}\n\tdone(url: string) {\n\t\tthis.$.header.classList.remove(`tick`);\n\t\tthis.$.header.classList.add(`done`);\n\t\tthis.$.title.innerText =  `Printing complete`;\n\t\tlet line = document.createElement(`div`);\n\t\tline.innerHTML = `Your pdf is ready at <a href=\"${url}\" target=\"blank\">${url}</a>`;\n\t\tline.classList.add(`done`);\n\t\tthis.$.terminal.appendChild(line);\n\t\tthis.scrollBottom();\n\t}\n\t\n}","import {EBW} from './EBW';\nimport {FileListDialog, FileListDialogResult} from './FileListDialog';\nimport EventSource = require('./sse');\nimport {PrintListenerTerminal} from './PrintListenerTerminal';\n\nexport class PrintListener {\n\tprotected listDialog: FileListDialog;\n\n\tconstructor(protected repoOwner:string, \n\t\tprotected repoName:string, \n\t\tprotected book:string=`book`,\n\t\tprotected format:string=`print`) {\n\t\tthis.listDialog = new FileListDialog();\n\n\t\tif (``==this.book) {\n\t\t\tthis.book = `book`;\n\t\t}\n\t\tif ((`print`!=format) && (`screen`!=format)) {\n\t\t\tEBW.Error(`PrintListener format parameter must be either 'print' or 'screen'`);\n\t\t\treturn;\n\t\t}\n\t\tEBW.API().FindFileLists(repoOwner, repoName).then(\n\t\t\t([files]:[string[]])=>{\n\t\t\t\t// console.log(`Files directories are `, files);\n\t\t\t\t// debugger;\n\t\t\t\t// files.push(files[0]);\n\t\t\t\tif (2>files.length) {\n\t\t\t\t\treturn Promise.resolve<string>(0==files.length ? `` : files[0]);\n\t\t\t\t}\n\t\t\t\treturn this.listDialog.Open(files)\n\t\t\t\t\t.then(\n\t\t\t\t\t\t(res:FileListDialogResult)=>{\n\t\t\t\t\t\t\tif (res.Cancelled) {\n\t\t\t\t\t\t\t\treturn Promise.resolve<string>(undefined);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn Promise.resolve<string>(res.FileList);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t}).then(\n\t\t\t(filedir?:string)=>{\n\t\t\t\tif ('undefined'==typeof filedir) {\n\t\t\t\t\treturn Promise.resolve<[any]>([undefined]);\n\t\t\t\t}\n\t\t\t\treturn EBW.API().PrintPdfEndpoint(repoOwner, repoName, book, format, filedir);\n\t\t\t}).then(\n\t\t\t([url]:[string])=>{\n\t\t\t\tif ('undefined'==typeof url) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.startListener(url);\n\t\t\t}).catch( EBW.Error );\n\t}\n\tstartListener(key:string) {\n\t\tlet terminal = new PrintListenerTerminal();\n\n\t\tlet url = document.location.protocol +\n\t\t\t\t \"//\" +\n\t\t\t\t document.location.host + \"/print/sse/\" + key;\n\t\tlet sse = new EventSource(url);\n\t\tsse.addEventListener(`open`, function() {\n\t\t});\n\t\tsse.addEventListener('tick', function(e:any) {\n\t\t\tterminal.ticktock();\n\t\t});\n\t\tsse.addEventListener(`info`, function(e:any) {\n\t\t\t// console.log(`INFO on printListener: `, e.data);\n\t\t\tlet data = JSON.parse(e.data);\n\t\t\tterminal.addLine(data.log);\n\t\t});\n\t\tsse.addEventListener(`log`, function(e:any) {\n\t\t\tlet data = JSON.parse(e.data);\n\t\t\tterminal.addLine(data.log);\n\t\t})\n\t\tsse.addEventListener(`error`, function(e:any) {\n\t\t\tlet err = JSON.parse(e.data);\n\t\t\tEBW.Error(err);\n\t\t\tsse.close();\n\t\t\tterminal.addError(err.log);\n\t\t});\n\t\tsse.addEventListener(`output`, (e:any)=> {\n\t\t\tlet data = JSON.parse(e.data);\n\t\t\tlet url = document.location.protocol +\n\t\t\t\t \"//\" +\n\t\t\t\t document.location.host + \n\t\t\t\t `/www/${this.repoOwner}/${this.repoName}/${data}`;\n\t\t\tEBW.Toast(`Your PDF is ready: opening in a new window.`);\n\t\t\tterminal.done(url);\n\t\t\twindow.open(url, `${this.repoOwner}-${this.repoName}-pdf`);\n\t\t});\n\t\tsse.addEventListener(`done`, function(e:any) {\n\t\t\tsse.close();\n\t\t});\n\t\tsse.onmessage = (e:any)=>{\n\t\t\tthis.onmessage(e);\n\t\t}\n\t\tsse.onerror = EBW.Error;\n\n\t}\n\tonmessage(e:any) {\n\t\tconsole.log(`PrintListener.onmessage: `, e);\n\t}\n}\n","import {BoundFilename as Template} from './Templates';\n\nexport class BoundFilename extends Template {\n\tconstructor(protected repoOwner:string, protected repoName:string, protected parent:HTMLElement, editorElement: HTMLElement) {\n\t\tsuper();\n\t\tif (!editorElement) {\n\t\t\teditorElement = document.body as HTMLElement;\n\t\t}\n\t\teditorElement.addEventListener('BoundFileChanged', (evt:CustomEvent)=>{\n\t\t\tthis.$.filename.innerText = evt.detail;\n\t\t\tthis.$.a.href = `https://github.com/${this.repoOwner}/${this.repoName}/commits/master/${evt.detail}`;\n\t\t});\n\t\tthis.parent.appendChild(this.el);\n\t\tconsole.log(`BoundFilename: `, this, this.el);\n\t}\n\tstatic SetFilename(name:string):void {\n\t\tlet evt = new CustomEvent(`BoundFileChanged`, {\"detail\":name});\n\t\tdocument.body.dispatchEvent(evt);\n\t}\n\tstatic BindAll(repoOwner:string, repoName:string) : void {\n\t\tlet els = document.querySelectorAll(`[ebw-bind=\"current-filename\"]`);\n\t\tfor (let i = 0; i<els.length; i++) {\n\t\t\tnew BoundFilename(repoOwner, repoName, els.item(i) as HTMLElement, null);\n\t\t}\n\t}\n}","import CodeMirror = require('codemirror');// from 'codemirror';\n\nexport class EditorCodeMirror {\n\tprotected cm : any;\n\tconstructor(parent:HTMLElement) {\n\t\tthis.cm = CodeMirror(parent, {\n\t\t\t'mode': 'markdown',\n\t\t\t'lineNumbers':true,\n\t\t\t'lineWrapping': true\n\t\t});\n\t}\n\tstatic Template() : string {\n\t\treturn 'RepoFileEditor_codemirror';\n\t}\n\tgetValue() : string {\n\t\treturn this.cm.getDoc().getValue();\n\t}\n\tsetValue(s:string) : void {\n\t\tthis.cm.getDoc().setValue(s);\n\t\tthis.cm.refresh();\n\t}\n\tgetHistory() : string {\n\t\treturn JSON.stringify(this.cm.getHistory());\n\t}\n\tsetHistory(hist?:string) : void {\n\t\tif (hist) {\n\t\t\tthis.cm.setHistory(JSON.parse(hist));\n\t\t} else {\n\t\t\tthis.cm.clearHistory();\n\t\t}\n\t}\n\n\t/**\n\t * focus sets the input focus to the editor\n\t */\n\tfocus() : void {\n\t\tthis.cm.focus();\n\t}\n\n\t/**\n\t * setModeOnFilename sets the editor mode / highlighting\n\t * based on the filename of the file you're editing.\n\t */\n\tsetModeOnFilename(filename:string) {\n\t\tlet r = /\\.([^\\.]+)$/;\n\t\tlet res = r.exec(filename);\n\t\tif (2==res.length) {\n\t\t\tlet suffix = res[1];\n\t\t\tlet modes = new Map<string,string>();\n\t\t\tmodes.set('md','markdown');\n\t\t\tmodes.set('js','javascript');\n\t\t\tmodes.set('css','css');\n\t\t\tmodes.set('scss','sass');\n\t\t\tmodes.set('sass','sass');\n\t\t\tmodes.set('yaml','yaml');\n\t\t\tmodes.set('yml','yaml');\n\t\t\tmodes.set('xml','xml');\n\n\t\t\tlet mode = modes.get(res[1]);\n\t\t\tif (mode) {\n\t\t\t\tthis.cm.setOption(`mode`, mode);\n\t\t\t}\n\t\t}\n\t}\n}","export function AddToParent(parent:((el:HTMLElement)=>void)|HTMLElement|undefined, el: HTMLElement) {\n\tif (!parent) {\n\t\treturn;\n\t}\n\tif ('function'==typeof parent) {\n\t\tparent(el);\n\t\treturn;\n\t}\n\tparent.appendChild(el);\n}","import {EditorImage as Template} from './Templates';\nimport {FSFileEdit} from './FS/FSFileEdit';\nimport {AddToParent} from './DOM';\n\nimport signals = require('signals');\n\nexport class EditorImage extends Template {\n\tprotected file: FSFileEdit;\n\tconstructor(\n\t\tprotected parent: HTMLElement, \n\t\tprotected repoOwner: string,\n\t\tprotected repoName: string\n\t\t) {\n\t\tsuper();\n\t\tAddToParent(parent, this.el);\n\t}\n\tsetFile(f:FSFileEdit) {\n\t\tthis.file = f;\n\t\tlet L = document.location;\n\t\tlet imageUrl = `url('/www/` + \n\t\t\t`${this.repoOwner}/${this.repoName}/${f.Name()}')`;\n\t\tthis.el.style.backgroundImage = imageUrl;\n\t}\n}","/**\n * FileStat provides information on the status of a file\n * in a given filesystem.\n */\nexport enum FileStat {\n\t/** The file exists an is unchanged */\n\tExists = 1,\n\t/** The file exists, and has changed */\n\tChanged = 2,\n\t/** The file is a new file */\n\tNew = 3,\n\t/** The file is deleted / marked for deletion */\n\tDeleted = 4,\n\t/** The file does not exist */\n\tNotExist = 5\n};\n\nexport function FileStatString(fs:FileStat) : string {\n\tswitch(fs) {\n\t\tcase FileStat.Exists:\n\t\t\treturn \"Exists\";\n\t\tcase FileStat.Changed:\n\t\t\treturn \"Changed\";\n\t\tcase FileStat.New:\n\t\t\treturn \"New\";\n\t\tcase FileStat.Deleted:\n\t\t\treturn \"Deleted\";\n\t\tcase FileStat.NotExist:\n\t\t\treturn \"NotExist\";\n\t}\n\tdebugger;\n\treturn \"-- ERROR : undefined FileStat ---\";\n}\n\nexport class FileContent {\n\tconstructor(\n\t\tpublic readonly Name:string, \n\t\tpublic readonly Stat:FileStat, \n\t\tpublic readonly Content?:string,\n\t\tpublic Original?: FileContent) {\n\t}\n\tIsContentKnown(): boolean {\n\t\treturn (undefined!=typeof this.Content);\n\t}\n\tSerialize() : string {\n\t\treturn JSON.stringify(this);\n\t}\n\tstatic FromJS(json:string) {\n\t\tlet js = JSON.parse(json);\n\t\treturn new FileContent(js.Name, js.Stat, js.Content);\n\t}\n\tOriginalName() : string {\n\t\tif (this.Original) {\n\t\t\treturn this.Original.OriginalName();\n\t\t}\n\t\treturn this.Name;\n\t}\n};\n\n\n/**\n * FS is the interface implemented by all filesystems.\n */\nexport interface FS {\n\t/**\n\t * Read returns the FileContent of the file, which \n\t * may, or may not, know the file's content. Hence some\n\t * cache FS's might know of a file's existence, but not \n\t * have the content in-cache.\n\t */\n\tRead(path:string) : Promise<FileContent>;\n\t/**\n\t * Remove removes / deletes the file. The Stat of the file\n\t * post Remove depends on the FS. Some FS's, such as\n\t * FSRemote, will report FileStat.NotExist after Remove,\n\t * while others, such as FSSession or FSOverlay, might\n\t * report FileStat.Deleted, indicating that the file is known\n\t * to be deleted, but that this 'deletion' hasn't yet been\n\t * synced to the underlying FS.\n\t *\n\t * Remove takes an option FileStat parameter which is the\n\t * suggested stat for the file post removal. This allows\n\t * an aggregating filesystem to use a caching filesystem\n\t * with a suggestion about how the caching filesystem\n\t * should handle the Removal : eg. NotExist or Deleted.\n\t */\n\tRemove(path:string,stat?:FileStat):Promise<FileContent>;\n\t/** \n\t * Rename renames a file, and returns the FileContent for\n\t * the renamed file.\n\t */\n\tRename(fromPath:string,toPath:string):Promise<[FileContent,FileContent]>;\n\t/**\n\t * Returns the RepoOwner and RepoName's provided for the\n\t * filesystem.\n\t */\n\tRepoOwnerName():[string,string];\n\t/**\n\t * Revert is only supported on some filesystems, and \n\t * reverts the file's content to the underlying filesystem\n\t * content, discarding unsaved local changes.\n\t */\n\tRevert(path:string): Promise<FileContent>;\n\t/**\n\t * Stat returns the stat of the given file.\n\t */\n\tStat(path:string) : Promise<FileStat>;\n\t/** \n\t * Sync is only supported on some filesystems, and \n\t * synchronizes a caching filesystem with an underlying\n\t * filesystem.\n\t */\n\tSync(path?:string):Promise<FileContent[]>;\n\t/** \n\t * Write writes the file. If the content parameter is\n\t * not provided, the existence of the file is marked with some\n\t * FS's, but its content isn't recorded.\n\t */\n\tWrite(path:string, stat:FileStat, content?:string):Promise<FileContent>;\n\t/**\n\t * IsDirty reports whether the given file path is \n\t * dirty. Some file systems don't support Dirty, since they\n\t * are entirely commit-based, while others, such as FSOverlay,\n\t * permit a sense of a Dirty file.\n\t */\n\tIsDirty(path:string):Promise<boolean>;\n}\n","export class ImageIdentify {\n\tstatic isImage(name : string) : boolean {\n\t\tlet imgRegexp = new RegExp(`.*\\.(jpg|png|tiff|svg|gif)$`);\n\t\treturn imgRegexp.test(name);\n\t}\n}","import {BoundFilename} from './BoundFilename';\nimport {Eventify} from './Eventify';\nimport {RepoFileEditorCM as Template} from './Templates';\nimport {EditorCodeMirror} from './EditorCodeMirror';\nimport {EditorImage} from './EditorImage';\nimport {EBW} from './EBW';\nimport {FileContent, FileStat, FileStatString} from './FS/FS';\nimport {FSFileEdit} from './FS/FSFileEdit';\nimport {ImageIdentify} from './ImageIdentify';\n\nimport signals = require('signals');\n\ninterface RepoFileEditorCallbacks {\n\tRename: ()=>void;\n}\n\nenum EditorEvents {\n\tSAVED = 1,\n\tCHANGED = 2,\n\tLOADED = 3\n}\n\nclass repoEditorActionBar {\n\tprotected saveButton: HTMLButtonElement;\n\tprotected undoButton: HTMLButtonElement;\n\tprotected deleteButton: HTMLButtonElement;\n\tprotected renameButton: HTMLButtonElement;\n\n\tconstructor(protected editor:RepoFileEditorCM) {\n\t\tthis.saveButton = document.getElementById(`editor-save-button`) as HTMLButtonElement;\n\t\tthis.saveButton.addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault();\n\t\t\tthis.editor.saveEditorFile();\n\t\t});\n\t\tthis.undoButton = document.getElementById(`editor-undo-button`) as HTMLButtonElement;\n\t\tthis.undoButton.addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault();\n\t\t\tthis.editor.undoEditorFile();\n\t\t});\n\t\tthis.deleteButton = document.getElementById(`editor-delete-button`) as HTMLButtonElement;\n\t\tthis.deleteButton.addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault();\n\t\t\tthis.editor.deleteEditorFile();\n\t\t});\n\t\tthis.renameButton = document.getElementById(`editor-rename-button`) as HTMLButtonElement;\n\t\tthis.editor.EditEvents.add(this.EditEvents, this);\n\t}\n\tEditEvents(ev:EditorEvents, file:FSFileEdit) : void {\n\t\tif (!file) {\n\t\t\tthis.deleteButton.disabled = true;\n\t\t\tthis.deleteButton.innerText = 'Delete';\n\t\t\tthis.saveButton.disabled = true;\n\t\t\tthis.undoButton.disabled = true;\n\t\t\tthis.renameButton.disabled = true;\n\t\t\treturn;\n\t\t}\n\t\tthis.deleteButton.disabled = false;\n\t\tthis.saveButton.disabled = false;\n\t\tthis.undoButton.disabled = false;\n\t\tthis.renameButton.disabled = false;\n\t\t//console.log(`repoEditorActionBar: file = `, file.FileContent() ? FileStatString(file.FileContent().Stat) : \"\", file );\n\t\tthis.deleteButton.innerText = (file.IsDeleted()) ? \"Undelete\": \"Delete\";\n\t}\n}\n\n/**\n * RepoFileEditorCM is a file editor that wraps what was meant to be\n * a generic editor, but in actual fact turns out to have some\n * dependencies upon CodeMirror, and hence isn't entirely generic.\n */\nexport class RepoFileEditorCM extends Template {\n\tprotected textEditor : EditorCodeMirror;\n\tprotected imageEditor: EditorImage;\n\t\n\tprotected loadingFile : FSFileEdit;\n\tprotected file: FSFileEdit;\n\tprotected undoKey: string;\n\tpublic EditEvents: signals.Signal;\n\n\tconstructor(\n\t\trepoOwner: string,\n\t\trepoName: string,\n\t\tprotected parent:HTMLElement,\n\t\tprotected callbacks: RepoFileEditorCallbacks\n\t\t) {\n\t\tsuper();\n\t\tthis.undoKey = `RepoFileEditorCM:UndoHistory:${encodeURIComponent(repoOwner)}:${encodeURIComponent(repoName)}:`;\n\t\tthis.EditEvents = new signals.Signal();\n\t\tnew repoEditorActionBar(this);\n\t\tthis.EditEvents.dispatch(EditorEvents.LOADED, undefined);\n\n\t\tthis.textEditor = new EditorCodeMirror(this.$.textEditor);\n\t\tthis.imageEditor = new EditorImage(this.$.imageEditor, repoOwner, repoName);\n\t\tthis.parent.appendChild(this.el);\n\t\tBoundFilename.BindAll(repoOwner, repoName);\n\t}\n\n\tundoEditorFile() {\n\t\tEBW.Confirm(`Undo the changes you've just made to ${this.file.Name()}?`)\n\t\t.then(\n\t\t\t(b:boolean)=>{\n\t\t\t\tif (!b) return;\n\t\t\t\tthis.file.Revert()\n\t\t\t\t.then(\n\t\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\t\tthis.file.SetFileContent(fc);\n\t\t\t\t\t\tthis.textEditor.setValue(fc.Content);\n\t\t\t\t\t\tthis.EditEvents.dispatch(EditorEvents.CHANGED, this.file);\n\t\t\t\t\t});\n\t\t\t});\t\t\n\t}\n\n\t/**\n\t * deleteEditorFile handles file deleting and undeleting.\n\t */\n\tdeleteEditorFile() {\n\t\tif (!this.file) {\n\t\t\tEBW.Alert(`Please choose a file before using delete/undelete`);\n\t\t\treturn;\n\t\t}\n\t\tif (this.file.IsDeleted()) {\n\t\t\tthis.file.Save(this.textEditor.getValue(), FileStat.Changed)\n\t\t\t.then(\n\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\tif (fc.Stat!=FileStat.NotExist) {\n\t\t\t\t\t\tthis.file.SetFileContent(fc);\n\t\t\t\t\t\tthis.EditEvents.dispatch(EditorEvents.CHANGED, this.file);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.file = undefined;\n\t\t\t\t\t\tthis.setFile(undefined);\n\t\t\t\t\t\tthis.EditEvents.dispatch(EditorEvents.LOADED, undefined);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tEBW.Confirm(`Are you sure you want to delete ${this.file.Name()}?`)\n\t\t.then(\n\t\t\t()=>{\n\t\t\t\treturn this.file.Remove()\n\t\t\t\t.then( (fc:FileContent)=> {\n\t\t\t\t\tif (fc.Stat == FileStat.NotExist) {\n\t\t\t\t\t\tthis.file = undefined;\n\t\t\t\t\t\tthis.setFile(undefined);\t\n\t\t\t\t\t\tthis.EditEvents.dispatch(EditorEvents.LOADED, undefined);\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.file.SetFileContent(fc);\n\t\t\t\t\t\tthis.EditEvents.dispatch(EditorEvents.CHANGED, this.file);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t})\n\t\t.catch( EBW.Error );\n\t}\n\n\tsaveEditorFile() {\n\t\tthis.file.Save(this.textEditor.getValue())\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tconsole.log(`About to Sync ${this.file.Name()}`);\n\t\t\t\treturn this.file.Sync();\t\t\t\t\n\t\t\t})\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tif (fc.Stat == FileStat.NotExist) {\n\t\t\t\t\tEBW.Toast(`${this.file.Name()} removed`);\n\t\t\t\t\t// By presetting file to undefined, we ensure that\n\t\t\t\t\t// setFile doesn't save the file again\n\t\t\t\t\tthis.file = undefined;\n\t\t\t\t\tthis.setFile(undefined);\t\n\t\t\t\t\tthis.EditEvents.dispatch(EditorEvents.LOADED, undefined);\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\t\tthis.file.SetFileContent(fc);\n\t\t\t\t\tthis.EditEvents.dispatch(EditorEvents.CHANGED, this.file);\n\t\t\t\t\tEBW.Toast(`${this.file.Name()} saved.`);\n\t\t\t\t}\n\t\t\t})\n\t\t.catch(\n\t\t\t(err:any)=>{\n\t\t\t\tconsole.error(err);\n\t\t\t\tEBW.Error(err)\n\t\t\t});\t\t\n\t}\n\tsetText(text:string){\n\t\tif ('string'!=typeof text) {\n\t\t\tdebugger;\n\t\t}\n\t\tthis.textEditor.setValue(text);\n\t}\n\t/**\n\t * saveHistoryFor saves the history for the given path\n\t */\n\tprotected saveHistoryFor(path:string) {\n\t\tlet key = this.undoKey + path;\n\t\tsessionStorage.setItem(key, this.textEditor.getHistory());\n\t}\n\t/**\n\t * restoreHistoryFor restores the history for the given\n\t * path\n\t */\n\tprotected restoreHistoryFor(path:string) {\n\t\tlet key  =this.undoKey + path;\n\t\tthis.textEditor.setHistory(sessionStorage.getItem(key));\n\t}\n\n\n\tsetFile(file:FSFileEdit) {\n\t\tif (this.file) {\n\t\t\tif (this.file.Name()==file.Name()) {\n\t\t\t\t// Cannot set to the file we're currently editing\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.file.Save(this.textEditor.getValue());\n\t\t\tthis.file.SetEditing(false);\n\t\t\tthis.saveHistoryFor(this.file.Name());\n\t\t}\n\t\tif ('undefined'==typeof file) {\n\t\t\tthis.file = undefined;\n\t\t\tthis.setText('Please select a file to edit.');\n\t\t\tthis.setBoundFilenames();\n\t\t\tthis.EditEvents.dispatch(EditorEvents.LOADED, undefined);\n\t\t\treturn;\n\t\t}\n\t\tif (ImageIdentify.isImage(file.Name())) {\n\t\t\tthis.imageEditor.setFile(file);\n\t\t\tthis.showImageEditor();\n\t\t\tthis.file = undefined;\n\t\t\tthis.EditEvents.dispatch(EditorEvents.LOADED, undefined);\n\t\t\treturn;\n\t\t}\n\t\tthis.showTextEditor();\n\n\t\tthis.loadingFile = file;\n\t\tfile.GetText()\n\t\t.then(\n\t\t\t(t:string)=>{\n\t\t\t\t// If we start loading file A, then start loading file\n\t\t\t\t// B, and file B returns before file A, when file A\n\t\t\t\t// returns, we are configuring ourselves as file A when\n\t\t\t\t// in fact we should be file B.\n\t\t\t\t// This if statement catches an 'out-of-sequence' \n\t\t\t\t// loaded A, and just ignores it, since we are now loading\n\t\t\t\t// B.\n\t\t\t\tif (this.loadingFile.Name()!=file.Name()) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.file = file;\n\t\t\t\tthis.file.SetEditing(true);\n\t\t\t\tthis.setBoundFilenames();\n\t\t\t\tthis.setText(t);\n\t\t\t\tthis.restoreHistoryFor(this.file.Name());\n\t\t\t\tthis.textEditor.setModeOnFilename(file.Name());\n\t\t\t\tthis.textEditor.focus();\n\t\t\t\tthis.EditEvents.dispatch(EditorEvents.CHANGED, this.file);\n\t\t\t})\n\t\t.catch(\n\t\t\t(err:any)=>{\n\t\t\t\tEBW.Error(err);\n\t\t\t});\n\t}\n\tFile() : FSFileEdit {\n\t\treturn this.file;\n\t}\n\tRename(name:string) : Promise<void> {\n\t\treturn this.file.Rename(name)\n\t\t.then( ()=>{\n\t\t\tconsole.log(`Rename is concluded: this.file = `, this.file);\n\t\t\tBoundFilename.SetFilename(name);\n\t\t\treturn Promise.resolve();\n\t\t});\n\t}\n\tprotected setBoundFilenames() {\n\t\tlet filename = 'CHOOSE A FILE';\n\t\tif (this.file) {\n\t\t\tfilename = this.file.Name();\n\t\t}\n\t\tBoundFilename.SetFilename(filename);\n\t}\n\n\tprotected showImageEditor() {\n\t\tthis.$.textEditor.style.display='none';\n\t\tthis.$.imageEditor.style.display='block';\n\t}\n\tprotected showTextEditor() {\n\t\tthis.$.textEditor.style.display='block';\n\t\tthis.$.imageEditor.style.display='none';\n\t}\n}\n","import {EBW} from '../EBW';\nimport {FS,FileStat,FileContent} from './FS';\n\nimport signals = require('signals');\n\n/**\n * FSFileEdit is a wrapper around a file that is being\n * edited.\n */\nexport class FSFileEdit {\n\tpublic DirtySignal: signals.Signal;\n\tpublic EditingSignal : signals.Signal;\n\tprotected editing: boolean;\n\n\tconstructor(\n\t\tprotected fc:FileContent,\n\t\tprotected FS:FS) \n\t{\n\t\tthis.DirtySignal = new signals.Signal();\n\t\tthis.EditingSignal = new signals.Signal();\n\t}\n\tSetFileContent(fc:FileContent):void {\n\t\tthis.fc = fc;\n\t}\n\tFileContent() : FileContent {\n\t\treturn this.fc;\n\t}\n\tRevert():Promise<FileContent> {\n\t\treturn this.FS.Revert(this.fc.Name)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.fc = fc;\n\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t});\n\t}\n\tRename(toPath:string):Promise<[FileContent,FileContent]> {\n\t\tlet oldName = this.fc.Name;\n\t\treturn this.FS.Rename(this.fc.Name,toPath)\n\t\t.then(\n\t\t\t([fOld, fNew]:[FileContent,FileContent])=>{\n\t\t\t\tthis.FS.Sync(oldName);\n\t\t\t\tthis.fc = fNew;\n\t\t\t\tthis.Sync();\n\t\t\t\t// this.signalDirty();\n\t\t\t\treturn Promise.resolve<[FileContent,FileContent]>([fOld, fNew]);\n\t\t\t});\n\t}\n\tRemove(): Promise<FileContent> {\n\t\treturn this.FS.Remove(this.fc.Name)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.fc = fc;\n\t\t\t\tthis.signalDirty();\n\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t});\n\t}\n\tName() : string {\n\t\treturn this.fc.Name;\n\t}\n\tSetEditing(editing: boolean):void {\n\t\tthis.editing = editing;\n\t\tthis.EditingSignal.dispatch(this, editing);\n\t}\n\tIsDeleted():boolean {\n\t\treturn this.fc.Stat == FileStat.Deleted;\n\t}\n\tIsEditing():boolean {\n\t\treturn this.editing;\n\t}\n\tIsDirty():Promise<boolean> {\n\t\treturn this.FS.IsDirty(this.fc.Name);\n\t}\n\tprotected signalDirty() {\n\t\tthis.IsDirty().then(\n\t\t\t(dirty:boolean)=>{\n\t\t\t\tthis.DirtySignal.dispatch(this, dirty);\n\t\t\t})\n\t}\n\tSave(t:string, fs?:FileStat):Promise<FileContent> {\n\t\t// If FileStat is Changed, or Deleted, we want to keep \n\t\t// that stat.\n\t\tif (!fs) {\n\t\t\tfs = this.fc.Stat;\n\t\t\tif (fs==FileStat.New || fs==FileStat.Exists || fs==FileStat.NotExist) {\n\t\t\t\tfs = FileStat.Changed;\n\t\t\t}\n\t\t}\n\t\treturn this.FS.Write(this.fc.Name, fs, t)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.fc = fc;\n\t\t\t\tthis.signalDirty();\n\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t});\n\t}\n\n\tSync():Promise<FileContent> {\n\t\treturn this.FS.Sync(this.fc.Name)\n\t\t.then(\n\t\t\t(fcs:FileContent[])=>{\n\t\t\t\tlet fc = fcs[0];\n\t\t\t\tthis.fc = fc;\n\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t});\t\t\t\t\n\t}\n\tGetText():Promise<string> {\n\t\tif (this.fc.Content) {\n\t\t\treturn Promise.resolve<string>(this.fc.Content);\n\t\t}\n\t\treturn this.FS.Read(this.fc.Name)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tconsole.log(`FSFileEdit.FS.Read returned `, fc);\n\t\t\t\tthis.fc = fc;\n\t\t\t\treturn Promise.resolve<string>(fc.Content);\n\t\t\t});\n\t}\n}","import {EBW} from './EBW';\nimport {Eventify} from './Eventify';\nimport {RepoEditorPage_NewFileDialog as Template} from './Templates';\nimport {RepoFileEditorCM} from './RepoFileEditorCM';\nimport {DialogEvents, FoundationRevealDialog as Dialog} from './FoundationRevealDialog';\nimport {FS,FileStat,FileContent} from './FS/FS';\nimport {FSFileEdit} from './FS/FSFileEdit';\n\nimport jQuery = require('jquery');\n\n/**\n * RepoEditorPage_NewFileDialog displays a new file\n * dialog on the RepoPageEditor page.\n *\n */\nexport class RepoEditorPage_NewFileDialog extends Template {\n\tprotected $el : any;\n\tprotected dialog: Dialog;\n\tprotected repoOwner: string;\n\tprotected repoName: string;\n\tconstructor(\n\t\topenElement:HTMLElement, \n\t\tprotected FS:FS,\n\t\tprotected editor: RepoFileEditorCM,\n\t) {\n\t\tsuper();\n\t\t[this.repoOwner, this.repoName] = this.FS.RepoOwnerName();\n\t\tdocument.body.appendChild(this.el);\n\t\tthis.$el = jQuery(this.el);\n\t\tEventify(this.el, {\n\t\t\t\"click\": (evt:any)=>{\n\t\t\t\tlet filename = this.$.filename.value;\n\t\t\t\tthis.FS.Stat(filename)\n\t\t\t\t.then(\n\t\t\t\t\t(fs:FileStat)=>{\n\t\t\t\t\t\tif (!(fs==FileStat.NotExist || fs==FileStat.Deleted)) {\n\t\t\t\t\t\t\tEBW.Alert(`A file named ${filename} already exists`);\n\t\t\t\t\t\t\treturn;\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.FS.Write(filename, FileStat.New, ``)\n\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\t\t\t\tthis.dialog.Close();\n\t\t\t\t\t\t\t\tlet edit = new FSFileEdit(fc, FS);\n\t\t\t\t\t\t\t\tthis.editor.setFile(edit);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t},\n\t\t\t\"change\": (evt:any)=>{\n\n\t\t\t}\n\t\t});\n\n\t\tthis.dialog = new Dialog(openElement, this.el);\n\t\tthis.dialog.Events.add( (act:DialogEvents)=>{\n\t\t\tswitch (act) {\n\t\t\t\tcase DialogEvents.Opened:\n\t\t\t\t\tthis.$.filename.value = '';\n\t\t\t\t\tthis.$.filename.focus();\n\t\t\t\t\tbreak;\n\t\t\t\tcase DialogEvents.Closed:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t}\n}","import {EBW} from './EBW';\nimport {Eventify} from './Eventify';\nimport {DialogEvents, FoundationRevealDialog as Dialog} from './FoundationRevealDialog';\nimport {RepoEditorPage_RenameFileDialog as Template} from './Templates';\nimport {RepoFileEditorCM} from './RepoFileEditorCM';\nimport {FS,FileContent, FileStat} from './FS/FS';\nimport {FSFileEdit} from './FS/FSFileEdit';\n\nimport jQuery = require('jquery');\n\n/**\n * RepoEditorPage_RenameFileDialog displays a Rename file\n * dialog on the RepoPageEditor page.\n */\nexport class RepoEditorPage_RenameFileDialog extends Template {\n\tprotected $el : any;\n\tprotected dialog : Dialog;\n\tprotected repoOwner: string;\n\tprotected repoName: string;\n\tconstructor(\n\t\topenElement:HTMLElement, \n\t\tprotected FS: FS,\n\t\tprotected editor: RepoFileEditorCM\n\t) {\n\t\tsuper();\n\t\t[this.repoOwner, this.repoName] = this.FS.RepoOwnerName();\n\t\tEventify(this.el, {\n\t\t\t\"click\": (evt:any)=>{\n\t\t\t\tlet toName = this.$.filename.value;\n\t\t\t\tthis.editor.Rename(toName)\n\t\t\t\t.then(\n\t\t\t\t\t()=>{\n\t\t\t\t\t\tthis.dialog.Close();\n\t\t\t\t\t})\n\t\t\t\t.catch(EBW.Error);\n\t\t\t},\n\t\t\t\"change\": (evt:any)=>{\n\n\t\t\t}\n\t\t});\n\t\tthis.dialog = new Dialog(openElement, this.el);\n\t\tthis.dialog.Events.add( (act:DialogEvents)=>{\n\t\t\tswitch (act) {\n\t\t\t\tcase DialogEvents.Opened:\n\t\t\t\t\tthis.$.filename.value = this.editor.File().Name();\n\t\t\t\t\tthis.$.filename.focus();\n\t\t\t\t\tthis.$.current_name.innerText = this.editor.File().Name();\n\t\t\t\t\tbreak;\n\t\t\t\tcase DialogEvents.Closed:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t}\n}","import {FS, FileContent, FileStat} from './FS';\n\nimport signals = require('signals');\n\n/**\n * FSNotify implements a FS that passes all actual\n * functions through to an underlying FS, but that\n * notifies listeners of activities on the FS.\n */\nexport class FSNotify {\n\tpublic Listeners : signals.Signal;\n\n\tconstructor(protected source:FS) {\n\t\tthis.Listeners = new signals.Signal();\n\t}\n\tWrite(path:string, stat:FileStat, content?:string):Promise<FileContent> {\n\t\treturn this.source.Write(path,stat,content)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.Listeners.dispatch(path, fc);\n\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t});\n\t}\n\tRemove(path:string,stat?:FileStat):Promise<FileContent> {\n\t\treturn this.source.Remove(path,stat)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.Listeners.dispatch(path, fc);\n\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t});\n\t}\n\tRename(fromPath:string,toPath:string) : Promise<[FileContent,FileContent]> {\n\t\treturn this.source.Rename(fromPath, toPath)\n\t\t.then(\n\t\t\t([fOld, fNew]:[FileContent,FileContent])=>{\n\t\t\t\tthis.Listeners.dispatch(fromPath, fOld);\n\t\t\t\tthis.Listeners.dispatch(toPath, fNew);\n\t\t\t\treturn Promise.resolve<[FileContent,FileContent]>([fOld,fNew]);\n\t\t\t});\n\t}\n\tRevert(path:string): Promise<FileContent> {\n\t\treturn this.source.Revert(path)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.Listeners.dispatch(path, fc);\n\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t});\n\t}\n\tSync(path?:string):Promise<FileContent[]> { \n\t\treturn this.source.Sync(path)\n\t\t.then(\n\t\t\t(fcs:FileContent[])=>{\n\t\t\t\tfor (let fc of fcs) {\n\t\t\t\t\tthis.Listeners.dispatch(fc.Name, fc);\n\t\t\t\t}\n\t\t\t\treturn Promise.resolve<FileContent[]>(fcs);\n\t\t\t});\n\t}\n\t//=============================================================\n\t//======= all methods below this point simply pass their calls\n\t//======= to the underlying FS, and don't require notification.\n\t//=============================================================\n\tRepoOwnerName():[string,string] { return this.source.RepoOwnerName(); }\t\n\tStat(path:string) : Promise<FileStat> { return this.source.Stat(path); }\n\tRead(path:string) : Promise<FileContent> { return this.source.Read(path); }\n\tIsDirty(path:string):Promise<boolean> { return this.source.IsDirty(path); }\n}","import {FS,FileStat,FileContent} from './FS';\n\nexport class FSOverlay {\n\tprotected changes : Set<string>;\n\tconstructor(protected below:FS, protected above:FS) {\n\t\tthis.changes = new Set<string>();\n\t}\n\n\tIsDirty(path:string) : Promise<boolean> {\n\t\treturn this.above.Stat(path)\n\t\t.then(\n\t\t\t(aboveStat:FileStat)=>{\n\t\t\t\tif (aboveStat==FileStat.Exists || aboveStat==FileStat.NotExist) {\n\t\t\t\t\treturn Promise.resolve<boolean>(false);\n\t\t\t\t}\n\t\t\t\tif (aboveStat==FileStat.New) {\n\t\t\t\t\treturn Promise.resolve<boolean>(true);\n\t\t\t\t}\n\t\t\t\treturn this.below.Stat(path)\n\t\t\t\t.then(\n\t\t\t\t\t(belowStat)=>{\n\t\t\t\t\t\tswitch(belowStat) {\n\t\t\t\t\t\t\tcase FileStat.NotExist:\n\t\t\t\t\t\t\t//fallthrough\n\t\t\t\t\t\t\tcase FileStat.Changed:\n\t\t\t\t\t\t\t//fallthrough\n\t\t\t\t\t\t\tcase FileStat.New:\n\t\t\t\t\t\t\t//fallthrough\n\t\t\t\t\t\t\tcase FileStat.NotExist:\n\t\t\t\t\t\t\t\treturn Promise.resolve<boolean>(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn Promise.all([this.above.Read(path), this.below.Read(path)])\n\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\t(fcs:FileContent[])=>{\n\t\t\t\t\t\t\t\tlet [aboveC, belowC] = fcs;\n\t\t\t\t\t\t\t\t// console.log(`FSOverlay.IsDirty(${path}): aboveC =`);\n\t\t\t\t\t\t\t\t// console.log(aboveC);\n\t\t\t\t\t\t\t\t// console.log(`belowC = `);\n\t\t\t\t\t\t\t\t// console.log(belowC);\n\t\t\t\t\t\t\t\t// console.log(`Resolving aboveC.Content!=belowC.Content = `,\n\t\t\t\t\t\t\t\t\t// aboveC.Content != belowC.Content);\n\t\t\t\t\t\t\t\tif (!aboveC.Content) {\n\t\t\t\t\t\t\t\t\treturn Promise.resolve<boolean>(false);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treturn Promise.resolve<boolean>(aboveC.Content!=belowC.Content);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t});\n\t}\n\n\tRepoOwnerName():[string,string] {\n\t\treturn this.below.RepoOwnerName();\n\t}\n\n\tStat(path:string): Promise<FileStat> {\n\t\treturn this.above.Stat(path)\n\t\t\t.then( \n\t\t\t\t(s:FileStat)=>{\n\t\t\t\t\tif (FileStat.NotExist==s) {\n\t\t\t\t\t\treturn this.below.Stat(path);\n\t\t\t\t\t}\n\t\t\t\t\treturn Promise.resolve<FileStat>(s);\n\t\t\t\t});\n\t}\n\n\tRead(path:string) : Promise<FileContent> {\n\t\treturn this.above.Stat(path)\n\t\t.then(\n\t\t\t(s:FileStat)=>{\n\t\t\t\tswitch (s) {\n\t\t\t\t\tcase FileStat.Exists:\n\t\t\t\t\t\treturn this.readAndCachePath(path);\n\t\t\t\t\tcase FileStat.Changed:\n\t\t\t\t\t\t//fallthrough\n\t\t\t\t\tcase FileStat.New:\n\t\t\t\t\t\t//fallthrough\n\t\t\t\t\tcase FileStat.Deleted:\n\t\t\t\t\t\treturn this.above.Read(path);\t\t\t\t\t\n\t\t\t\t\tcase FileStat.NotExist:\n\t\t\t\t\t\treturn this.below.Read(path)\n\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\t(c)=>{\n\t\t\t\t\t\t\t\tthis.above.Write(path, c.Stat, c.Content);\n\t\t\t\t\t\t\t\treturn Promise.resolve<FileContent>(c);\n\t\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t}\n\tprotected readAndCachePath(path:string) : Promise<FileContent> {\n\t\treturn this.above.Read(path)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tif (fc.Content) {\n\t\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t\t}\n\t\t\t\treturn this.below.Read(path)\n\t\t\t\t.then(\n\t\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\t\treturn this.above.Write(path, fc.Stat, fc.Content);\n\t\t\t\t\t});\n\t\t\t});\t\t\n\t}\n\n\tWrite(path:string, stat:FileStat, content?: string): Promise<FileContent> {\n\t\treturn this.above.Write(path, stat, content)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\t// console.log(`FSOverlay.Write(${path}): stat = ${stat}`);\n\t\t\t\tif (!(fc.Stat==FileStat.Exists || fc.Stat==FileStat.NotExist)) {\n\t\t\t\t\tthis.changes.add(path);\n\t\t\t\t}\n\t\t\t\treturn Promise.resolve<FileContent>(fc)\n\t\t\t});\n\t}\n\n\tRemove(path:string, stat?:FileStat) : Promise<FileContent> {\n\t\treturn this.above.Remove(path,stat)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.changes.add(path);\n\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t}\n\t\t);\n\t}\n\n\tRename(fromPath:string, toPath:string) : Promise<[FileContent,FileContent]> {\n\t\treturn this.above.Rename(fromPath, toPath)\n\t\t.then(\n\t\t\t([fOld,fNew]:[FileContent,FileContent])=>{\n\t\t\t\tconsole.log(`FSOverlay.Rename.then : fOld, fNew = `, fOld, fNew);\n\t\t\t\tthis.changes.add(fromPath);\n\t\t\t\tthis.changes.add(toPath);\n\t\t\t\treturn Promise.resolve<[FileContent,FileContent]>([fOld,fNew]);\n\t\t\t});\n\t}\n\n\tRevert(path:string) : Promise<FileContent> {\n\t\t// @TODO NEED TO CONSIDER THE ISSUES AROUND REVERTING\n\t\t// VIA ORIGINALNAME...\n\t\treturn this.above.Read(path)\n\t\t.then(\n\t\t\t(c:FileContent)=>{\n\t\t\t\treturn this.below.Read(c.OriginalName());\n\t\t\t})\n\t\t.then(\n\t\t\t(c:FileContent)=>{\n\t\t\t\treturn this.above.Write(path, c.Stat, c.Content)\n\t\t\t})\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\t// We're reverted path, so it's not longer\n\t\t\t\t// changed.\n\t\t\t\tthis.changes.delete(path);\n\t\t\t\treturn this.above.Read(path);\n\t\t\t});\n\t}\n\tSync(path?:string) : Promise<FileContent[]> {\t\t\n\t\t// If we're given a path name, then we work with\n\t\t// that path only. If we' are not given a path,\n\t\t// we synchronised all changed files.\n\t\tif (path) {\n\t\t\treturn this.above.Read(path)\n\t\t\t.then(\n\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\tswitch(fc.Stat) {\n\t\t\t\t\t\tcase FileStat.New:\n\t\t\t\t\t\t\t// fallthrough\n\t\t\t\t\t\tcase FileStat.Changed:\n\t\t\t\t\t\t\treturn this.below.Write(fc.Name, fc.Stat, fc.Content);\n\t\t\t\t\t\tcase FileStat.Deleted:\n\t\t\t\t\t\t\t// fallthrough\n\t\t\t\t\t\tcase FileStat.NotExist:\n\t\t\t\t\t\t\treturn this.below.Remove(fc.Name, fc.Stat);\n\t\t\t\t\t}\n\t\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t\t})\n\t\t\t.then(\n\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\treturn this.above.Write(fc.Name, fc.Stat, fc.Content);\n\t\t\t\t})\n\t\t\t.then(\n\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\tthis.changes.delete(path);\n\t\t\t\t\tconsole.log(`Returning from FSOverlay single-file sync: fc = `, fc);\n\t\t\t\t\treturn Promise.resolve<FileContent[]>([fc]);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\t// We do two passes through our changes list, first\n\t\t// doing all Writes then doing all Deletes. Therefore,\n\t\t// if any writes fail, the deletes aren't executed, which\n\t\t// can be valuable when managing renames.\n\t\tlet writePromises = new Array<Promise<FileContent>>();\n\t\tfor (let p of this.changes) {\n\t\t\twritePromises.push( \n\t\t\t\tthis.above.Read(p)\n\t\t\t\t.then(\n\t\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\t\tif (fc.Stat==FileStat.New || fc.Stat==FileStat.Changed) {\n\t\t\t\t\t\t\treturn this.below.Write(p, fc.Stat, fc.Content);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\t\tif (fc) {\n\t\t\t\t\t\t\treturn this.above.Write(p, fc.Stat, fc.Content);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t);\n\t\t}\n\t\t\n\t\treturn Promise.all<FileContent>(writePromises)\n\t\t.then(\n\t\t\t(fcsP:FileContent[])=>{\n\t\t\t\tlet removePromises: Promise<FileContent>[] = [] ;\n\t\t\t\tfor (let fc of fcsP) {\n\t\t\t\t\tif (fc.Stat == FileStat.Deleted || fc.Stat==FileStat.NotExist) {\n\t\t\t\t\t\tremovePromises.push(\n\t\t\t\t\t\t\tthis.below.Remove(fc.Name)\n\t\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\t\t\t\t\treturn this.above.Remove(fc.Name, fc.Stat);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tremovePromises.push(Promise.resolve<FileContent>(fc));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn Promise.all<FileContent>(removePromises);\n\t\t\t})\n\t\t.then(\n\t\t\t(fcs:FileContent[])=>{\n\t\t\t\t// We're synced, so there are not more changes\n\t\t\t\tthis.changes.clear();\n\t\t\t\treturn Promise.resolve<FileContent[]>(fcs);\n\t\t\t});\n\t}\t\n}","import {EBW} from '../EBW';\nimport {FS,FileStat,FileContent} from './FS';\n\n/**\n * FSRemote is a FileSystem stored on a remote\n * server.\n */\nexport class FSRemote {\n\tconstructor(\n\t\tprotected repoOwner:string, \n\t\tprotected repoName:string) \n\t{\n\t}\n\tStat(path:string) : Promise<FileStat> {\n\t\treturn EBW.API()\n\t\t\t.FileExists(this.repoOwner, this.repoName, path)\n\t\t\t.then(\n\t\t\t\t([exists]:[boolean])=>{\n\t\t\t\t\t// Remote system is definitive\n\t\t\t\t\treturn Promise.resolve<FileStat>( exists ? FileStat.Exists : FileStat.NotExist);\n\t\t\t\t}) as Promise<FileStat>;\n\t}\n\tRead(path:string) :Promise<FileContent> {\n\t\treturn EBW.API()\n\t\t.GetFileString(this.repoOwner, this.repoName, path)\n\t\t.then(\n\t\t\t([content]:[string])=>{\n\t\t\t\treturn new FileContent(path, FileStat.Exists, content);\n\t\t\t});\n\t}\n\tWrite(path:string, stat:FileStat, content?: string): Promise<FileContent> {\n\t\tif ('undefined' == typeof content) {\n\t\t\treturn Promise.reject(`FSRemote cannot write file ${path} without content.`);\n\t\t}\n\t\treturn EBW.API()\n\t\t.UpdateFile(this.repoOwner, this.repoName, path, content)\n\t\t.then(\n\t\t\t()=>{\n\t\t\t\treturn new FileContent(path, FileStat.Exists, content);\n\t\t\t}\n\t\t);\n\t}\n\tRename(fromPath:string, toPath: string): Promise<[FileContent,FileContent]> {\n\t\treturn EBW.API().RenameFile(this.repoOwner, this.repoName, fromPath, toPath)\n\t\t.then(\n\t\t\t()=>{\t\t\t\t\n\t\t\t\treturn this.Read(toPath)\n\t\t\t\t.then(\n\t\t\t\t\t(fNew:FileContent)=>{\n\t\t\t\t\t\tlet fOld = new FileContent(fromPath, FileStat.NotExist);\n\t\t\t\t\t\treturn Promise.resolve<[FileContent,FileContent]>([fOld, fNew]);\n\t\t\t\t\t})\n\t\t\t});\n\t}\n\tRemove(path:string, stat?:FileStat) : Promise<FileContent> {\n\t\treturn EBW.API().RemoveFile(this.repoOwner, this.repoName, path)\n\t\t.then(\n\t\t\t()=>{\n\t\t\t\treturn Promise.resolve<FileContent>(new FileContent(path, FileStat.NotExist));\n\t\t\t}\n\t\t);\n\t}\n\tSync(path?:string) :Promise<FileContent[]> {\n\t\treturn Promise.reject(`FSRemote doesn't support Sync()`);\n\t}\n\tRepoOwnerName() : [string,string] {\n\t\treturn [this.repoOwner, this.repoName];\n\t}\n\tRevert(path:string):Promise<FileContent> {\n\t\treturn Promise.reject(`FSRemove doesn't support Revert`);\n\t}\n\tIsDirty(path:string):Promise<boolean> { return Promise.reject(`FSRemote doesn't support IsDirty`); }\n\n}","interface storageInterface {\n\tclear():void;\n\tremoveItem(k:string):void;\n\tgetItem(k:string):string;\n\tsetItem(k:string, v:string):void;\n}\n\nclass store implements storageInterface {\n\tprotected s:Map<string,string>;\n\tconstructor() {\n\t\tthis.s = new Map<string,string>();\n\t}\n\tclear() {\n\t\tthis.s.clear();\n\t}\n\tremoveItem(k:string):void {\n\t\tthis.s.delete(k);\n\t}\n\tgetItem(k:string):string {\n\t\t// console.log(`store::getItem(${k}) = `, this.s.get(k));\n\t\treturn this.s.get(k);\n\t}\n\tsetItem(k:string, v:string) {\n\t\t// console.log(`store::setItem ${k} = ${v}`);\n\t\tthis.s.set(k,v);\n\t}\n}\n\nvar singleton: store;\n\nexport function Store() : storageInterface {\n\tif ('undefined'!=typeof sessionStorage) {\n\t\treturn sessionStorage;\n\t}\n\tif (!singleton) {\n\t\tsingleton = new store();\n\t}\n\treturn singleton;\n}\n\n","import {FileStat, FileContent, FS} from './FS';\nimport {Store} from './Store';\n\nexport class FSSession {\n\tprotected key: string;\n\tconstructor(\n\t\tprotected name: string,\n\t\tprotected repoOwner:string, \n\t\tprotected repoName:string,\n\t\tprotected defaultRemoveStat:FileStat = FileStat.Deleted) \n\t{\n\t\tthis.key = encodeURIComponent(this.name) + `:` +\n\t\t\tencodeURIComponent(this.repoOwner) + `:` +\n\t\t\tencodeURIComponent(this.repoName) + `:`;\n\t}\n\tprotected get(path:string) : FileContent {\n\t\tlet js = Store().getItem(this.key+path);\n\t\tif (!js) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn FileContent.FromJS(js);\t\t\t\t\n\t}\n\tprotected set(c : FileContent) {\n\t\tif (c.Stat==FileStat.NotExist) {\n\t\t\tthis.delete(c.Name);\n\t\t\treturn;\n\t\t}\n\t\tStore().setItem(this.key+c.Name, c.Serialize());\n\t}\n\tprotected delete(path:string) {\n\t\tStore().removeItem(this.key+path);\n\t}\n\n\tStat(path:string) : Promise<FileStat> {\n\t\tlet c = this.get(path);\n\t\treturn Promise.resolve<FileStat>( c ? c.Stat : FileStat.NotExist);\n\t}\n\n\tRead(path:string) : Promise<FileContent> {\n\t\tlet c = this.get(path);\n\t\tif (!c) {\n\t\t\treturn Promise.reject(`${path} does not exist`);\n\t\t}\n\t\treturn Promise.resolve<FileContent>(c);\n\t}\n\n\tWrite(path:string, stat: FileStat, content?: string): Promise<FileContent> {\n\t\tlet f= new FileContent(path, stat, content);\n\t\tthis.set(f);\n\t\treturn Promise.resolve<FileContent>(f);\n\t}\n\n\tRemove(path:string, stat?:FileStat) : Promise<FileContent> {\n\t\tlet c = this.get(path);\n\t\tif (!c) {\n\t\t\tconsole.log(`Tried to remove ${path} which does not appear to exist`);\n\t\t\treturn Promise.resolve<FileContent>(new FileContent(path, FileStat.NotExist));\n\t\t}\n\t\tif (!stat) {\n\t\t\tstat = this.defaultRemoveStat;\n\t\t}\n\t\tlet fc = new FileContent(path, stat, c.Content);\n\t\tthis.set(fc);\n\t\treturn Promise.resolve<FileContent>(fc);\n\t}\n\n\tRename(fromPath:string, toPath:string) : Promise<[FileContent,FileContent]> {\n\t\tif (fromPath==toPath) {\n\t\t\treturn Promise.reject(`Renaming isn't changing name`);\n\t\t}\n\t\tlet f = this.get(fromPath);\n\t\tlet t = this.get(toPath);\n\t\tif (!f) {\n\t\t\treturn Promise.reject(`${fromPath} does not exist`);\n\t\t}\n\t\tif (t) {\n\t\t\treturn Promise.reject(`${toPath} already exists`);\n\t\t}\n\t\tt = new FileContent(toPath, FileStat.Changed, f.Content, f);\n\t\tthis.set(t);\n\n\t\tf = new FileContent(fromPath, this.defaultRemoveStat, f.Content);\n\t\tthis.set(f);\n\n\t\treturn Promise.resolve<[FileContent,FileContent]>([f,t]);\n\t}\n\n\tSync(path?:string):Promise<FileContent[]> {\n\t\treturn Promise.reject(`FSSession doesn't support Sync`);\n\t}\n\n\tRepoOwnerName():[string,string] {\n\t\treturn [this.repoOwner, this.repoName];\n\t}\n\t\n\tRevert(path:string): Promise<FileContent> {\n\t\treturn Promise.reject(`FSSession doesn't support Revert`);\n\t}\n\tIsDirty(path:string):Promise<boolean> { return Promise.reject(`FSSession doesn't support IsDirty`); }\n\n}","import {FSSession} from './FSSession';\nimport {FS,FileStat,FileContent} from './FS';\n\n/**\n * FSReadCache is PURELY a session storage based\n * cache over a resource-intensive remote cache. It\n * caches file existence and file reads, but all\n * writes, renames and removes are handled by the remote\n * content system. It doesn't track any sense of\n * Dirty file state.\n * \n * Because FSReadCache is purely a READ Cache, it cannot\n * do anything like revert, since that requires the underlying\n * FS to handle revert, so Revert is simply passed to the\n * underlying FS.\n */\nexport class FSReadCache {\n\tprotected cache: FSSession;\n\n\tconstructor(protected source: FS)\n\t{\n\t\tlet [owner,name] = this.source.RepoOwnerName();\n\t\tthis.cache = new FSSession(`source-cache`, owner, name);\n\t}\n\n\tRepoOwnerName():[string,string] {\n\t\treturn this.source.RepoOwnerName();\n\t}\n\n\tRead(path:string) : Promise<FileContent> {\n\t\treturn this.cache.Stat(path)\n\t\t.then(\n\t\t\t(s:FileStat)=>{\n\t\t\t\tswitch (s) {\n\t\t\t\t\tcase FileStat.Exists:\n\t\t\t\t\t\treturn this.readAndCachePath(path);\n\t\t\t\t\tcase FileStat.Changed:\n\t\t\t\t\t\t//fallthrough\n\t\t\t\t\tcase FileStat.New:\n\t\t\t\t\t\t//fallthrough\n\t\t\t\t\tcase FileStat.Deleted:\n\t\t\t\t\t\treturn this.cache.Read(path);\t\t\t\t\t\t\n\t\t\t\t\tcase FileStat.NotExist:\n\t\t\t\t\t\treturn this.source.Read(path)\n\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\t(c)=>{\n\t\t\t\t\t\t\t\tthis.cache.Write(path, c.Stat, c.Content);\n\t\t\t\t\t\t\t\treturn Promise.resolve<FileContent>(c);\n\t\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tprotected readAndCachePath(path:string) : Promise<FileContent> {\n\t\treturn this.cache.Read(path)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tif (fc.Content) {\n\t\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t\t}\n\t\t\t\treturn this.source.Read(path)\n\t\t\t\t.then(\n\t\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\t\treturn this.cache.Write(path, fc.Stat, fc.Content);\n\t\t\t\t\t});\n\t\t\t});\t\t\n\t}\n\n\tRemove(path:string,stat?:FileStat) : Promise<FileContent> {\n\t\treturn this.source.Remove(path,stat).then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tconsole.log(`ReadCache.Remove received ${path}: stat = `, fc.Stat);\n\t\t\t\treturn this.cache.Remove(path, fc.Stat)\n\t\t\t\t.then(\n\t\t\t\t\t(rfc:FileContent)=>{\n\t\t\t\t\t\tconsole.log(`ReadCache.Remove returning `, rfc);\n\t\t\t\t\t\treturn Promise.resolve<FileContent>(rfc);\n\t\t\t\t\t})\n\t\t\t}\n\t\t);\n\t}\n\n\tRename(fromPath:string, toPath:string) : Promise<[FileContent,FileContent]> {\n\t\treturn this.source.Rename(fromPath, toPath).then(\n\t\t\t([fOld, fNew]:[FileContent,FileContent])=>{\n\t\t\t\treturn this.cache.Write(toPath, fNew.Stat, fNew.Content)\n\t\t\t\t.then(\n\t\t\t\t\t(_:FileContent)=>{\n\t\t\t\t\t\treturn this.cache.Remove(fromPath, fOld.Stat);\n\t\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t(_:FileContent)=>{\n\t\t\t\t\t\treturn Promise.resolve<[FileContent,FileContent]>([fOld,fNew]);\n\t\t\t\t\t});\n\t\t\t});\n\t}\n\n\tRevert(path:string) : Promise<FileContent> {\n\t\treturn this.source.Revert(path)\n\t\t.then(\n\t\t\t(c:FileContent)=>{\n\t\t\t\treturn this.cache.Write(c.Name, c.Stat, c.Content);\n\t\t\t});\n\t}\n\n\tStat(path:string): Promise<FileStat> {\n\t\treturn this.cache.Stat(path)\n\t\t\t.then( \n\t\t\t\t(s:FileStat)=>{\n\t\t\t\t\tif (FileStat.NotExist==s) {\n\t\t\t\t\t\treturn this.source.Stat(path);\n\t\t\t\t\t}\n\t\t\t\t\treturn Promise.resolve<FileStat>(s);\n\t\t\t\t});\n\t}\n\n\tSync(path?:string) : Promise<FileContent[]> {\n\t\treturn this.source.Sync(path);\n\t}\n\n\tWrite(path:string, stat:FileStat, content?: string): Promise<FileContent> {\n\t\tif ('undefined'==typeof content) {\n\t\t\treturn this.cache.Write(path,stat);\n\t\t}\n\t\treturn this.source.Write(path, stat, content).then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\treturn this.cache.Write(fc.Name, fc.Stat, fc.Content);\n\t\t\t});\n\t}\t\n\tIsDirty(path:string):Promise<boolean> { return Promise.reject(`FSReadCache doesn't support IsDirty`); }\n\n}","import {FS, FileContent, FileStat} from './FS/FS';\nimport {FSFileList_File as Template} from './Templates';\nimport {AddToParent} from './DOM';\nimport {Eventify} from './Eventify';\nimport {FSNotify} from './FS/FSNotify';\n\nimport signals = require('signals');\n\n/**\n * FSFileList_File implements a single file element in the \n * list of files in the FileSystem.\n *\n * It doesn't listen directly to the FS, but rather gets the\n * FSFileList to trigger it's FSEvent method.\n */\nexport class FSFileList_File extends Template {\n\tconstructor(\n\t\tparent:HTMLElement,\n\t\tprotected file: FileContent,\n\t\tprotected FS: FSNotify,\n\t\tevents: any,\n\t\tprotected ignoreFunction: (name:string)=>boolean\n\t) {\n\t\tsuper();\n\t\tif (this.ignoreFunction(this.file.Name)) {\n\t\t\tthis.el.classList.add('ignore');\n\t\t}\n\t\tthis.$.name.textContent = this.file.Name;\n\t\tEventify(this.el, events);\n\t\t// This method will be triggered by FSFileList.\n\t\t// this.FS.Listeners.add(this.FSEvent, this);\n\t\tAddToParent(parent, this.el as HTMLElement);\n\t}\n\tFSEvent(path:string, fc:FileContent): void {\n\t\t// console.log(`In FSFileList_File.FSEvent(${path}) - stat = ${fc.Stat}`)\n\t\tif (path != this.file.Name) {\n\t\t\t// If path's don't match, this doesn't affect us.\n\t\t\treturn;\n\t\t}\n\t\tswitch (fc.Stat) {\n\t\t\tcase FileStat.Changed:\n\t\t\t\tthis.FS.IsDirty(this.file.Name)\n\t\t\t\t.then(\n\t\t\t\t\t(dirty)=>{\n\t\t\t\t\t\tif (dirty) {\n\t\t\t\t\t\t\tthis.el.classList.add('changed');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.el.classList.remove('changed');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\tthis.el.classList.remove(`removed`);\n\t\t\t\tbreak;\n\t\t\tcase FileStat.Deleted:\n\t\t\t\tthis.el.classList.remove('changed');\n\t\t\t\tthis.el.classList.add('removed');\n\t\t\t\tbreak;\n\t\t\tcase FileStat.Exists:\n\t\t\t\tthis.el.classList.remove('changed','removed');\n\t\t\t\tbreak;\n\t\t\tcase FileStat.NotExist:\n\t\t\t\tthis.el.remove();\n\t\t\t\tthis.FS.Listeners.remove(this.FSEvent, this);\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n","import {API} from './API';\n// import {Directory} from './Directory';\nimport {EBW} from './EBW';\nimport {RepoFileEditorCM} from './RepoFileEditorCM';\nimport {FSFileList_File} from './FSFileList_File';\nimport {FSNotify} from './FS/FSNotify';\nimport {FileContent, FileStat} from './FS/FS';\nimport {FSFileEdit} from './FS/FSFileEdit';\n\n/**\n * FSFileList shows a list of the files in the \n * given filesystem.\n */\nexport class FSFileList {\n\tprotected api: API;\n\tprotected files: Map<string, FSFileList_File>;\n\tconstructor(\n\t\tprotected parent:HTMLElement,\n\t\tprotected editor: RepoFileEditorCM,\n\t\tprotected FS:FSNotify,\n\t\tprotected ignoreFunction: (name:string)=>boolean) \n\t{\n\t\tthis.api = EBW.API();\n\t\tthis.FS.Listeners.add(this.FSEvent, this);\n\t\tthis.files = new Map<string,FSFileList_File>();\n\t}\n\tFSEvent(path:string, fc:FileContent) {\n\t\tif (!fc) {\n\t\t\tdebugger;\n\t\t}\n\t\t// console.log(`FSFileList.FSEvent -- fileContent = `, fc);\n\t\tlet f = this.files.get(fc.Name);\n\t\tswitch (fc.Stat) {\n\t\t\tcase FileStat.New:\n\t\t\t\t//\tfallthrough\n\t\t\tcase FileStat.Exists:\n\t\t\t\t// fallthrough\n\t\t\tcase FileStat.Changed:\n\t\t\t\tif (!f) {\n\t\t\t\t\tthis.newFile(fc);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase FileStat.Deleted:\n\t\t\t\t// Nothing to do - filelist_file will handle\n\t\t\t\t// css style change.\n\t\t\t\tbreak;\n\t\t\tcase FileStat.NotExist:\n\t\t\t\tif (f) {\n\t\t\t\t\tthis.files.delete(fc.Name);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t\t// Trigger the FSFileList_File FSEvent callback.\n\t\tif (f) {\n\t\t\tf.FSEvent(path, fc);\n\t\t}\n\t}\n\tnewFile(fc:FileContent) : FSFileList_File {\n\t\tlet f = new FSFileList_File(this.parent, fc, this.FS, {\n\t\t\tclickFile: (evt:any)=>{\n\t\t\t\tthis.FS.Read(fc.Name)\n\t\t\t\t.then(\n\t\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\t\tlet edit = new FSFileEdit(fc, this.FS);\n\t\t\t\t\t\tthis.editor.setFile(edit);\n\t\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tthis.ignoreFunction);\n\t\tthis.files.set(fc.Name, f);\n\t\treturn f;\n\t}\n\n}\n","/**\n * File models a File on the server.\n */\nimport {Directory} from './Directory';\n\nexport class File {\n\tprotected _parent: Directory;\n\tprotected _name: string;\n\tconstructor(parent:Directory, name:string) {\n\t\tthis._parent = parent;\n\t\tthis._name = name;\n\t}\n\tstatic FromJS(parent:Directory, js:any) : File {\n\t\treturn new File(parent, js.N);\n\t}\n\tDebug() {\n\t\tconsole.log(this.Path());\n\t}\n\tPath() : string {\n\t\tlet p = this._parent ? this._parent.Path() : ``;\n\t\treturn p + this._name;\n\t}\n\tIsFile() : boolean {\n\t\treturn true;\n\t}\n\tName() : string {\n\t\treturn this._name;\n\t}\n}\n","import {File} from './File';\n\n/**\n * Directory models a directory on the server. It needs to know\n * its own directory name, and the link to its parent so that it\n * can construct its full name on the parent.\n */\nexport class Directory {\n\tprotected _parent: Directory|undefined;\n\tprotected _name: string;\n\tprotected Files: Array<Directory|File>;\n\t\n\tconstructor(parent:Directory|undefined, name:string) {\n\t\tthis._parent = parent;\n\t\tthis._name = name;\n\t\tthis.Files = [];\n\t}\n\tstatic FromJS(parent:Directory|undefined, js:any) : Directory {\n\t\tlet d = new Directory(parent, js.N as string);\n\t\tfor (let f of js.F) {\n\t\t\tlet e : Directory|File;\n\t\t\tif (f.F) {\n\t\t\t\te = Directory.FromJS(d, f);\n\t\t\t\td.Files.push(e);\n\t\t\t} else {\n\t\t\t\te = File.FromJS(d, f);\n\t\t\t\td.Files.push(e);\n\t\t\t}\n\t\t}\n\t\treturn d;\n\t}\n\tDebug() {\n\t\tconsole.log(this.Path());\n\t\tfor (let f of this.Files) {\n\t\t\tf.Debug();\n\t\t}\n\t}\n\tPath():string {\n\t\tif (this._parent) {\n\t\t\treturn this._parent.Path() + this._name + '/';\n\t\t}\n\t\treturn '';\n\t}\n\tName():string {\n\t\treturn this._name;\n\t}\n\tIsFile():boolean {\n\t\treturn false;\n\t}\n\tFileNamesOnly(filter?:(n:string)=>boolean) : string[] {\n\t\tlet fs: string[] = [];\n\t\tfor (let f of this.Files) {\n\t\t\tif (f.IsFile()) {\n\t\t\t\tlet p = f.Path();\n\t\t\t\tif (!filter || filter(p)) {\n\t\t\t\t\tfs.push(p);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfs = fs.concat((f as Directory).FileNamesOnly(filter));\n\t\t\t}\n\t\t}\n\t\treturn fs.sort();\n\t}\n}","import {Directory} from './Directory';\nimport {FS, FileStat, FileContent} from './FS';\n\n// FSPrimeFromJS adds files to the FileSystem from the \n// Directory and File objects serialized in the given js object.\n// The FileSystem must be able to accomodate empty content\n// Writes.\nexport function FSPrimeFromJS(fs:FS, js:any):void {\n\tlet d = Directory.FromJS(undefined, js);\n\tlet filter = function(n:string):boolean {\n\t\tif (\".\"==n.substr(0,1)) {\n\t\t\treturn false;\n\t\t}\n\t\tif (\"_output\" == n.substr(0,7)) {\n\t\t\treturn false;\n\t\t}\n\t\tif (\"_html\"==n.substr(0,5)) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\tfor (let f of d.FileNamesOnly(filter)) {\n\t\tfs.Write(f, FileStat.Exists);\n\t}\n}\n","import {ControlTag} from './ControlTag';\nimport {EBW} from './EBW';\nimport {PrintListener} from './PrintListener';\nimport {RepoFileEditorCM} from './RepoFileEditorCM';\nimport {RepoEditorPage_NewFileDialog} from './RepoEditorPage_NewFileDialog';\nimport {RepoEditorPage_RenameFileDialog} from './RepoEditorPage_RenameFileDialog';\n\nimport {FileContent,FileStat,FS} from './FS/FS';\nimport {FSNotify} from './FS/FSNotify';\nimport {FSOverlay} from './FS/FSOverlay';\nimport {FSRemote} from './FS/FSRemote';\nimport {FSReadCache} from './FS/FSReadCache';\nimport {FSSession} from './FS/FSSession';\n\nimport {FSFileList} from './FSFileList';\nimport {FSPrimeFromJS} from './FS/FSPrimeFromJS';\n\n/**\n * RepoEditorPage is the JS controller for the page that allows\n * editing of a repo.\n *\n */\nexport class RepoEditorPage {\n\tprotected editor: RepoFileEditorCM;\n\tprotected FS: FSNotify;\n\n\tconstructor(\n\t\tprotected repoOwner:string, \n\t\tprotected repoName:string,\n\t\tfilesList: HTMLElement,\n\t\tfilesJson: any,\n\t\tprotected proseIgnoreFunction: (name:string)=>boolean\n\t) {\n\t\tsessionStorage.clear();\n\t\tthis.repoOwner = repoOwner;\n\t\tthis.repoName = repoName;\n\t\tthis.editor = undefined;\n\t\tthis.editor = new RepoFileEditorCM(\n\t\t\trepoOwner, repoName,\n\t\t\tdocument.getElementById('editor'), {\n\t\t\tRename: ():void=>{\n\t\t\t\treturn;\n\t\t\t}\n\t\t});\n\n\t\tlet remoteFS = new FSReadCache(new FSRemote(this.repoOwner, this.repoName));\n\t\tlet localFS = new FSSession(`temp-rootf`, this.repoOwner, this.repoName);\n\t\tlet overlayFS = new FSOverlay(remoteFS, localFS);\n\t\tthis.FS = new FSNotify(overlayFS);\n\t\t\n\t\tnew FSFileList(filesList, this.editor, this.FS, this.proseIgnoreFunction);\n\n\t\tnew RepoEditorPage_NewFileDialog(\n\t\t\tdocument.getElementById('repo-new-file'),\n\t\t\tthis.FS,\n\t\t\tthis.editor);\n\t\tnew RepoEditorPage_RenameFileDialog(\n\t\t\tdocument.getElementById(`editor-rename-button`),\n\t\t\tthis.FS,\n\t\t\tthis.editor);\n\n\t\tnew ControlTag(document.getElementById(`files-show-tag`),\n\t\t\t(showing:boolean)=>{\n\t\t\t\tdocument.getElementById(`new-editor-files-nav`)\n\t\t\t\t.style.width = showing ? \"20%\":\"0px\";\n\t\t\t\tdocument.getElementById(`repo-file-actions`)\n\t\t\t\t.style.visibility = showing ? `visible` : `hidden`;\n\n\t\t\t\tlet f = document.getElementById(`page-footer`);\n\t\t\t\tf.style.display = showing ? 'flex' : 'none';\n\t\t\t\t// console.log(`set footer = `, f);\n\t\t\t});\n\n\t\t\n\t\tFSPrimeFromJS(this.FS, filesJson);\n\n\t\tdocument.getElementById(`repo-print-printer`).addEventListener('click', evt=>{\n\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\tEBW.Toast(`Creating your PDF. We'll open it in a new tab when it's ready.`);\n\t\t\tnew PrintListener(this.repoOwner, this.repoName, `book`, `print`);\n\t\t});\n\t\tdocument.getElementById(`repo-print-screen`).addEventListener(`click`, evt=>{\n\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\tEBW.Toast(`Creating your PDF. We'll open it in a new tab when it's ready.`);\n\t\t\tnew PrintListener(this.repoOwner, this.repoName, `book`, `screen`);\n\t\t});\n\t\tdocument.getElementById(`repo-jekyll`).addEventListener(`click`, evt=>{\n\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\tlet l = document.location;\n\t\t\tlet jekyllUrl = `${l.protocol}//${l.host}/jekyll-restart/${this.repoOwner}/${this.repoName}/`;\n\t\t\tconsole.log(`URL = ${jekyllUrl}`);\n\t\t\twindow.open(jekyllUrl, `${this.repoOwner}-${this.repoName}-jekyll`);\n\t\t});\n\t\t/**\n\t\t * @TODO\n\t\t * Need to catch any attempt to leave RepoEditorPage and\n\t\t * check that the user has saved any changes.\n\t\t */\n\t}\n\tstatic instantiate() {\n\t\tlet el = document.getElementById(`repo-editor-page`);\n\t\tif (el) {\n\t\t\tlet repoOwner = el.getAttribute('repo-owner');\n\t\t\tlet repoName = el.getAttribute('repo-name');\n\t\t\t// let volume = new VolumeElement()\n\t\t\t// let allFilesList = document.querySelector(`[data-instance='AllFilesList']`);\n\n\t\t\tlet filesList = document.querySelector(`[data-instance='AllFilesList']`);\n\t\t\tlet primeFSel = document.getElementById(`volume-element`);\n\t\t\tlet primeFSjs = JSON.parse(primeFSel.innerText);\n\t\t\tnew RepoEditorPage(repoOwner, repoName, \n\t\t\t\tfilesList as HTMLElement,\n\t\t\t\tprimeFSjs, \n\t\t\t\tfunction(name:string) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n}\n\nwindow.RepoEditorPage = RepoEditorPage;\n","export class FileStatus {\n\tconstructor(protected status:string) {\n\t}\n\tStatus() : string {\n\t\tif (this.status) {\n\t\t\treturn this.status;\n\t\t}\n\t\treturn 'undefined';\n\t}\n\tSetStatus(s:string) {\n\t\tthis.status = s;\n\t}\n}","import signals = require('signals');\nimport {Context} from '../Context';\nimport {EBW} from '../EBW';\nimport {FileStatus} from './FileStatus';\n\nexport class FileContent {\n\tpublic Exists: boolean;\n\tpublic Raw: string;\n\tconstructor(exists:boolean, raw:string) {\n\t\tthis.Exists = exists;\n\t\tthis.Raw = raw ? raw : ``;\n\t}\n}\n\nexport enum FileEvent {\n\tWorkingChanged,\n\tTheirChanged,\n\tStatusChanged\n}\n\nexport class MergeFileResolutionState {\n\tState: number;\n\tDescription: string;\n}\n\n// File models a single conflicted file in the repo.\n// All communication with the conflicted file occurs through this single\n// class, which will coordinate any other internal-classes that it might need,\n// like the file status.\nexport class File {\n\tprotected status : FileStatus;\n\tpublic Listen : signals.Signal;\n\t// Signalled when RPC is in progress\n\tpublic ListenRPC: signals.Signal;\n\n\tprotected cache : Map<string,FileContent>;\n\tconstructor(protected context:Context,protected path: string, status:string) {\n\t\tthis.status = new FileStatus(status);\n\t\tthis.Listen = new signals.Signal();\n\t\tthis.ListenRPC = new signals.Signal();\n\t\tthis.cache = new Map<string,FileContent>();\n\t}\n\tStatus(): string {\n\t\tif (this.status) {\n\t\t\treturn this.status.Status();\n\t\t}\n\t\treturn 'undefined';\n\t}\n\tSetStatus(source:any, status:string) {\n\t\tthis.status.SetStatus(status);\n\t\tthis.Listen.dispatch(source, FileEvent.StatusChanged, status);\n\t}\n\tPath() : string {\n\t\treturn this.path;\n\t}\n\n\t/* THE FOLLOWING METHODS HANDLE CONTENT FOR THE FILE */\n\tClearCache() : void {\n\t\tthis.cache.clear();\n\t}\n\tFetchContent(source:any) : Promise<void> {\n\t\tif (this.cache.has(`working`)) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tthis.ListenRPC.dispatch(source, true, `FetchContent`);\n\t\treturn this.context.API()\n\t\t.MergedFileCat(this.context.RepoOwner, this.context.RepoName, this.path)\n\t\t.then(\n\t\t\t([workingExists, working, theirExists, their, gitMerge]:[boolean,string,boolean,string,string])=>{\n\t\t\t\tlet workingFile = new FileContent(workingExists, working);\n\t\t\t\tlet theirFile = new FileContent(theirExists, their);\n\t\t\t\tlet gitFile = new FileContent(true, gitMerge);\n\t\t\t\tthis.cache.set(`working`, workingFile);\n\t\t\t\tthis.cache.set(`their`, theirFile);\n\t\t\t\tthis.cache.set(`git`, gitFile)\n\n\t\t\t\tthis.ListenRPC.dispatch(source, false, `FetchContent`);\n\t\t\t\tthis.Listen.dispatch(source, FileEvent.WorkingChanged, workingFile);\n\t\t\t\tthis.Listen.dispatch(source, FileEvent.TheirChanged, theirFile);\n\t\t\t\treturn Promise.resolve();\n\t\t\t});\n\t}\n\tSetWorkingExists(b:boolean):void{\n\t\tthis.WorkingFile().Exists = true;\n\t}\n\tSetTheirExists(b:boolean):void {\n\t\tthis.TheirFile().Exists = true;\n\t}\n\t// FetchGit fetches the git merged content for the file\n\tFetchGit(source:any):Promise<void>{\n\t\tif (this.cache.has(`git`)) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tthis.ListenRPC.dispatch(source, true, `FetchGit`);\n\t\treturn this.context.API()\n\t\t.MergedFileGit(this.context.RepoOwner, this.context.RepoName, this.path)\n\t\t.then(\n\t\t\t([automerged, text]:[boolean,string])=> {\n\t\t\t\tlet gitFile = new FileContent(true, text);\n\t\t\t\tthis.cache.set(`git`, gitFile);\n\t\t\t\tthis.ListenRPC.dispatch(source, false, `FetchGit`);\n\t\t\t\t// TODO: Should it be WorkingChanged that we're sending?\n\t\t\t\tthis.Listen.dispatch(source, FileEvent.WorkingChanged, gitFile);\n\t\t\t\treturn Promise.resolve();\n\t\t});\n\t}\n\tRevertOur(source:any) : Promise<FileContent> {\n\t\tthis.ListenRPC.dispatch(source, true, `RevertOur`);\n\t\treturn this.mergeFileOriginal(\"our\")\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.cache.set(`working`, fc);\n\t\t\t\tthis.ListenRPC.dispatch(source, false, `RevertOur`);\n\t\t\t\tthis.Listen.dispatch(source, FileEvent.WorkingChanged, fc);\n\t\t\t\treturn Promise.resolve(fc);\n\t\t\t});\n\t}\n\tRevertOurToTheir(source:any) : Promise<FileContent> {\n\t\tthis.ListenRPC.dispatch(source, true, `RevertOurToTheir`);\n\t\treturn this.mergeFileOriginal(\"their\")\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.cache.set(`working`, fc);\n\t\t\t\tthis.ListenRPC.dispatch(source, false, `RevertOur`);\n\t\t\t\tthis.Listen.dispatch(source, FileEvent.WorkingChanged, fc);\n\t\t\t\treturn Promise.resolve(fc);\n\t\t\t})\n\t}\n\tRevertOurToGit(source: any) : Promise<FileContent>{ \n\t\tthis.ListenRPC.dispatch(source, true, `RevertOurToGit`);\n\t\treturn this.mergeFileOriginal(\"git\")\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.cache.set(`working`, fc)\n\t\t\t\tthis.ListenRPC.dispatch(source, false, `RevertOurToGit`);\n\t\t\t\tthis.Listen.dispatch(source, FileEvent.WorkingChanged, fc);\n\t\t\t\treturn Promise.resolve(fc);\n\t\t\t})\n\t}\n\tRevertTheir(source:any) : Promise<FileContent> {\n\t\tthis.ListenRPC.dispatch(source, true,`RevertTheir`);\n\t\treturn this.mergeFileOriginal(\"their\")\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.cache.set(`their`, fc);\n\t\t\t\tthis.ListenRPC.dispatch(source, false, `RevertTheir`);\n\t\t\t\tthis.Listen.dispatch(source, FileEvent.TheirChanged, fc);\n\t\t\t\treturn Promise.resolve(fc);\n\t\t\t});\n\t}\n\tmergeFileOriginal(v:string) : Promise<FileContent> {\n\t\treturn this.context.API()\n\t\t.MergeFileOriginal(this.context.RepoOwner, this.context.RepoName, this.path, v)\n\t\t.then(\n\t\t\t([exists,raw]:[boolean,string])=>{\n\t\t\t\treturn Promise.resolve<FileContent>(new FileContent(exists, raw));\n\t\t\t});\n\t}\n\tprotected getCachedContent(key:string) : FileContent {\n\t\treturn this.cache.get(key);\n\t}\n\tprotected setCachedContent(key:string, value:FileContent) : void {\n\t\tthis.cache.set(key,value);\n\t}\n\tTheirFile() : FileContent {\n\t\treturn this.cache.get(`their`);\n\t}\n\tWorkingFile() : FileContent {\n\t\treturn this.cache.get(`working`);\n\t}\n\tRemoveWorkingFile(source:any) : void {\n\t\tlet fc = new FileContent(false, ``);\n\t\tthis.cache.set(`working`, fc);\n\t\tthis.Listen.dispatch(source, FileEvent.WorkingChanged, fc);\n\t\t// Don't need to delete on server as this will happen on file save\n\t}\n\tRemoveTheirFile(source:any) : void {\n\t\tlet fc = new FileContent(false, ``);\n\t\tthis.cache.set(`their`, new FileContent(false, ``));\n\t\tthis.Listen.dispatch(source, FileEvent.TheirChanged, fc);\n\t\t// Don't need to delete on server as this will happen on file save\n\t}\n\tSetWorkingContent(source:any,content:string) : void {\n\t\tlet fc = new FileContent(content!=undefined, content);\n\t\tthis.cache.set(`working`, fc);\n\t\tthis.Listen.dispatch(source, FileEvent.WorkingChanged, fc);\n\t}\n\tSetTheirContent(source:any, content:string) : void {\n\t\tlet fc = new FileContent(content!=undefined, content);\n\t\tthis.cache.set(`their`, fc);\n\t\tthis.Listen.dispatch(source, FileEvent.TheirChanged, fc);\n\t} \n\tSave() : Promise<void> {\n\t\tlet working = this.cache.get(`working`);\n\t\tlet their = this.cache.get(`their`);\n\t\tthis.ListenRPC.dispatch(this, true, `Save`);\n\t\treturn this.context.API()\n\t\t.SaveMergingFile(\n\t\t\tthis.context.RepoOwner, this.context.RepoName,\n\t\t\tthis.Path(),\n\t\t\tworking.Exists, working.Raw,\n\t\t\ttheir.Exists, their.Raw\n\t\t\t)\n\t\t.then(\n\t\t\t([status]:[string])=>{\n\t\t\t\tthis.ListenRPC.dispatch(this, false, `Save`);\n\t\t\t\tthis.SetStatus(undefined, status);\n\t\t\t\treturn Promise.resolve();\n\t\t\t});\n\t}\n\tStage(source:any):Promise<void> {\n\t\tthis.ListenRPC.dispatch(this,true,`Stage`);\n\t\treturn this.context.API()\n\t\t.StageFileAndReturnMergingState(\n\t\t\tthis.context.RepoOwner, \n\t\t\tthis.context.RepoName,\n\t\t\tthis.Path()\n\t\t).then(\n\t\t\t([status]:[string])=>{\n\t\t\t\tthis.ListenRPC.dispatch(this,false, `Stage`);\n\t\t\t\tthis.SetStatus(source, status);\n\t\t\t\treturn Promise.resolve();\n\t\t\t});\n\t}\n}","import {Context} from '../Context';\nimport {File} from './File';\nimport signals = require('signals');\n\nexport enum FileListEvent {\n\tFileNew,\n\tFileChanged\n};\n\nexport class FileList {\n\tprotected files: Array<File>;\n\tpublic Listen: signals.Signal;\n\n\tconstructor(protected context:Context) {\n\t\tthis.files = new Array<File>();\n\t\tthis.Listen = new signals.Signal();\n\t}\n\n\tload(js:any) : void {\n\t\t// I expect js to be an array of {Path:string, Status:string}\n\t\tfor (let j of js) {\n\t\t\tlet f = new File(this.context, j.Path as string, j.Status as string);\n\t\t\tthis.files.push(f);\n\t\t\tthis.Listen.dispatch(FileListEvent.FileNew, f);\n\t\t}\n\t}\n}","import {Context} from '../Context';\nimport {File, FileEvent} from './File';\nimport {conflict_FileDisplay as Template} from '../Templates';\nimport {MergingInfo} from './MergingInfo';\nimport signals = require('signals');\n\nexport enum FileDisplayEvent {\n\tFileClick\n}\n\nexport class FileDisplay extends Template {\n\tpublic Listen: signals.Signal;\n\n\tconstructor(protected context:Context, parent:HTMLElement, protected file:File, protected mergingInfo:MergingInfo) {\n\t\tsuper();\n\t\tthis.Listen = new signals.Signal();\n\n\t\tthis.$.path.innerText = file.Path();\n\t\tthis.fileEvent(undefined, FileEvent.StatusChanged, undefined);\n\n\t\tthis.el.addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\tthis.dispatchEvent(`file-click`);\n\t\t\tthis.Listen.dispatch(FileDisplayEvent.FileClick, this.file);\n\t\t});\n\n\t\tthis.file.Listen.add(this.fileEvent, this);\n\t\tthis.file.ListenRPC.add(this.rpcEvent, this);\n\t\tparent.appendChild(this.el);\n\t}\n\tdispatchEvent(name:string) {\n\t\tlet d = { bubbles: true, detail: { file: this.file } };\n\t\tthis.el.dispatchEvent(new CustomEvent(name, d));\n\t}\n\tfileEvent(source:any, event: FileEvent, data:any) {\n\t\tswitch (event) {\n\t\t\tcase FileEvent.StatusChanged:\n\t\t\t\tthis.$.status.innerText = this.file.Status();\n\t\t\t\tthis.el.classList.remove(`status-new`,`status-modified`,`status-resolved`,`status-deleted`,`status-conflict`,`status-error`);\n\t\t\t\tthis.el.classList.add(`status-${this.file.Status()}`);\t\t\t\t\n\t\t\t\tbreak;\n\t\t}\n\t}\n\trpcEvent(source:any, inProgress:boolean, method:string) {\n\t\tconsole.log(`RPC Event for ${this.file.Path()} inProgress = ${inProgress}, method = ${method}`);\n\t\tlet cl = this.el.classList;\n\t\tif (inProgress) {\n\t\t\tcl.add(`rpc`);\n\t\t} else {\n\t\t\tcl.remove(`rpc`);\n\t\t}\n\t}\n}","import {Context} from '../Context';\nimport {conflict_FileListDisplay as Template} from '../Templates';\nimport {FileListEvent, FileList} from './FileList';\nimport {File} from './File';\nimport {FileDisplayEvent, FileDisplay} from './FileDisplay';\nimport {MergingInfo} from './MergingInfo';\nimport signals = require('signals');\n\nexport enum FileListDisplayEvent {\n\tFileClick\n}\n\nexport class FileListDisplay extends Template {\n\tpublic Listen: signals.Signal;\n\n\tconstructor(protected context:Context, protected parent:HTMLElement, \n\t\tfileList: FileList, protected mergingInfo:MergingInfo) \n\t{\n\t\tsuper();\n\t\tthis.Listen = new signals.Signal();\n\n\t\tfileList.Listen.add(this.fileListEvent, this);\n\t\tthis.parent.appendChild(this.el);\n\t}\n\tfileListEvent(e:FileListEvent, f:File) : void{\n\t\tswitch (e) {\n\t\t\tcase FileListEvent.FileNew:\n\t\t\t\tlet fd = new FileDisplay(this.context, this.el, f, this.mergingInfo);\n\t\t\t\tfd.Listen.add( this.fileDisplayEvent, this );\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tfileDisplayEvent(evt: FileDisplayEvent, f: File) : void {\n\t\tswitch (evt) {\n\t\t\tcase FileDisplayEvent.FileClick:\n\t\t\t\tthis.Listen.dispatch(FileListDisplayEvent, f);\n\t\t\t\tbreak;\n\t\t}\n\t}\n}","import {FileEvent,File} from './File';\nimport signals = require('signals');\n\nexport enum MergeEditorAction {\n\tSave,\n\tResolve,\n\tDelete,\n\tRevertOur,\n\tRevertTheir,\n\tRevertGit,\n\tCopyWorking,\n\tCopyTheir\n}\n// MergeEditorControlBar handles the wiring between the editor controls\n// and any listeners interested in these controls\nexport class MergeEditorControlBar {\n\tpublic Listen : signals.Signal;\n\n\tprotected DeleteButton: HTMLElement;\n\tprotected SaveButton : HTMLElement;\n\tprotected RevertOurButton: HTMLElement;\n\tprotected RevertGitButton: HTMLElement;\n\tprotected RevertTheirButton: HTMLElement;\n\tprotected CopyWorkingButton : HTMLElement;\n\tprotected CopyTheirButton: HTMLElement;\n\n\tprotected RevertSingleOurButton: HTMLElement;\n\tprotected RevertSingleTheirButton: HTMLElement;\n\tprotected RevertSingleGitButton: HTMLElement;\n\n\tprotected buttons: HTMLElement[];\n\n\tprotected imageEditing : boolean;\n\n\tprotected file: File;\n\n\tget(key:string) : HTMLElement {\n\t\treturn document.getElementById(`merge-editor-control-${key}`) as HTMLElement;\n\t}\n\tdisable(el:HTMLElement) {\n\t\tthis.enable(el, false);\n\t}\n\tenable(el:HTMLElement, e:boolean=true) {\n\t\tif (e) {\n\t\t\tel.removeAttribute(`disabled`);\n\t\t} else {\n\t\t\tel.setAttribute(`disabled`,`disabled`);\n\t\t}\n\t}\n\n\tsetImageEditing(b: boolean) {\n\t\tlet sel = document.querySelectorAll(`.hide-for-image`) as NodeList;\n\t\tfor (let i=0; i<sel.length; i++) {\n\t\t\tlet el = sel.item(i) as HTMLElement\n\t\t\tif (b) {\n\t\t\t\tel.setAttribute('hold-display', el.style.display);\n\t\t\t\tel.style.display = 'none';\n\t\t\t} else {\n\t\t\t\tel.style.display = el.getAttribute('hold-display');\n\t\t\t}\n\t\t}\n\t\tthis.imageEditing = b;\n\t}\n\n\tconstructor() {\n\t\tthis.Listen = new signals.Signal();\n\n\t\tthis.DeleteButton = this.get(`delete`);\n\t\tthis.SaveButton = this.get(`save`);\n\n\t\tthis.RevertOurButton = this.get(`revert-our`);\n\t\tthis.RevertTheirButton = this.get(`revert-their`);\n\t\tthis.CopyWorkingButton = this.get(`copy-working`);\n\t\tthis.CopyTheirButton = this.get(`copy-their`);\n\n\t\tthis.RevertSingleOurButton =this.get(`single-revert-our`);\n\t\tthis.RevertSingleTheirButton = this.get(`single-revert-their`);\n\t\tthis.RevertSingleGitButton = this.get(`single-revert-git`);\n\n\t\tthis.buttons = new Array<HTMLElement>();\n\n\t\tlet ln = (key:string, act:MergeEditorAction) => {\n\t\t\tlet el = this.get(key);\n\t\t\tif (el) {\n\t\t\t\tel.addEventListener(`click`, (evt)=>{\n\t\t\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\t\t\tthis.Listen.dispatch(act);\n\t\t\t\t});\n\t\t\t\tthis.buttons.push(el);\n\t\t\t} else {\n\t\t\t\tconsole.error(`Failed to find #${key}`);\n\t\t\t}\n\t\t}\n\t\tln(`revert-our`, MergeEditorAction.RevertOur);\n\t\tln(`revert-their`, MergeEditorAction.RevertTheir);\n\t\t// ln(`revert-git`, MergeEditorAction.RevertGit);\n\t\tln(`copy-working`, MergeEditorAction.CopyWorking);\n\t\tln(`copy-their`, MergeEditorAction.CopyTheir);\n\t\tln(`save`, MergeEditorAction.Save);\n\t\tln(`delete`, MergeEditorAction.Delete);\n\t\tln(`resolve`, MergeEditorAction.Resolve);\n\n\t\tln(`single-revert-our`, MergeEditorAction.RevertOur);\n\t\tln(`single-revert-their`, MergeEditorAction.RevertTheir);\n\t\tln(`single-revert-git`, MergeEditorAction.RevertGit);\n\n\t\tthis.imageEditing = false;\n\t}\n\tSetFile(f:File) {\n\t\tif (this.file) {\n\t\t\tthis.file.Listen.remove(this.fileEvent,this);\n\t\t}\n\t\tthis.file = f;\n\t\tthis.file.Listen.add(this.fileEvent, this);\n\t}\n\tfileEvent(source:any, e:FileEvent) {\n\t\tfor (let el of this.buttons) {\n\t\t\tthis.enable(el, undefined!=this.file);\n\t\t}\n\t\tif (!this.file) {\n\t\t\treturn;\n\t\t}\n\t\tlet f = this.file;\n\t\tif (!this.imageEditing) {\n\t\t\tif (f.WorkingFile().Exists || f.TheirFile().Exists) {\n\t\t\t\t// One or the other exists\n\t\t\t\tthis.DeleteButton.removeAttribute(`disabled`);\n\t\t\t} else {\n\t\t\t\tthis.DeleteButton.setAttribute(`disabled`,`disabled`);\n\t\t\t}\n\t\t}\n\t}\n\n}","import {API} from '../API';\nimport {Context} from '../Context';\nimport {conflict_MergeImageEditor as Template} from '../Templates';\nimport {EBW} from '../EBW';\n\nconst VERSION_OUR = \"our-head\";\nconst VERSION_THEIR = \"their-head\";\n\nclass MergeImageEditorView {\n\tprotected img : HTMLImageElement;\n\tprotected selected: boolean;\n\tconstructor(protected context: Context, parent:HTMLElement, protected path: string, protected version: string, protected selected: boolean) {\n\t\tthis.img = document.createElement('img') as HTMLImageElement;\n\n\t\tthis.img.classList.add(`merge-image`);\n\t\tthis.img.classList.add(version);\n\t\tif (this.selected) {\n\t\t\tthis.img.classList.add('selected');\n\t\t}\n\t\tthis.img.src=`/www-version/${version}/${this.context.RepoOwner}/${this.context.RepoName}/${path}`;\n\n\t\tthis.img.addEventListener('click', (evt)=>{\n\t\t\tevt.preventDefault();\n\t\t\tevt.stopPropagation();\n\t\t\tif (this.selected) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.img.dispatchEvent(new CustomEvent(`ImageSelected`, { bubbles:true,cancelable:true,detail:{\n\t\t\t\tPath: this.path,\n\t\t\t\tVersion: this.version\n\t\t\t}\n\t\t\t}));\n\t\t})\n\t\tparent.appendChild(this.img);\n\t}\n\tselect(s : boolean) {\n\t\tif (s==this.selected) {\n\t\t\treturn;\n\t\t}\n\t\tif (s) {\n\t\t\tthis.img.classList.add('selected');\n\t\t} else {\n\t\t\tthis.img.classList.remove('selected');\n\t\t}\n\t\tthis.selected = s;\n\t}\n}\n\n/**\n * MergeImageEditor displays two images - ours and theirs - to the user, allowing them to select\n * the one they wish to keep as the merge result.\n */\nexport class MergeImageEditor extends Template {\n\tprotected ours : MergeImageEditorView;\n\tprotected theirs: MergeImageEditorView;\n\tprotected apiInFlight : boolean;\n\n\tconstructor(protected context: Context, parent: HTMLElement, path: string) {\n\t\tsuper();\n\t\tEBW.API().IsOurHeadInWd(context.RepoOwner, context.RepoName, path)\n\t\t.then(\n\t\t\t(args)=>{\n\t\t\t\tlet oursInWd:boolean = args[0] as boolean;\n\t\t\t\tthis.ours = new MergeImageEditorView(context, this.$.ours, path, VERSION_OUR, oursInWd);\n\t\t\t\tthis.theirs = new MergeImageEditorView(context, this.$.theirs, path, VERSION_THEIR, !oursInWd);\n\t\t\t\tthis.apiInFlight = false;\n\t\t\t\tthis.el.addEventListener(`ImageSelected`, (evt:CustomEvent)=>{\n\t\t\t\t\tif (this.apiInFlight) return;\t// can't have two api calls in flight at the same time\n\n\t\t\t\t\tlet api = EBW.API();\n\t\t\t\t\tlet p : Promise<void>;\n\t\t\t\t\tlet ourVersion = evt.detail.Version == VERSION_OUR;\n\t\t\t\t\tthis.apiInFlight = true;\n\t\t\t\t\tif (ourVersion) {\n\t\t\t\t\t\tp = api.SaveOurHeadToWd(context.RepoOwner, context.RepoName, path);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tp = api.SaveTheirHeadToWd(context.RepoOwner, context.RepoName, path);\n\t\t\t\t\t}\n\t\t\t\t\tp.then(\n\t\t\t\t\t\t()=>{\n\t\t\t\t\t\t\tlet ours = evt.detail.V\n\t\t\t\t\t\t\tthis.ours.select(ourVersion);\n\t\t\t\t\t\t\tthis.theirs.select(!ourVersion);\n\t\t\t\t\t\t\tthis.apiInFlight = false;\n\t\t\t\t\t\t})\n\t\t\t\t\t.catch(\n\t\t\t\t\t\t(err)=>{\n\t\t\t\t\t\t\tEBW.Error(err);\n\t\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\t\tthis.apiInFlight = false;\n\t\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t})\n\t\t.catch(\n\t\t\t(err)=>{\n\t\t\t\tEBW.Error(err);\n\t\t\t\tconsole.error(err);\n\t\t\t});\n\n\t\tparent.appendChild(this.el);\n\t}\n\t\n}","import {AddToParent} from '../DOM';\nimport {ConflictEditor} from './ConflictEditor';\nimport {Context} from '../Context';\nimport {EBW} from '../EBW';\nimport {FileContent, FileEvent, File} from './File';\nimport {ImageIdentify} from '../ImageIdentify';\nimport {MergeEditorAction, MergeEditorControlBar} from './MergeEditorControlBar';\nimport {MergeImageEditor} from './MergeImageEditor';\nimport jQuery = require('jquery');\n\nimport signals = require('signals');\nimport CodeMirror = require('codemirror');\n\n// MergeEditor controls a Mergely class\nexport class MergeEditor implements ConflictEditor {\n\tprotected mergelyDiv: HTMLDivElement;\n\tpublic Listen : signals.Signal;\n\tprotected file:File;\n\tprotected editLeft = true;\n\tprotected editBoth = true;\n\tprotected controls : MergeEditorControlBar;\n\tprotected mergeImageEditor : MergeImageEditor;\n\n\tconstructor(\n\t\tprotected context:Context,\n\t\tprotected parent:HTMLElement\n\t\t) \n\t{\n\t\tthis.Listen = new signals.Signal();\n\t\tthis.controls = new MergeEditorControlBar();\n\t\tthis.controls.Listen.add(this.controlAction, this);\n\t}\n\t// WorkingSide returns a string describing the side on which the\n\t// final version will be displayed.\n\tWorkingSide() : string {\n\t\treturn this.editLeft ? \"left\" : \"right\";\n\t}\n\t// TheirSide returns a string describing the side on which\n\t// the submitted changes will be displayed.\n\tTheirSide() : string {\n\t\treturn this.editLeft ? \"right\" : \"left\";\n\t}\n\n\tcontrolAction(act:MergeEditorAction) {\n\t\tswitch(act) {\n\t\t\tcase MergeEditorAction.Save:\n\t\t\t\tthis.SaveFile()\n\t\t\t\t.catch( EBW.Error );\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.Delete:\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.Resolve:\n\t\t\t\tthis.SaveFile()\n\t\t\t\t.then(\n\t\t\t\t\t()=>{\n\t\t\t\t\t\t// undefined so we receive notifications\n\t\t\t\t\t\treturn this.file.Stage(undefined);\n\t\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t()=>{\n\t\t\t\t\t\tEBW.Toast(`Resolved changes on ${this.file.Path()}`);\n\t\t\t\t\t})\n\t\t\t\t.catch(EBW.Error);\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.RevertOur:\n\t\t\t\tthis.RevertOur();\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.RevertTheir:\n\t\t\t\tthis.RevertTheir();\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.CopyWorking:\n\t\t\t\tthis.CopyWorking();\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.CopyTheir:\n\t\t\t\tthis.CopyTheir();\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.RevertGit:\n\t\t}\n\t}\n\tsetWorkingText(t:string) :void {\n\t\tif (this.editLeft) {\n\t\t\tthis.setLHS(t);\n\t\t} else {\n\t\t\tthis.setRHS(t);\n\t\t}\n\t}\n\tsetTheirText(t:string):void {\n\t\tif (this.editLeft) {\n\t\t\tthis.setRHS(t);\n\t\t} else {\n\t\t\tthis.setLHS(t);\n\t\t}\n\t}\n\tgetWorkingText() : string {\n\t\tif (this.editLeft) {\n\t\t\treturn this.getLHS();\n\t\t}\n\t\treturn this.getRHS();\n\t}\n\tgetTheirText() : string {\n\t\tif (this.editLeft) {\n\t\t\treturn this.getRHS();\n\t\t}\n\t\treturn this.getLHS();\n\t}\n\tgetWorkingContent() : FileContent {\n\t\treturn new FileContent(this.isWorkingDeleted(), this.getWorkingText());\n\t}\n\tgetTheirContent() : FileContent {\t\t\n\t\treturn new FileContent(this.isTheirDeleted(), this.getTheirText());\n\t}\n\tCopyTheir() : void {\n\t\t// We leave source undefined, so that our editor will update\n\t\t// when the change arrives\t\t\n\t\tthis.file.SetWorkingContent(undefined, this.isTheirDeleted() ? undefined : this.getTheirText());\n\t}\n\tCopyWorking() : void {\n\t\t// We leave source undefined, so that our editor will update\n\t\t// when the change arrives\n\t\tthis.file.SetTheirContent(undefined, this.isWorkingDeleted() ? undefined : this.getWorkingText());\n\t}\n\tRevertOur() : void {\n\t\t// Leave source undefined so that our editor updates when\n\t\t// changes arrive.\n\t\tthis.file.RevertOur(undefined)\n\t\t.catch(EBW.Error);\n\t}\n\tRevertTheir() : void {\n\t\t// Leave source undefined so that our editor updates when\n\t\t// changes arrive.\t\n\t\tthis.file.RevertTheir(undefined)\n\t\t.catch(EBW.Error);\n\t}\n\tisWorkingDeleted() : boolean {\n\t\treturn !this.file.WorkingFile().Exists;\n\t}\n\tisTheirDeleted() : boolean {\n\t\treturn !this.file.TheirFile().Exists;\n\t}\n\tsetText(s:string) {\n\t\tif (this.editLeft) {\n\t\t\tthis.setLHS(s);\n\t\t} else {\n\t\t\tthis.setRHS(s);\n\t\t}\n\t}\n\tgetLeftCM() {\n\t\treturn jQuery(this.mergelyDiv).mergely('cm', 'lhs');\n\t}\n\tgetRightCM() {\n\t\treturn jQuery(this.mergelyDiv).mergely('cm', 'rhs');\n\t}\n\tgetLHS() : string {\n\t\treturn this.getLeftCM().getDoc().getValue();\n\t}\n\tgetRHS() : string {\n\t\treturn this.getRightCM().getDoc().getValue();\n\t}\n\tsetLHS(s:string) {\n\t\tif (!s) s=``;\n\t\tthis.getLeftCM().getDoc().setValue(s);\n\t}\n\tsetRHS(s:string) {\n\t\tif (!s) s=``;\n\t\tthis.getRightCM().getDoc().setValue(s);\n\t}\n\tSaveFile() : Promise<string> {\n\t\tif (this.mergeImageEditor!=null) {\n\t\t\t// SaveFile returns automatically if we're resolving images\n\t\t\treturn Promise.resolve(``);\n\t\t}\n\t\tif (this.file) {\n\t\t\tlet f = this.file;\n\t\t\tlet w = this.getWorkingText();\n\t\t\t// We pass ourselves as the source, so that we don't update\n\t\t\t// our editor when the change event arrives\n\t\t\tthis.file.SetWorkingContent(this, this.isWorkingDeleted() ? undefined : this.getWorkingText());\n\t\t\tthis.file.SetTheirContent(this, this.isTheirDeleted() ? undefined : this.getTheirText());\n\t\t\treturn this.file.Save()\n\t\t\t.then(\n\t\t\t\t()=>{\n\t\t\t\t\tEBW.Toast(`Saved ${f.Path()}`);\n\t\t\t\t\treturn Promise.resolve(``);\n\t\t\t\t});\n\t\t}\n\t\treturn Promise.reject(`No file to save`);\n\t}\n\tFileEventListener(source:any, e:FileEvent, fc:FileContent) {\n\t\t// If we were ourselves the source of the event, we ignore it.\n\t\tif (source==this) {\n\t\t\treturn;\n\t\t}\n\t\tswitch (e) {\n\t\t\tcase FileEvent.WorkingChanged:\n\t\t\t\tthis.setWorkingText(fc.Raw);\n\t\t\t\tbreak;\n\t\t\tcase FileEvent.TheirChanged:\n\t\t\t\tthis.setTheirText(fc.Raw);\n\t\t\t\tbreak;\n\t\t\tcase FileEvent.StatusChanged:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\t// Merge starts merging a file.\n\tMerge(file:File) : void {\n\t\t// console.log(`Merge: ${file.Path()}`);\n\t\tif (this.file && this.file.Path()==file.Path()) {\n\t\t\treturn;\t// Nothing to do if we're selecting the same file\n\t\t}\n\t\t// Save any file we're currently editing\n\t\tif (this.file) {\n\t\t\tif (null==this.mergeImageEditor) {\n\t\t\t\tthis.SaveFile();\n\t\t\t}\n\t\t\tthis.file.Listen.remove(this.FileEventListener, this);\n\t\t}\n\t\t// Controls must receive update before we do.\n\t\t// TODO : Actually, the controls should listen to US, not to the\n\t\t// file, and we should have an 'EditorStateModel'... something for next version ;)\n\t\tthis.controls.SetFile(file);\n\n\t\tif (ImageIdentify.isImage(file.Path())) {\n\t\t\tthis.parent.textContent = ``;\n\t\t\tthis.mergeImageEditor = new MergeImageEditor(this.context, this.parent, file.Path());\n\t\t\tthis.file = file;\n\t\t\tthis.file.Listen.add(this.FileEventListener, this);\n\t\t\tconsole.log(`created new MergeImageEditor with parent `, this.parent);\n\t\t\tthis.controls.setImageEditing(true);\n\t\t\treturn;\n\t\t}\n\t\tthis.controls.setImageEditing(false);\n\t\tthis.mergeImageEditor= null;\n\t\t// VERY importantly, we don't listen to the file \n\t\t// until after we've concluded the FetchContent, because\n\t\t// we won't have an editor to populate when FetchContent\n\t\t// sends its signals that the content has changed.\n\t\t// However, because we configure ourselves as the source,\n\t\t// if we were listening, it shouldn't be a problem...\n\t\tlet p = file.FetchContent(this)\n\t\t.then(\n\t\t\t()=>{\n\t\t\t\treturn Promise.all( [file.WorkingFile(), file.TheirFile()] );\n\t\t\t}\n\t\t)\n\t\t.then(\n\t\t\t(args:FileContent[]) => {\n\t\t\t\tlet [working,their] = [ args[0], args[1] ];\t\n\t\t\t\tthis.file = file;\n\n\t\t\t\tthis.file.Listen.add(this.FileEventListener, this);\n\n\t\t\t\tlet lhsText:string, rhsText:string;\n\t\t\t\tif (this.editLeft) {\n\t\t\t\t\tlhsText = working.Raw;\n\t\t\t\t\trhsText = their.Raw;\n\t\t\t\t} else {\n\t\t\t\t\tlhsText = their.Raw;\n\t\t\t\t\trhsText = working.Raw;\n\t\t\t\t}\n\n\t\t\t\t// Create a new Mergely Editor for each file\n\t\t\t\tthis.parent.textContent = ``;\n\t\t\t\tthis.mergelyDiv = document.createElement(`div`) as HTMLDivElement;\n\t\t\t\tthis.parent.appendChild(this.mergelyDiv);\n\t\t\t\tlet m = jQuery(this.mergelyDiv);\n\t\t\t\tm.mergely(\n\t\t\t\t{\n\t\t\t\t\tcmsettings : {\n\t\t\t\t\t\treadOnly: false, \n\t\t\t\t\t\tlineNumbers: true,\n\t\t\t\t\t\tlineWrapping: true,\n\t\t\t\t\t},\n\t\t\t\t\tlhs_cmsettings: {\n\t\t\t\t\t\treadOnly: (!this.editBoth) && (!this.editLeft)\n\t\t\t\t\t},\n\t\t\t\t\trhs_cmsettings: {\n\t\t\t\t\t\treadOnly: (!this.editBoth) && this.editLeft\n\t\t\t\t\t},\n\t\t\t\t\teditor_height: \"100%\",\n\t\t\t\t\tlhs: function(setValue:(v:string)=>void) {\n\t\t\t\t\t\tsetValue(lhsText);\n\t\t\t\t\t},\n\t\t\t\t\trhs: function(setValue:(v:string)=>void) {\n\t\t\t\t\t\tsetValue(rhsText);\n\t\t\t\t\t},\n\t\t\t\t});\n\t\t\t\tthis.getLeftCM().on(`change`, (cm:CodeMirror.Editor, obj:any)=>{\n\t\t\t\t\tif (this.editLeft) {\n\t\t\t\t\t\tthis.file.SetWorkingExists(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.file.SetTheirExists(true);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.getRightCM().on(`change`, (cm:CodeMirror.Editor, obj:any)=>{\n\t\t\t\t\tif (this.editLeft) {\n\t\t\t\t\t\tthis.file.SetTheirExists(true);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.file.SetWorkingExists(true);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t);\n\t}\n\n}","import {MergeEditor} from './MergeEditor';\nimport {conflict_MergeInstructions as Template } from '../Templates';\n\nexport class MergeInstructions extends Template {\n\tconstructor(parent: HTMLElement, editor: MergeEditor) {\n\t\tsuper();\n\t\tif (!parent) {\n\t\t\treturn;\n\t\t}\n\t\tthis.$.theirSide.innerHTML = editor.TheirSide();\n\t\tthis.$.ourSide.innerHTML = editor.WorkingSide();\n\n\t\tthis.$.show.addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\tthis.el.classList.toggle(`showing`);\n\t\t});\n\n\t\tparent.appendChild(this.el);\n\t}\n}","import {CommitMessageDialog as Template} from './Templates';\nimport {DialogEvents as FoundationRevealDialogEvents, FoundationRevealDialog} from './FoundationRevealDialog';\n\nexport class CommitMessageDialogResult {\n\tNotes? : string;\n\tMessage?: string;\n\tCancelled: boolean;\n}\nexport class CommitMessageDialog extends Template {\n\tprotected resolve: (m:CommitMessageDialogResult)=>void;\n\tprotected dialog: FoundationRevealDialog;\n\tprotected clearOnOpen: boolean;\n\n\tconstructor(clearOnOpen: boolean) {\n\t\tsuper();\n\t\t\n\t\tthis.clearOnOpen = clearOnOpen;\n\n\t\tthis.dialog = new FoundationRevealDialog(undefined, this.el);\n\t\tthis.dialog.Events.add( this.dialogEvent, this );\n\n\t\tthis.$.commit.addEventListener(`click`, (evt:Event)=>{\n\t\t\tevt.stopPropagation(); evt.preventDefault();\n\t\t\tthis.resolve({\n\t\t\t\tMessage:this.$.message.value, \n\t\t\t\tNotes:``,\n\t\t\t\tCancelled: false});\n\t\t\tthis.resolve = undefined;\n\t\t\tthis.dialog.Close();\n\t\t});\n\t}\n\n\tdialogEvent(evt:FoundationRevealDialogEvents) {\n\t\tswitch (evt) { \n\t\t\tcase FoundationRevealDialogEvents.Closed:\n\t\t\t\t// If the commit button was pressed, we have resolved\n\t\t\t\t// the promise, and have cleared this.resolve\n\t\t\t\tif (this.resolve) {\n\t\t\t\t\tthis.resolve({Cancelled:true});\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\tcase FoundationRevealDialogEvents.Opened:\n\t\t\t\tif (this.clearOnOpen) {\n\t\t\t\t\tthis.$.message.value = ``;\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t};\n\t}\n\n\t// Open returns a Promise that will return a string[]. The string[]\n\t// will either contain two elements: \n\tOpen(title:string, instructions:string) : Promise<CommitMessageDialogResult> {\n\t\tthis.$.title.innerText = title;\n\t\tthis.$.instructions.innerText = instructions;\n\n\t\treturn new Promise<CommitMessageDialogResult>(\n\t\t\t(resolve,reject)=>{\n\t\t\t\tthis.resolve = resolve;\n\t\t\t\tthis.dialog.Open();\n\t\t\t});\n\t}\n}","import {conflict_ClosePRDialog as Template} from '../Templates';\nimport {DialogEvents as FoundationRevealDialogEvents, FoundationRevealDialog} from '../FoundationRevealDialog';\nimport {Eventify} from '../Eventify';\n\nexport class ClosePRDialogResult {\n\tClose? : boolean;\n\tCloseMessage?: string;\n\tCancelled: boolean;\n}\n\nexport class ClosePRDialog extends Template {\n\tprotected resolve: (m:ClosePRDialogResult)=>void;\n\tprotected dialog: FoundationRevealDialog;\n\tprotected clearOnOpen: boolean;\n\t// firstOpen is set false after the first time the dialog is opened.\n\t// This allows us to initialize default values iff this is the first usage,\n\t// or to go with the user's settings if this is not the first usage.\n\tprotected firstOpen = true;\n\n\tconstructor(clearOnOpen: boolean) {\n\t\tsuper();\n\t\t\n\t\tthis.clearOnOpen = clearOnOpen;\n\n\t\tthis.dialog = new FoundationRevealDialog(undefined, this.el);\n\t\tthis.dialog.Events.add( this.dialogEvent, this );\n\n\t\tEventify(this.el, {\n\t\t\t\"change\": (evt:Event) => {\n\t\t\t\tevt.stopPropagation(); evt.preventDefault();\n\t\t\t\tconsole.log(`Clicked `, evt.target);\n\t\t\t\tlet close = (evt.target as HTMLElement).getAttribute(\"value\")==\"yes\";\n\t\t\t\tif (close) {\n\t\t\t\t\tthis.$.closeMessage.removeAttribute('disabled');\n\t\t\t\t} else {\n\t\t\t\t\tthis.$.closeMessage.setAttribute('disabled','disabled');\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"done\": (evt:Event)=>{\n\t\t\t\tconsole.log(`done event`);\n\t\t\t\tevt.stopPropagation(); evt.preventDefault();\n\t\t\t\tthis.resolve({\n\t\t\t\t\tClose:this.$.closePR_yes.checked,\n\t\t\t\t\tCloseMessage:this.$.closeMessage.value, \n\t\t\t\t\tCancelled: false});\n\t\t\t\tthis.resolve = undefined;\n\t\t\t\tthis.dialog.Close();\n\t\t\t}\t\n\t\t});\n\t}\n\n\tdialogEvent(evt:FoundationRevealDialogEvents) {\n\t\tswitch (evt) { \n\t\t\tcase FoundationRevealDialogEvents.Closed:\n\t\t\t\t// If the commit button was pressed, we have resolved\n\t\t\t\t// the promise, and have cleared this.resolve\n\t\t\t\tif (this.resolve) {\n\t\t\t\t\tthis.resolve({Cancelled:true});\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\tcase FoundationRevealDialogEvents.Opened:\n\t\t\t\tif (this.clearOnOpen) {\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t};\n\t}\n\n\t// Open returns a Promise that will return a string[]. The string[]\n\t// will either contain two elements: \n\tOpen(title:string, instructions:string, defaultSetting?:ClosePRDialogResult) : Promise<ClosePRDialogResult> {\n\t\tthis.$.title.innerText = title;\n\t\tthis.$.instructions.innerText = instructions;\n\n\t\tif (defaultSetting && this.firstOpen) {\n\t\t\tthis.firstOpen = true;\n\t\t\tthis.$.closePR_yes.checked = defaultSetting.Close;\n\t\t\tthis.$.closePR_no.checked = !(this.$.closePR_yes.checked);\n\t\t\tif (this.$.closePR_yes.checked) {\n\t\t\t\tthis.$.closeMessage.removeAttribute(`disabled`);\n\t\t\t} else {\n\t\t\t\tthis.$.closeMessage.setAttribute(`disabled`,`disabled`);\n\t\t\t}\n\t\t}\n\t\tif (this.clearOnOpen) {\n\t\t\tthis.$.closePR_yes.checked = false;\n\t\t\tthis.$.closePR_no.checked = true;\n\t\t\tthis.$.closeMessage.setAttribute('disabled','disabled');\n\t\t}\n\n\t\treturn new Promise<ClosePRDialogResult>(\n\t\t\t(resolve,reject)=>{\n\t\t\t\tthis.resolve = resolve;\n\t\t\t\tthis.dialog.Open();\n\t\t\t});\n\t}\n}","\n// MergingInfo is the typescript equivalent of the EBWRepoStatus which provides\n// some information on how the repo came to be in a conflict state.\nexport class MergingInfo {\n\tpublic PRNumber : number;\n\tpublic Description: string;\n\n\tconstructor(dataEl?:HTMLElement) {\n\t\tif (!dataEl) {\n\t\t\tdataEl = document.getElementById(`merging-info`);\n\t\t}\n\t\tlet js : any = JSON.parse(dataEl.innerText);\n\t\tthis.PRNumber = js.MergingPRNumber;\n\t\tthis.Description = js.MergingDescription;\n\t}\n\n\tIsPRMerge() : boolean {\n\t\treturn (0 < this.PRNumber);\n\t}\n}","import {ConflictEditor} from './ConflictEditor';\nimport {Context} from '../Context';\nimport {EBW} from '../EBW';\nimport {File,FileEvent,FileContent} from './File';\nimport {ImageIdentify} from '../ImageIdentify';\nimport {MergeEditorControlBar,MergeEditorAction} from './MergeEditorControlBar';\n\nimport signals = require('signals');\nimport CodeMirror = require('codemirror');\nimport {EditorCodeMirror} from '../EditorCodeMirror';\nimport {MergeImageEditor} from './MergeImageEditor';\n\nexport class SingleEditor implements ConflictEditor {\n\tpublic Listen:signals.Signal;\n\tprotected file:File;\n\tprotected editor:EditorCodeMirror;\n\tprotected isDeleted:boolean;\n\tprotected controls:MergeEditorControlBar;\n\tprotected imageEditor: MergeImageEditor;\n\n\tconstructor(protected context:Context,\n\t\tprotected parent:HTMLElement) {\n\t\tthis.Listen = new signals.Signal();\n\n\t\tthis.controls = new MergeEditorControlBar();\n\t\tthis.controls.Listen.add(this.controlAction, this);\n\t\tthis.imageEditor = undefined;\n\t\tthis.editor = undefined;\n\t}\n\n\tcontrolAction(act:MergeEditorAction) {\n\t\tswitch(act) {\n\t\t\tcase MergeEditorAction.Save:\n\t\t\t\tthis.SaveFile()\n\t\t\t\t.catch( EBW.Error );\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.Delete:\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.Resolve:\n\t\t\t\tthis.SaveFile()\n\t\t\t\t.then(\n\t\t\t\t\t()=>{\n\t\t\t\t\t\t// undefined so we receive notifications\n\t\t\t\t\t\treturn this.file.Stage(undefined);\n\t\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t()=>{\n\t\t\t\t\t\tEBW.Toast(`Resolved changes on ${this.file.Path()}`);\n\t\t\t\t\t})\n\t\t\t\t.catch(EBW.Error);\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.RevertOur:\n\t\t\t\tthis.file.RevertOur(undefined);\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.RevertTheir:\n\t\t\t\tthis.file.RevertOurToTheir(undefined);\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.RevertGit:\n\t\t\t\tthis.file.RevertOurToGit(undefined);\n\t\t\t\tbreak;\n\t\t}\n\t}\t\n\tWorkingSide():string {\n\t\treturn \"-\";\n\t}\n\tTheirSide():string {\n\t\treturn '-';\n\t}\n\tgetWorkingText() : string {\n\t\treturn this.editor.getValue();\n\t}\n\tsetWorkingText(s:string) : void{\n\t\tthis.editor.setValue(s);\n\t}\n\tisWorkingDeleted() : boolean {\n\t\treturn this.isDeleted;\n\t}\n\tSaveFile() : Promise<string> {\n\t\tif (this.imageEditor) {\n\t\t\treturn Promise.resolve(``);\n\t\t}\n\t\tif (this.file) {\n\t\t\tlet f = this.file;\n\t\t\tlet w = this.getWorkingText();\n\t\t\t// We pass ourselves as the source, so that we don't update\n\t\t\t// our editor when the change event arrives\n\t\t\tthis.file.SetWorkingContent(this, this.isWorkingDeleted() ? undefined : \n\t\t\t\tthis.getWorkingText());\n\n\t\t\treturn this.file.Save()\n\t\t\t.then(\n\t\t\t\t()=>{\n\t\t\t\t\tEBW.Toast(`Saved ${f.Path()}`);\n\t\t\t\t\treturn Promise.resolve(``);\n\t\t\t\t});\n\t\t}\n\t\treturn Promise.reject(`No file to save`);\n\t}\n\tFileEventListener(source:any, e:FileEvent, fc:FileContent) : void {\n\t\t// If we were ourselves the source of the event, we ignore it.\n\t\tif (source==this) {\n\t\t\treturn;\n\t\t}\n\t\tswitch (e) {\n\t\t\tcase FileEvent.WorkingChanged:\n\t\t\t\tthis.setWorkingText(fc.Raw);\n\t\t\t\tbreak;\n\t\t\tcase FileEvent.StatusChanged:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\t// Merge starts merging a file.\n\tMerge(file:File) : void {\n\t\tconsole.log(`Merge: ${file.Path()}`);\n\t\tif (this.file && this.file.Path()==file.Path()) {\n\t\t\treturn;\t// Nothing to do if we're selecting the same file\n\t\t}\n\t\t// Save any file we're currently editing\n\t\tif (this.file) {\n\t\t\tif (!this.imageEditor) {\n\t\t\t\tthis.SaveFile();\n\t\t\t}\n\t\t\tthis.file.Listen.remove(this.FileEventListener, this);\n\t\t\tthis.file = undefined;\n\t\t}\n\t\t// Controls must receive update before we do.\n\t\t// TODO : Actually, the controls should listen to US, not to the\n\t\t// file, and we should have an 'EditorStateModel'...\n\t\tif (ImageIdentify.isImage(file.Path())) {\n\t\t\tthis.parent.textContent = ``;\n\t\t\tthis.imageEditor = new MergeImageEditor(\n\t\t\t\tthis.context, this.parent, file.Path()\n\t\t\t\t);\n\t\t\tthis.file = file;\n\t\t\tthis.file.Listen.add(this.FileEventListener, this);\n\t\t\tconsole.log(`created new MergeImageEditor with parent `, this.parent);\n\t\t\tthis.controls.setImageEditing(true);\n\t\t\treturn;\n\t\t}\n\t\tthis.controls.setImageEditing(false);\n\t\tthis.imageEditor= null;\t\t\n\t\tthis.editor = new EditorCodeMirror(this.parent);\n\n\t\t//this.controls.SetFile(file);\n\n\t\t// VERY importantly, we don't listen to the file \n\t\t// until after we've concluded the FetchContent, because\n\t\t// we won't have an editor to populate when FetchContent\n\t\t// sends its signals that the content has changed.\n\t\t// However, because we configure ourselves as the source,\n\t\t// if we were listening, it shouldn't be a problem...\n\t\tlet p = file.FetchContent(this)\n\t\t.then(\n\t\t\t()=>{\n\t\t\t\treturn Promise.all( [file.WorkingFile(), file.TheirFile()] );\n\t\t\t}\n\t\t)\n\t\t.then(\n\t\t\t(args:FileContent[]) => {\n\t\t\t\tlet [working,their] = [ args[0], args[1] ];\t\n\t\t\t\tthis.file = file;\n\n\t\t\t\tthis.file.Listen.add(this.FileEventListener, this);\n\t\t\t\tconsole.log(`About to set file contents to `, working.Raw);\n\t\t\t\tif (working.Exists) {\n\t\t\t\t\tthis.editor.setValue(working.Raw);\n\t\t\t\t} else {\n\t\t\t\t\tthis.editor.setValue(``);\n\t\t\t\t}\n\t\t\t\tthis.editor.setModeOnFilename(file.Path());\n\t\t\t}\n\t\t);\n\t}\n}","\nimport {ConflictEditor} from './conflict/ConflictEditor';\nimport {Context} from './Context';\nimport {ControlTag} from './ControlTag';\nimport {EBW} from './EBW';\nimport {File} from './conflict/File';\nimport {FileList} from './conflict/FileList';\nimport {FileListDisplayEvent, FileListDisplay} from './conflict/FileListDisplay';\nimport {MergeEditor} from './conflict/MergeEditor';\nimport {MergeInstructions} from './conflict/MergeInstructions';\nimport {CommitMessageDialogResult, CommitMessageDialog} from './CommitMessageDialog';\nimport {ClosePRDialog, ClosePRDialogResult} from './conflict/ClosePRDialog';\nimport {MergingInfo} from './conflict/MergingInfo';\nimport {SingleEditor} from './conflict/SingleEditor';\n\n// RepoConflictPage handles conflict-merging for the repo.\n// It's main data is generated in public/repo_conflict.html\nexport class RepoConflictPage {\n\tprotected editor: ConflictEditor;\n\tprotected commitDialog: CommitMessageDialog;\n\tprotected closePRDialog: ClosePRDialog;\n\tprotected mergingInfo: MergingInfo;\n\n\tconstructor(protected context:Context) {\n\t\tthis.mergingInfo = new MergingInfo(document.getElementById(`merging-info`));\n\t\tthis.closePRDialog = new ClosePRDialog(false);\n\n\t\tlet fileList = new FileList(context);\n\t\tlet fileListDisplay = new FileListDisplay(context, document.getElementById(`staged-files-list`), fileList, this.mergingInfo);\n\n\t\tfileListDisplay.el.addEventListener(`file-click`, (evt:CustomEvent)=> {\n\t\t\tthis.fileListEvent(undefined, evt.detail.file);\n\t\t});\n\n\t\tif (this.mergingInfo.IsPRMerge()) {\n\t\t\tthis.editor = new MergeEditor(context, document.getElementById(`editor-work`));\n\t\t\tnew MergeInstructions(document.getElementById('merge-instructions'), this.editor as MergeEditor);\n\t\t} else {\n\t\t\tlet work = document.getElementById(`editor-work`);\n\t\t\tthis.editor = new SingleEditor(context, work);\n\t\t}\n\t\t// items to be hidden in a PR merge or a not-pr-merge are controlled\n\t\t// by CSS visibility based on whether they have a .pr-merge or .not-pr-merge\n\t\t// class\n\t\t\n\t\tthis.commitDialog = new CommitMessageDialog(false);\n\n\t\tnew ControlTag(document.getElementById(`files-show-tag`),\n\t\t\t(showing:boolean)=>{\n\t\t\t\tlet el = document.getElementById(`files`);\n\t\t\t\tif (showing)\n\t\t\t\t\tel.classList.add(`showing`);\n\t\t\t\telse\n\t\t\t\t\tel.classList.remove(`showing`);\t\t\t\t\n\t\t\t\t// el\n\t\t\t\t// .style.width = showing ? \"30em\":\"0px\";\n\t\t\t});\n\n\n\t\tlet filesEl = document.getElementById('staged-files-data');\n\t\tif (!filesEl) {\n\t\t\tEBW.Error(`FAILED TO FIND #staged-files-data: cannot instantiate RepoConflictPage`);\n\t\t\treturn;\n\t\t}\n\t\tlet listjs = filesEl.innerText;\n\t\tlet fileListData = JSON.parse(listjs);\n\t\tfileList.load(fileListData);\n\n\t\tdocument.getElementById(`action-commit`).addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\tconsole.log(`IN action-commit CLICK LISTENER`);\n\t\t\tEBW.API().IsRepoConflicted(this.context.RepoOwner, this.context.RepoName)\n\t\t\t.then(\n\t\t\t\t([conflicted]:[boolean])=>{\n\t\t\t\t\tif (conflicted) {\n\t\t\t\t\t\tEBW.Alert(`You need to resolve all file conflicts before you can resolve the merge.`);\n\t\t\t\t\t\treturn Promise.resolve();\n\t\t\t\t\t}\n\t\t\t\t\treturn this.commitDialog.Open(`Resolve Conflict`, `The merge will be resolved.`)\n\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\t(r:CommitMessageDialogResult) => {\n\t\t\t\t\t\t\t\tif (r.Cancelled) {\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconsole.log(`Result= `, r);\n\t\t\t\t\t\t\t\tthis.context.RepoRedirect(`conflict/resolve`, \n\t\t\t\t\t\t\t\t\tnew Map([[`message`,r.Message],[`notes`,r.Notes]])\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t})\n\n\t\t\t})\n\t\t\t.catch (EBW.Error);\n\t\t});\n\t\tdocument.getElementById(`action-abort`).addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\tif (this.mergingInfo.IsPRMerge()) {\n\t\t\t\tthis.closePRDialog.Open(`Close PR`,\n\t\t\t\t\t`You have been merging PR ${this.mergingInfo.PRNumber}.\n\t\t\t\t\tDo you want to close the PR?`, \n\t\t\t\t\t{Close: false, CloseMessage:\"\", Cancelled: false})\n\t\t\t\t.then(\n\t\t\t\t\t(r:ClosePRDialogResult)=>{\n\t\t\t\t\t\tif (r.Cancelled) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.context.RepoRedirect(`conflict/abort`, \n\t\t\t\t\t\t\tnew Map([[`message`,r.CloseMessage],\n\t\t\t\t\t\t\t\t[`close`,r.Close]])\n\t\t\t\t\t\t);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t})\n\t\t\t\t.catch( EBW.Error );\n\t\t\t} else {\t\t\t\t\n\t\t\t\tthis.context.RepoRedirect(`conflict/abort`);\n\t\t\t}\n\t\t})\n\t}\n\tfileListEvent(e:FileListDisplayEvent, f:File) : void {\n\t\tthis.editor.Merge(f);\n\t}\n}","import {EBW} from './EBW';\nimport {Eventify} from './Eventify';\nimport {MergeEditor as Template} from './Templates';\nimport {PRDiffModel} from './PRDiffModel';\nimport {AddToParent} from './DOM';\nimport jQuery = require('jquery');\n\nexport class MergeEditor extends Template {\n\tprotected mergelyDiv: HTMLDivElement;\n\n\tconstructor(\n\t\tprotected parent:HTMLElement, \n\t\tprotected model:PRDiffModel) \n\t{\n\t\tsuper();\n\t\tEventify(this.el, {\n\t\t\t'save': (evt:any)=>{\n\t\t\t\tevt.preventDefault();\n\t\t\t\tmodel.Update(this.get())\n\t\t\t\t.catch( err=>{\n\t\t\t\t\tconsole.log(`Error on the save function`);\n\t\t\t\t\tEBW.Error(err);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tAddToParent(this.parent, this.el);\t\t\n\n\t\tmodel.GetContent()\n\t\t.then( (args)=>this.mergely(args) )\n\t\t.catch( EBW.Error );\n\t}\n\tget() : string {\n\t\tlet cm = jQuery(this.mergelyDiv).mergely('cm', 'lhs');\n\t\treturn cm.getDoc().getValue();\n\t}\n\tmergely([local, remote, diff]:[string,string,string]) : void {\n\t\tthis.$.mergely.textContent= ``;\n\t\tthis.mergelyDiv = document.createElement(`div`) as HTMLDivElement;\n\t\tthis.$.mergely.appendChild(this.mergelyDiv);\n\t\tlet m = jQuery(this.mergelyDiv);\n\t\tm.mergely({\n\t\t\tcmsettings: { \n\t\t\t\treadOnly: false, \n\t\t\t\tlineNumbers: true,\n\t\t\t\twrap_lines: true,\n\t\t\t},\n\t\t\trhs_cmsettings: {\n\t\t\t\t// readOnly: true,\n\t\t\t},\n\t\t\t// editor_height: \"40em\",\n\t\t\tautoresize: true,\n\t\t\teditor_height: \"100%\",\n\t\t\t// editor_width: \"48%\",\n\t\t\twrap_lines: true,\n\t\t\tlhs: function(setValue:(v:string)=>void) {\n\t\t\t\tsetValue(local);\n\t\t\t},\n\t\t\trhs: function(setValue:(v:string)=>void) {\n\t\t\t\tsetValue(remote);\n\t\t\t},\n\t\t\theight: (h:number)=>{\n\t\t\t\treturn this.$.mergely.clientHeight + \"px\";\n\t\t\t},\n\t\t\twidth: (w:number)=>{\n\t\t\t\treturn this.$.mergely.clientWidth + \"px\";\n\t\t\t}\n\t\t});\n\t\tlet right = jQuery(this.mergelyDiv).mergely('cm', 'rhs');\n\t\tconsole.log('right hand cm = ', right);\n\t}\t\n}","import {EBW} from './EBW';\nimport {API} from './API';\nimport {PRArgs} from './PRArgs';\n\nimport signals = require('signals');\n\n/**\n * PRDiffModel provides a model of a single diff\n * between local and remote\n * diff =  Object { \n *    path: \"book/text/01.md\", \n *    remote_path: \"/home/craig/proj/ebw/git_cache/pr_r…\", \n *    remote_hash: \"e9c882ca90909485619b340312151904146…\", \n *    local_path: \"/home/craig/proj/ebw/git_cache/repo…\", \n *    local_hash: \"b73db84fa8269f29c7a5daade4bd21731f5…\",\n *    equal: false \n * }\n */\ninterface Diff {\n\tpath: string;\n\tremote_path: string;\n\tremote_hash: string;\n\tlocal_path: string;\n\tlocal_hash: string;\n\tequal: boolean;\n}\n\nexport class PRDiffModel {\n\tpublic DirtySignal : signals.Signal;\n\tpublic EditingSignal : signals.Signal;\n\n\tconstructor(\n\t\tprotected diff: Diff,\n\t\tprotected prArgs: PRArgs) \n\t{\n\n\t\tthis.DirtySignal = new signals.Signal();\n\t\tthis.EditingSignal = new signals.Signal();\n\t}\n\tpath() : string {\n\t\treturn this.diff.path;\n\t}\n\tkey() : string {\n\t\treturn this.diff.remote_hash + \":\" + this.diff.local_hash;\n\t}\n\torigKey():string {\n\t\treturn this.key + '-original';\n\t}\n\tGetContent() : Promise<any> {\n\t\tconsole.log(`calling API.PullRequestVersions(`,\n\t\t\tJSON.stringify(this.prArgs) , this.diff.path, `)`);\n\n\t\treturn EBW.API().PullRequestVersions(\n\t\t\tthis.prArgs.repoOwner,\n\t\t\tthis.prArgs.repoName,\n\t\t\tthis.prArgs.remoteURL,\n\t\t\tthis.prArgs.remoteSHA,\n\t\t\tthis.diff.path);\n\t}\n\tUpdate(content:string):Promise<void> {\n\t\treturn EBW.API().PullRequestUpdate(\n\t\t\tthis.prArgs.repoOwner,\n\t\t\tthis.prArgs.repoName,\n\t\t\tthis.prArgs.remoteSHA,\n\t\t\tthis.diff.path,\n\t\t\tcontent);\n\t}\n}","import {PullRequestDiffList_File as Template} from './Templates';\nimport {PRDiffModel} from './PRDiffModel';\n\ninterface Callback {\n\t(d:PRDiffModel):void;\n}\n\nexport class PullRequestDiffList_File extends Template {\n\tconstructor(\n\t\tprotected parent:HTMLElement, \n\t\tprotected diff: PRDiffModel,\n\t\tprotected callback: Callback) {\n\t\tsuper();\n\t\tthis.el.textContent = diff.path();\n\t\tthis.el.addEventListener('click', (evt)=>{\n\t\t\tthis.callback(this.diff);\n\t\t});\n\t\tparent.appendChild(this.el);\n\t}\n}","import {MergeEditor} from './MergeEditor';\nimport {PRArgs} from './PRArgs';\nimport {PRDiffModel} from './PRDiffModel';\nimport {PullRequestDiffList_File} from './PullRequestDiffList_File';\n\nexport class PullRequestMergePage {\n\tprotected files: PRDiffModel[];\n\tprotected filesEL: HTMLElement;\n\n\tconstructor(\n\t\t diffs: any[],\n\t\t protected prArgs:any, \n\t\t protected filesParent: HTMLElement,\n\t\t protected mergelyParent:HTMLElement)\n\t{\n\t\tthis.files = [];\n\t\tif (!this.filesParent) {\n\t\t\talert(`PullRequestMergePage called, but filesParent is undefined`);\n\t\t\tdebugger;\n\t\t}\n\t\tfor (let d of diffs) {\n\t\t\tlet diff = new PRDiffModel(d, prArgs);\n\t\t\tthis.files.push(diff);\n\t\t\tnew PullRequestDiffList_File(\n\t\t\t\tthis.filesParent,\n\t\t\t\tdiff,\n\t\t\t\t(d)=>{\n\t\t\t\t\tthis.viewDiff(d);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tviewDiff(diff:PRDiffModel):void {\n\t\tthis.mergelyParent.textContent='';\n\t\tnew MergeEditor(this.mergelyParent, diff);\n\t}\n\tstatic instantiate():void {\n\t\tlet pr = document.getElementById('pr-merge-page');\n\t\tif (pr) {\n\t\t\tnew PullRequestMergePage(\n\t\t\t\tJSON.parse(pr.textContent),\n\t\t\t\t{\n\t\t\t\t\trepoOwner: pr.getAttribute(`repo-owner`),\n\t\t\t\t\trepoName: pr.getAttribute(`repo-name`),\n\t\t\t\t\tremoteURL: pr.getAttribute(`remote-url`),\n\t\t\t\t\tremoteSHA: pr.getAttribute(`remote-sha`)\n\t\t\t\t}, \n\t\t\t\tdocument.getElementById(`pr-files-list`),\n\t\t\t\tdocument.getElementById(`mergely-container`)\n\t\t\t);\n\t\t}\n\t}\n\n}","type insertFunction = (el:HTMLElement)=>void;\n\n\nexport class DOMInsert {\n\tconstructor(protected parent:HTMLElement|insertFunction) {\n\n\t}\n\tInsert(el:HTMLElement):void {\n\t\tif ('function'==typeof this.parent) {\n\t\t\tthis.parent(el);\n\t\t} else {\n\t\t\tthis.parent.appendChild(el);\n\t\t}\n\t}\n}","import {Context} from './Context';\nimport {EBW} from './EBW';\nimport {DOMInsert} from './DOMInsert';\nimport {RepoFileViewerFile as Template} from './Templates';\nimport {RepoFileViewerPage} from './RepoFileViewerPage';\n\nexport class RepoFileViewerFile extends Template {\n\t// version allows us to force browser-reload\n\tprotected version: number;\n\tRefresh() : void {\n\t\tlet src = `/img/plus.svg`;\n\t\tif (``!=this.filename) {\n\t\t\tsrc = `/www/${this.context.RepoOwner}/${this.context.RepoName}/${this.filename}?v=` + (this.version++);\n\t\t}\n\t\tthis.$.img.setAttribute('src', src);\n\t}\n\tFilename() : string {\n\t\treturn this.filename;\n\t}\n\t// IsAddButton returns true if this RepoFileViewerFile is in fact just the generic\n\t// 'add a new file' button\n\tIsAddButton() : boolean {\n\t\treturn ``==this.filename;\n\t}\n\n\tconstructor(protected context:Context, protected filename:string, parent:DOMInsert, protected page: RepoFileViewerPage) {\n\t\tsuper();\n\t\tthis.version = 1;\n\t\tthis.Refresh();\n\t\tthis.$.filename.textContent = this.filename ? this.filename : `Drop a file to upload.`;\n\t\tparent.Insert(this.el);\n\n\t\tthis.el.addEventListener('drop', (evt)=>{\n\t\t\tevt.preventDefault();\t\n\t\t\t// Necessary so the browser doesn't just display the dropped item\n\t\t\tconsole.log(`Going to run this.page.FileDrop`);\n\t\t\tthis.page.FileDrop(this, evt);\n\t\t});\n\t\tthis.el.addEventListener('drag', (evt)=>{\n\t\t});\n\t\tthis.el.addEventListener('dragover', (evt)=>{\n\t\t\tevt.preventDefault();\n\t\t});\n\t\tthis.el.addEventListener(`dragend`,(evt:DragEvent)=>{\n\t\t\tevt.preventDefault();\n\t\t\tlet dt = evt.dataTransfer;\n\t\t\tconsole.log(`dragend: dt = `, dt);\n\t\t\tif (dt.items) {\n\t\t\t\tfor (let i=0; i<dt.items.length; i++) {\n\t\t\t\t\tdt.items.remove(i);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdt.clearData();\n\t\t\t}\n\t\t});\n\t}\n}","import {Context} from './Context';\nimport {DOMInsert} from './DOMInsert';\nimport {EBW} from './EBW';\nimport {RepoFileViewerPage as Template} from './Templates';\nimport {RepoFileViewerFile} from './RepoFileViewerFile';\n\ninterface EditFieldListener {\n\tValueChanged(v:string):void;\n}\n\nclass EditField {\n\tprotected value:string;\n\tconstructor(protected el:HTMLInputElement, protected page:EditFieldListener) {\n\t\tthis.value = el.value;\n\t\tthis.el.addEventListener(`keyup`, (evt)=>{\n\t\t\tlet v = el.value;\n\t\t\tif (v!=this.value) {\n\t\t\t\tthis.value = v;\n\t\t\t\tpage.ValueChanged(v);\n\t\t\t}\n\t\t});\n\t}\n}\n\ninterface LoadFilesListener {\n\tFilesFound(files:string[]):void;\n}\n\nclass LoadFiles {\n\tprotected searchingFor: string;\n\tconstructor(protected context:Context, protected listener:LoadFilesListener){}\n\tSearch(s:string):void {\n\t\tconsole.log(`LoadFiles.Search(${s})`);\n\t\tthis.searchingFor = s;\n\t\tEBW.API()\n\t\t.SearchForFiles(this.context.RepoOwner, this.context.RepoName, s)\n\t\t.then(\n\t\t\t([search, files]:[string, string[]])=>{\t\t\t\t\n\t\t\t\tif (search!=this.searchingFor) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.listener.FilesFound(files);\n\t\t\t});\n\t}\n}\n\nexport class RepoFileViewerPage extends Template implements EditFieldListener {\n\tprotected loadFiles : LoadFiles;\n\tprotected inserter: DOMInsert;\n\tprotected add: RepoFileViewerFile;\n\n\tconstructor(protected context:Context, parent:HTMLElement) {\n\t\tsuper();\n\t\tthis.add = new RepoFileViewerFile(this.context, ``, new DOMInsert(this.$.data), this);\n\t\tthis.inserter = new DOMInsert( (el:HTMLElement)=>{\n\t\t\tthis.$.data.insertBefore(el, this.add.el);\n\t\t});\n\t\tparent.appendChild(this.el);\n\t\tthis.$.search.focus();\n\t\tthis.loadFiles = new LoadFiles(context, this);\n\t\tnew EditField(this.$.search, this);\n\n\t}\n\tValueChanged(s:string):void {\n\t\ts = s + `.*\\\\.(png|jpg|jpeg|svg|gif|tiff)$`\n\t\tthis.loadFiles.Search(s);\n\t}\n\tFilesFound(files:string[]):void {\n\t\tconsole.log(`FilesFound: `, files);\n\t\tlet e = this.$.data.firstChild;\n\t\twhile (e) {\n\t\t\tlet next = e.nextSibling;\n\t\t\tif (e!=this.add.el) {\n\t\t\t\tthis.$.data.removeChild(e);\n\t\t\t}\n\t\t\te = next;\n\t\t}\n\t\tfor (let f of files) {\n\t\t\tnew RepoFileViewerFile(this.context, f, this.inserter, this);\n\t\t}\n\t}\n\t_uploadFile(src:RepoFileViewerFile, file:any) : void {\n\t\t// READ THE FILE\n\t\tlet reader = new FileReader();\n\t\treader.addEventListener(`loadend`, (evt)=>{\n\t\t\t//console.log(`READ file. result=`, reader.result);\n\t\t\t//console.log(`Replacing file ${this.filename} with result`);\n\t\t\tlet u8 = new Uint8Array(reader.result);\t//Uint8Array.from(reader.result);\n\t\t\t//console.log(`u8 = `, u8);\n\t\t\tlet blen = u8.byteLength;\n\t\t\t//console.log(`blen = `, blen);\n\t\t\tlet binary = ``;\n\t\t\tfor (let i=0; i<blen; i++) {\n\t\t\t\tbinary += String.fromCharCode( u8[i] );\n\t\t\t}\n\t\t\tlet p : Promise<string>;\n\t\t\tif (``!=src.Filename()) {\n\t\t\t\tp = Promise.resolve<string>(src.Filename());\n\t\t\t} else {\n\t\t\t\tp = EBW.Prompt(`Enter full path and filename for uploaded file.`);\n\t\t\t}\n\t\t\tp.then(\n\t\t\t\t(s:string)=>{\n\t\t\t\t\tif (``==s) return Promise.resolve<string>(``);\n\t\t\t\t\treturn EBW.API().UpdateFileBinary(this.context.RepoOwner, this.context.RepoName, s, window.btoa(binary))\n\t\t\t\t\t.then(\n\t\t\t\t\t\t()=>{\n\t\t\t\t\t\t\treturn Promise.resolve<string>(s);\n\t\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t.then(\n\t\t\t\t(s:string)=>{\n\t\t\t\t\tif (``!=s) {\n\t\t\t\t\t\tif (!src.IsAddButton()) {\n\t\t\t\t\t\t\tsrc.Refresh();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnew RepoFileViewerFile(this.context, s, this.inserter, this);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tEBW.Toast(`Image uploaded`);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t.catch(\n\t\t\t\tEBW.Error\n\t\t\t);\n\t\t});\n\t\treader.readAsArrayBuffer(file);\n\t}\n\tFileDrop(src:RepoFileViewerFile, evt:any) {\n\t\tlet dt = evt.dataTransfer;\n\t\tconsole.log(`dt = `, dt);\n\t\tif (dt.items) {\n\t\t\tfor (let i=0; i<dt.items.length; i++) {\n\t\t\t\tlet item = dt.items[i] as DataTransferItem;\n\t\t\t\tif (item.kind == `file`) {\n\t\t\t\t\t//console.log(`filename = `, item.name);\n\t\t\t\t}\n\t\t\t\tthis._uploadFile(src,item.getAsFile());\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.log(`dt.files = `, dt.files);\n\n\t\t\tfor (let i=0; i<dt.files.length; i++) {\n\t\t\t\tlet file = dt.files[i];\n\t\t\t\tlet imageType = /^image\\//;\n\t\t\t\tif (!imageType.test(file.type)) {\n\t\t\t\t\talert(`You can only upload image files with this form.`);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tthis._uploadFile(src, file);\n\t\t\t}\n\t\t}\n\t}\n}","import {API} from './API';\nimport {APIWs} from './APIWs';\nimport {Context} from './Context';\nimport {Toast} from './Toast';\nimport {AddNewBookDialog} from './AddNewBookDialog';\nimport {LoginTokenList} from './LoginTokenList';\nimport {RepoDetailPage} from './RepoDetailPage';\nimport {RepoEditorPage} from './RepoEditorPage';\nimport {RepoConflictPage} from './RepoConflictPage';\nimport {QuerySelectorAllIterate} from './querySelectorAll-extensions';\nimport {PullRequestMergePage} from './PullRequestMergePage';\nimport {RepoFileViewerPage} from './RepoFileViewerPage';\n\nexport class EBW {\n\tstatic instance : EBW;\n\tprotected api : API;\n\tconstructor() {\n\t\tif (null==EBW.instance) {\n\t\t\tEBW.instance = this;\n\t\t\tthis.api = new APIWs();\n\t\t\tjQuery(document).foundation();\n\t\t\tLoginTokenList.init();\n\n\t\t\tlet el = document.getElementById(`ebw-context`);\n\t\t\tlet context : Context;\n\t\t\tif (el) {\n\t\t\t\tcontext = new Context(el, el.getAttribute(`data-repo-owner`),\n\t\t\t\t\tel.getAttribute(`data-repo-name`));\n\t\t\t\tswitch (el.getAttribute('data-page')) {\n\t\t\t\t\tcase 'RepoDetailPage':\n\t\t\t\t\t\tnew RepoDetailPage(context);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'RepoConflictPage':\n\t\t\t\t\t\tnew RepoConflictPage(context);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'RepoFileViewerPage':\n\t\t\t\t\t\tconsole.log(`Creating RepoFileViewerPage`); \n\t\t\t\t\t\tnew RepoFileViewerPage(context, document.getElementById(`repo-file-viewer`) as HTMLElement);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t/* TODO: This should actually use a Router\n\t\t\t   to determine what content we have. */\n\t\t\tAddNewBookDialog.instantiate();\n\t\t\tRepoEditorPage.instantiate();\n\t\t\tPullRequestMergePage.instantiate();\n\t\t}\n\t\treturn EBW.instance;\n\t}\n\tstatic API() : API {\n\t\tlet ebw = new EBW();\n\t\treturn ebw.api;\n\t}\n\tstatic Error(err : any) : void {\n\t\tconsole.error('ERROR: ', err);\n\t\tdebugger;\n\t\talert(err);\n\t}\n\tstatic Alert(msg:string) : Promise<void> {\n\t\talert(msg);\n\t\treturn Promise.resolve();\n\t}\n\tstatic Toast(msg : string, ...args:string[]) : void {\n\t\tToast.Show(msg + args.join(' '));\n\t}\n\tstatic Prompt(msg: string) : Promise<string> {\n\t\tlet r : string = prompt(msg);\n\t\treturn Promise.resolve<string>(r);\n\t}\n\tstatic Confirm(msg:string) : Promise<boolean> {\n\t\treturn Promise.resolve<boolean>(confirm(msg));\n\t}\n\t// flatten takes returns a function that accepts an \n\t// array of arguments, and calls the callback function\n\t// with each array element as a distinct parameter.\n\tstatic flatten(callback:any, context?:any) {\n\t\treturn function(argsArray:any[]) {\n\t\t\tcallback.apply(context, argsArray);\n\t\t}\n\t}\t\t\n}\n\ndocument.addEventListener('DOMContentLoaded', function() {\n\tconsole.log(`DOMContentLoaded - EBW`);\n\tnew EBW();\n});"],"names":["tslib_1.__extends","AddNewBookDialog","Template","LoginTokenList","TSFoundation.Reveal","FoundationRevealDialog","FileListDialog","FoundationRevealDialogEvents","PrintListenerTerminal","BoundFilename","EditorImage","RepoFileEditorCM","Dialog","FSFileList_File","RepoEditorPage_NewFileDialog","RepoEditorPage_RenameFileDialog","FileContent","File","CommitMessageDialog","MergeEditor","PullRequestDiffList_File","RepoFileViewerFile","RepoFileViewerPage"],"mappings":"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"}