{"version":3,"file":"ts.js","sources":["../../src/ts/APIWs.ts","../../src/ts/Context.ts","../../src/ts/Toast.ts","../../src/ts/Templates.ts","../../src/ts/querySelectorAll-extensions.ts","../../src/ts/Eventify.ts","../../src/ts/AddNewBookDialog.ts","../../src/ts/LoginTokenList.ts","../../src/ts/RepoMergeDirectButton.ts","../../src/ts/RepoDetailPage.ts","../../src/ts/ControlTag.ts","../../src/ts/FoundationRevealDialog.ts","../../src/ts/FileListDialog_Item.ts","../../src/ts/FileListDialog.ts","../../src/ts/PrintListener.ts","../../src/ts/BoundFilename.ts","../../src/ts/EditorCodeMirror.ts","../../src/ts/DOM.ts","../../src/ts/EditorImage.ts","../../src/ts/FS/FS.ts","../../src/ts/RepoFileEditorCM.ts","../../src/ts/FS/FSFileEdit.ts","../../src/ts/RepoEditorPage_NewFileDialog.ts","../../src/ts/RepoEditorPage_RenameFileDialog.ts","../../src/ts/FS/FSNotify.ts","../../src/ts/FS/FSOverlay.ts","../../src/ts/FS/FSRemote.ts","../../src/ts/FS/Store.ts","../../src/ts/FS/FSSession.ts","../../src/ts/FS/FSReadCache.ts","../../src/ts/FSFileList_File.ts","../../src/ts/FSFileList.ts","../../src/ts/FS/File.ts","../../src/ts/FS/Directory.ts","../../src/ts/FS/FSPrimeFromJS.ts","../../src/ts/RepoEditorPage.ts","../../src/ts/conflict/FileStatus.ts","../../src/ts/conflict/File.ts","../../src/ts/conflict/FileList.ts","../../src/ts/conflict/FileDisplay.ts","../../src/ts/conflict/FileListDisplay.ts","../../src/ts/conflict/MergeEditorControlBar.ts","../../src/ts/conflict/MergeEditor.ts","../../src/ts/conflict/MergeInstructions.ts","../../src/ts/CommitMessageDialog.ts","../../src/ts/conflict/ClosePRDialog.ts","../../src/ts/conflict/MergingInfo.ts","../../src/ts/conflict/SingleEditor.ts","../../src/ts/RepoConflictPage.ts","../../src/ts/MergeEditor.ts","../../src/ts/PRDiffModel.ts","../../src/ts/PullRequestDiffList_File.ts","../../src/ts/PullRequestMergePage.ts","../../src/ts/DOMInsert.ts","../../src/ts/RepoFileViewerFile.ts","../../src/ts/RepoFileViewerPage.ts","../../src/ts/EBW.ts"],"sourcesContent":["export class APIWs {\n\tprotected id: number;\n\tprotected url: string;\n\tprotected live:Map<number,[(...a:any[])=>void,(a:any)=>void]>;\n\tprotected queue: string[];\n\tprotected errorHandler: (a:any)=>void;\n\tprotected ws: WebSocket;\n\n\tconstructor(path:string=\"/rpc/API/json/ws\", server:string=\"\") {\n\t\tif (\"\"== server) {\n\t\t\tserver = \"ws\" +\n\t\t\t\t (\"https:\" == document.location.protocol ? \"s\" : \"\") +\n\t\t\t\t \"://\" +\n\t\t\t\t document.location.host\n\t\t}\n\t\tthis.id = 0;\n\t\tthis.url = server+path;\n\t\tthis.live = new Map<number,[(...a:any[])=>void,(a:any)=>void]>();\n\t\tthis.queue = new Array<string>();\n\t\tthis.setRPCErrorHandler(null);\n\t\tthis.startWs();\n\t}\t\n\tsetRPCErrorHandler(handler?:(a:any)=>void) :void {\n\t\tthis.errorHandler = handler;\n\t}\n\treject(reject:(a:any)=>void,err:Error):void {\n\t\tif (this.errorHandler) {\n\t\t\tthis.errorHandler(err);\n\t\t}\n\t\treject(err);\n\t\treturn;\n\t}\n\tstartWs():void {\n\t\tthis.ws = new WebSocket(this.url);\n\t\tthis.ws.onmessage = (evt)=> {\n\t\t\tlet res:any = JSON.parse(evt.data);\n\t\t\tif (undefined == res || undefined==res.id) {\n\t\t\t\tconsole.error(`Failed to parse response: ${evt.data}`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tlet id = res.id as number;\n\t\t\tlet promises = this.live.get(id);\n\t\t\tif (! promises) {\n\t\t\t\tconsole.error(`Failed to find promise for ${evt.data}`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.live.delete(id);\n\t\t\tlet [resolve,reject] = promises;\n\n\t\t\tif (res.error) {\n\t\t\t\tthis.reject(reject, res.error);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (res.result) {\n\t\t\t\tresolve(res.result);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresolve(undefined);\n\t\t};\n\t\tthis.ws.onerror = (err)=> {\n\t\t\tconsole.error(\"ERROR on websocket:\", err);\n\t\t};\n\t\tthis.ws.onopen = (evt)=> {\n\t\t\tconsole.log(\"Connected websocket\");\n\t\t\tfor (let q of this.queue) {\n\t\t\t\tthis.ws.send(q);\n\t\t\t}\n\t\t\tconsole.log(`Emptied queue of ${this.queue.length} queued messages`);\n\t\t\tthis.queue = [];\n\t\t};\n\t\tthis.ws.onclose = (evt)=> {\n\t\t\tconsole.log(\"Websocket closed - attempting reconnect in 1s\");\n\t\t\tsetTimeout( ()=> this.startWs(), 1000 );\n\t\t}\n\t}\n\trpc(method:string, params:any[]) {\n\t\tlet id = this.id++;\n\t\t// // params comes in as an 'arguments' object, so we need to convert\n\t\t// // it to an array\n\t\t// params = Array.prototype.slice.call(params);\n\t\t// // let p = [];\n\t\t// // for (let i=0; i<p.length; i++) {\n\t\t// // \tp[i] = params[i]\n\t\t// // }\n\n\t\tlet data = JSON.stringify({ id:id, method:method, params:params });\n\t\tthis.live.set(id, [undefined,undefined]);\n\t\treturn new Promise( (resolve:(...a:any[])=>void,reject:(a:any)=>void)=> {\n\t\t\tthis.live.set(id,[resolve,reject]);\n\t\t\tif (1==this.ws.readyState) {\n\t\t\t\tthis.ws.send(data);\n\t\t\t} else {\n\t\t\t\tthis.queue.push(data);\n\t\t\t}\n\t\t});\n\t}\n\n\t\n\tVersion () {\n\t\treturn this.rpc(\"Version\",  [] );\n\t}\n\t\n\tRenameFile (repoOwner:string,repoName:string,fromPath:string,toPath:string) {\n\t\treturn this.rpc(\"RenameFile\",  [repoOwner,repoName,fromPath,toPath] );\n\t}\n\t\n\tRemoveFile (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"RemoveFile\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tListFiles (repoOwner:string,repoName:string,pathregex:string) {\n\t\treturn this.rpc(\"ListFiles\",  [repoOwner,repoName,pathregex] );\n\t}\n\t\n\tFileExists (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"FileExists\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tListAllRepoFiles (repoOwner:string,repoName:string) {\n\t\treturn this.rpc(\"ListAllRepoFiles\",  [repoOwner,repoName] );\n\t}\n\t\n\tGetFile (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"GetFile\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tGetFileString (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"GetFileString\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tUpdateFile (repoOwner:string,repoName:string,path:string,content:string) {\n\t\treturn this.rpc(\"UpdateFile\",  [repoOwner,repoName,path,content] );\n\t}\n\t\n\tStageFile (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"StageFile\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tStageFileAndReturnMergingState (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"StageFileAndReturnMergingState\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tSaveWorkingFile (repoOwner:string,repoName:string,path:string,content:string) {\n\t\treturn this.rpc(\"SaveWorkingFile\",  [repoOwner,repoName,path,content] );\n\t}\n\t\n\tListPullRequests (repoOwner:string,repoName:string) {\n\t\treturn this.rpc(\"ListPullRequests\",  [repoOwner,repoName] );\n\t}\n\t\n\tPullRequestDiffList (repoOwner:string,repoName:string,prNumber:number) {\n\t\treturn this.rpc(\"PullRequestDiffList\",  [repoOwner,repoName,prNumber] );\n\t}\n\t\n\tPullRequestVersions (repoOwner:string,repoName:string,remoteUrl:string,remoteSha:string,filePath:string) {\n\t\treturn this.rpc(\"PullRequestVersions\",  [repoOwner,repoName,remoteUrl,remoteSha,filePath] );\n\t}\n\t\n\tPullRequestUpdate (repoOwner:string,repoName:string,remoteSHA:string,filePath:string,data:string) {\n\t\treturn this.rpc(\"PullRequestUpdate\",  [repoOwner,repoName,remoteSHA,filePath,data] );\n\t}\n\t\n\tCommit (repoOwner:string,repoName:string,message:string) {\n\t\treturn this.rpc(\"Commit\",  [repoOwner,repoName,message] );\n\t}\n\t\n\tCommitAll (repoOwner:string,repoName:string,message:string,notes:string) {\n\t\treturn this.rpc(\"CommitAll\",  [repoOwner,repoName,message,notes] );\n\t}\n\t\n\tCommitOnly (repoOwner:string,repoName:string,message:string,notes:string) {\n\t\treturn this.rpc(\"CommitOnly\",  [repoOwner,repoName,message,notes] );\n\t}\n\t\n\tPrintPdfEndpoint (repoOwner:string,repoName:string,book:string,format:string,fileList:string) {\n\t\treturn this.rpc(\"PrintPdfEndpoint\",  [repoOwner,repoName,book,format,fileList] );\n\t}\n\t\n\tMergedFileCat (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"MergedFileCat\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tMergedFileGit (repoOwner:string,repoName:string,path:string) {\n\t\treturn this.rpc(\"MergedFileGit\",  [repoOwner,repoName,path] );\n\t}\n\t\n\tSaveMergingFile (repoOwner:string,repoName:string,path:string,workingExists:boolean,workingContent:string,theirExists:boolean,theirContent:string) {\n\t\treturn this.rpc(\"SaveMergingFile\",  [repoOwner,repoName,path,workingExists,workingContent,theirExists,theirContent] );\n\t}\n\t\n\tMergeFileOriginal (repoOwner:string,repoName:string,path:string,version:string) {\n\t\treturn this.rpc(\"MergeFileOriginal\",  [repoOwner,repoName,path,version] );\n\t}\n\t\n\tFindFileLists (repoOwner:string,repoName:string) {\n\t\treturn this.rpc(\"FindFileLists\",  [repoOwner,repoName] );\n\t}\n\t\n\tSearchForFiles (repoOwner:string,repoName:string,fileRegex:string) {\n\t\treturn this.rpc(\"SearchForFiles\",  [repoOwner,repoName,fileRegex] );\n\t}\n\t\n\tUpdateFileBinary (repoOwner:string,repoName:string,path:string,contentB64:string) {\n\t\treturn this.rpc(\"UpdateFileBinary\",  [repoOwner,repoName,path,contentB64] );\n\t}\n\t\n}\n","import {API} from './API';\nimport {EBW} from './EBW';\n\n// Context is a general class passed through to most sub-classes that allows\n// us to track the repo- and user-specific things that are common to pretty\n// much all requests. In some senses, it's a bit like a global namespace,\n// just much better controlled because it's a class we defined and pass around,\n// and can therefore modify for children if that is appropriate at some point.\nexport class Context {\n\tconstructor(protected el: HTMLElement, public RepoOwner: string, public RepoName: string) {\n\t\t// I should probably also pass the EBW in the context,\n\t\t// but since _all_ of the EBW methods are static, it is\n\t\t// pretty unnecessary\n\t}\n\tAPI() : API {\n\t\treturn EBW.API();\n\t}\n\tEBW() : EBW {\n\t\treturn new EBW();\n\t}\n\tGetAttribute(key: string): string {\n\t\tif (this.el) {\n\t\t\treturn this.el.getAttribute(key);\n\t\t}\n\t\treturn ``;\n\t}\n\tRepoRedirect(path: string, args?: Map<string,any>) : void {\n\t\tlet params = \"\";\n\t\tif (args) {\n\t\t\tlet a : string[] = [];\n\t\t\targs.forEach( (v,k)=>{\n\t\t\t\tv = String(v).trim();\n\t\t\t\tif (v) {\n\t\t\t\t\ta.push(encodeURIComponent(k) + `=` + encodeURIComponent(v));\n\t\t\t\t}\n\t\t\t});\n\t\t\tif (0<a.length) {\n\t\t\t\tparams = \"?\" + a.join(\"&\");\n\t\t\t}\n\t\t}\n\t\tlet href =`/repo/${this.RepoOwner}/${this.RepoName}/${path}${params}`;\n\t\tdocument.location.href = href;\n\t}\n}","export class Toast {\n\tprotected static singleton? : Toast;\n\tprotected parent: HTMLElement;\n\tconstructor(el?:HTMLElement) {\n\t\tif (!Toast.singleton) {\n\t\t\tif (!el) {\n\t\t\t\tel = document.createElement(`div`);\n\t\t\t\tdocument.body.appendChild(el);\n\t\t\t}\n\t\t\tthis.parent = el;\n\t\t\tthis.parent.classList.add(`Toast`);\n\t\t\tToast.singleton = this;\n\t\t}\n\t\treturn Toast.singleton;\n\t}\n\tstatic Show(msg:string) {\n\t\tlet T = new Toast();\n\t\tlet div = document.createElement(`div`);\n\t\tdiv.innerHTML = msg;\n\t\tT.parent.appendChild(div);\n\t\tsetTimeout( function() {\n\t\t\tdiv.remove();\n\t\t},4500);\n\t\treturn div;\n\t}\n}\n","// dtemplate generated - do not edit\nexport namespace EL {\n\texport type AddNewBookDialog =\tHTMLDivElement;\n\texport type BoundFilename =\tHTMLDivElement;\n\texport type CommitMessageDialog =\tHTMLDivElement;\n\texport type EditorImage =\tHTMLDivElement;\n\texport type FSFileList_File =\tHTMLUListElement;\n\texport type FileListDialog =\tHTMLDivElement;\n\texport type FileListDialog_Item =\tHTMLUListElement;\n\texport type FoundationRevealDialog =\tHTMLDivElement;\n\texport type LoginTokenDisplay =\tHTMLUListElement;\n\texport type LoginTokenList =\tHTMLDivElement;\n\texport type MergeEditor =\tHTMLDivElement;\n\texport type PullRequestDiffList_File =\tHTMLDivElement;\n\texport type RepoEditorPage_NewFileDialog =\tHTMLDivElement;\n\texport type RepoEditorPage_RenameFileDialog =\tHTMLDivElement;\n\texport type RepoFileEditorCM =\tHTMLDivElement;\n\texport type RepoFileViewerFile =\tHTMLDivElement;\n\texport type RepoFileViewerPage =\tHTMLDivElement;\n\texport type RepoMergeDialog =\tHTMLDivElement;\n\texport type conflict_ClosePRDialog =\tHTMLDivElement;\n\texport type conflict_FileDisplay =\tHTMLLIElement;\n\texport type conflict_FileListDisplay =\tHTMLUListElement;\n\texport type conflict_MergeInstructions =\tHTMLDivElement;\n\t\n}\nexport namespace R {\n\texport interface AddNewBookDialog {\n\t\tchooseType: HTMLDivElement,\n\t\tnewBookRadio: HTMLInputElement,\n\t\tcollaborateRadio: HTMLInputElement,\n\t\tadaptationRadio: HTMLInputElement,\n\t\tnewBook: HTMLDivElement,\n\t\trepo_name: HTMLInputElement,\n\t\torg_name: HTMLInputElement,\n\t\tadaptation: HTMLDivElement,\n\t\tadaptation_repo_name: HTMLInputElement,\n\t\tadaptation_org_name: HTMLInputElement,\n\t\ttemplate: HTMLInputElement,\n\t\tcollaborate: HTMLDivElement,\n\t\tcollaborate_repo: HTMLInputElement,\n\t\t};\n\texport interface BoundFilename {\n\t\tfilename: HTMLSpanElement,\n\t\ta: HTMLAnchorElement,\n\t\t};\n\texport interface CommitMessageDialog {\n\t\ttitle: HTMLHeadingElement,\n\t\tinstructions: HTMLDivElement,\n\t\tmessage: HTMLInputElement,\n\t\tcommit: HTMLButtonElement,\n\t\t};\n\texport interface EditorImage {\n\t\t};\n\texport interface FSFileList_File {\n\t\tname: HTMLDivElement,\n\t\t};\n\texport interface FileListDialog {\n\t\tlist: HTMLUListElement,\n\t\t};\n\texport interface FileListDialog_Item {\n\t\tinput: HTMLInputElement,\n\t\ttitle: HTMLSpanElement,\n\t\t};\n\texport interface FoundationRevealDialog {\n\t\tcontent: HTMLDivElement,\n\t\t};\n\texport interface LoginTokenDisplay {\n\t\tlink: HTMLAnchorElement,\n\t\tdelete: HTMLAnchorElement,\n\t\t};\n\texport interface LoginTokenList {\n\t\tname: HTMLInputElement,\n\t\ttoken: HTMLInputElement,\n\t\tadd: HTMLButtonElement,\n\t\tlist: HTMLUListElement,\n\t\t};\n\texport interface MergeEditor {\n\t\tmergely: HTMLDivElement,\n\t\t};\n\texport interface PullRequestDiffList_File {\n\t\t};\n\texport interface RepoEditorPage_NewFileDialog {\n\t\tfilename: HTMLInputElement,\n\t\t};\n\texport interface RepoEditorPage_RenameFileDialog {\n\t\terror: HTMLDivElement,\n\t\tcurrent_name: HTMLSpanElement,\n\t\tfilename: HTMLInputElement,\n\t\t};\n\texport interface RepoFileEditorCM {\n\t\ttextEditor: HTMLDivElement,\n\t\timageEditor: HTMLDivElement,\n\t\t};\n\texport interface RepoFileViewerFile {\n\t\timg: HTMLImageElement,\n\t\tfilename: HTMLDivElement,\n\t\t};\n\texport interface RepoFileViewerPage {\n\t\tsearch: HTMLInputElement,\n\t\tdata: HTMLDivElement,\n\t\t};\n\texport interface RepoMergeDialog {\n\t\ttitle: HTMLHeadingElement,\n\t\tresolveOur: HTMLInputElement,\n\t\tresolveGit: HTMLInputElement,\n\t\tresolveTheir: HTMLInputElement,\n\t\tconflicted: HTMLInputElement,\n\t\tmergeButton: HTMLButtonElement,\n\t\t};\n\texport interface conflict_ClosePRDialog {\n\t\ttitle: HTMLHeadingElement,\n\t\tinstructions: HTMLDivElement,\n\t\tclosePR_no: HTMLInputElement,\n\t\tclosePR_yes: HTMLInputElement,\n\t\tcloseMessage: HTMLInputElement,\n\t\t};\n\texport interface conflict_FileDisplay {\n\t\tpath: HTMLSpanElement,\n\t\tstatus: HTMLSpanElement,\n\t\t};\n\texport interface conflict_FileListDisplay {\n\t\t};\n\texport interface conflict_MergeInstructions {\n\t\tshow: HTMLDivElement,\n\t\ttext: HTMLDivElement,\n\t\ttheirSide: HTMLSpanElement,\n\t\tourSide: HTMLSpanElement,\n\t\t};\n\t\n}\t// end namespace R\nexport class AddNewBookDialog {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.AddNewBookDialog;\n\tconstructor() {\n\t\tlet t = AddNewBookDialog._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div><div><h1>Add a project</h1><fieldset><label><input type=\"radio\" value=\"new\" name=\"new-project-type\"/>\n\t\t\t\tStart a new project.\n\t\t\t</label><label><input type=\"radio\" value=\"collaborate\" name=\"new-project-type\"/>\n\t\t\t\tCollaborate on an existing project.\n\t\t\t</label><label><input type=\"radio\" value=\"adaptation\" name=\"new-project-type\"/>\n\t\t\t\tCreate an adaptation of an existing project.\n\t\t\t</label></fieldset><button data-event=\"click:choseType\" class=\"btn\">Next</button></div><div><h1>New project</h1><form method=\"post\" action=\"/github/create/new\"><input type=\"hidden\" name=\"action\" value=\"new\"/><label>Enter the name for your new project. Use only letters and dashes; no spaces.\n\t\t<input type=\"text\" name=\"repo_new\" placeholder=\"e.g. MobyDick\"/>\n\t\t</label><label>Enter the organization this project should belong to, or leave this field\n\t\tblank if you will yourself be the owner of this project.\n\t\t<input type=\"text\" name=\"org_name\" placeholder=\"e.g. electricbookworks\"/>\n\t\t</label><input type=\"submit\" class=\"btn\" value=\"New project\"/></form></div><div><h1>Adaptation</h1><form method=\"post\" action=\"/github/create/new\"><input type=\"hidden\" name=\"action\" value=\"new\"/><label>Enter the name for your new project. Use only letters and dashes; no spaces.\n\t\t<input type=\"text\" name=\"repo_new\" placeholder=\"e.g. MobyDick\"/>\n\t\t</label><label>Enter the organization this project should belong to, or leave this field\n\t\tblank if you will yourself be the owner of this project.\n\t\t<input type=\"text\" name=\"org_name\" placeholder=\"e.g. electricbookworks\"/>\n\t\t</label><label>Enter the series that you will be adapting.\n\t\t<input type=\"text\" name=\"template\" placeholder=\"e.g. electricbookworks/electric-book\"/>\n\t\t</label><input type=\"submit\" class=\"btn\" value=\"New adaptation\"/></form></div><div><h1>Collaborate</h1><form method=\"post\" action=\"/github/create/fork\"><input type=\"hidden\" name=\"action\" value=\"fork\"/><label>Enter the GitHub owner and repo for the project you will collaborate on.\n\t\t<input type=\"text\" name=\"collaborate_repo\" placeholder=\"e.g. electricbooks/core\"/>\n\t\t</label><input type=\"submit\" class=\"btn\" value=\"Collaborate\"/></form></div></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tAddNewBookDialog._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\tchooseType: n.childNodes[0] as HTMLDivElement,\n\t\t\tnewBookRadio: n.childNodes[0].childNodes[1].childNodes[0].childNodes[0] as HTMLInputElement,\n\t\t\tcollaborateRadio: n.childNodes[0].childNodes[1].childNodes[1].childNodes[0] as HTMLInputElement,\n\t\t\tadaptationRadio: n.childNodes[0].childNodes[1].childNodes[2].childNodes[0] as HTMLInputElement,\n\t\t\tnewBook: n.childNodes[1] as HTMLDivElement,\n\t\t\trepo_name: n.childNodes[1].childNodes[1].childNodes[1].childNodes[1] as HTMLInputElement,\n\t\t\torg_name: n.childNodes[1].childNodes[1].childNodes[2].childNodes[1] as HTMLInputElement,\n\t\t\tadaptation: n.childNodes[2] as HTMLDivElement,\n\t\t\tadaptation_repo_name: n.childNodes[2].childNodes[1].childNodes[1].childNodes[1] as HTMLInputElement,\n\t\t\tadaptation_org_name: n.childNodes[2].childNodes[1].childNodes[2].childNodes[1] as HTMLInputElement,\n\t\t\ttemplate: n.childNodes[2].childNodes[1].childNodes[3].childNodes[1] as HTMLInputElement,\n\t\t\tcollaborate: n.childNodes[3] as HTMLDivElement,\n\t\t\tcollaborate_repo: n.childNodes[3].childNodes[1].childNodes[1].childNodes[1] as HTMLInputElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class BoundFilename {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.BoundFilename;\n\tconstructor() {\n\t\tlet t = BoundFilename._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div class=\"bound-filename\"><span>Select a file to edit</span><a href=\"#\" target=\"_github\"><img src=\"/img/github-dark.svg\"/></a></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tBoundFilename._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\tfilename: n.childNodes[0] as HTMLSpanElement,\n\t\t\ta: n.childNodes[1] as HTMLAnchorElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class CommitMessageDialog {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.CommitMessageDialog;\n\tconstructor() {\n\t\tlet t = CommitMessageDialog._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div><h1>Title</h1><div>Instructions</div><fieldset><label for=\"commitMessage\">Describe your changes\n\t\t<input type=\"text\" name=\"commitMessage\" id=\"commitMessage\"/>\n\t\t</label></fieldset><button class=\"btn\">Commit</button></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tCommitMessageDialog._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\ttitle: n.childNodes[0] as HTMLHeadingElement,\n\t\t\tinstructions: n.childNodes[1] as HTMLDivElement,\n\t\t\tmessage: n.childNodes[2].childNodes[0].childNodes[1] as HTMLInputElement,\n\t\t\tcommit: n.childNodes[3] as HTMLButtonElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class EditorImage {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.EditorImage;\n\tconstructor() {\n\t\tlet t = EditorImage._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div> </div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tEditorImage._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class FSFileList_File {\n\tpublic static _template : HTMLUListElement;\n\tpublic el : HTMLUListElement;\n\tpublic $ : R.FSFileList_File;\n\tconstructor() {\n\t\tlet t = FSFileList_File._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<ul><li data-set=\"this\" class=\"allfiles-file\"><div data-event=\"click:clickFile\">NAME\n\t\t</div></li></ul>`;\n\t\t\tt = d.firstElementChild.childNodes[0] as HTMLUListElement;\n\t\t\tFSFileList_File._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLUListElement;\n\t\tthis.$ = {\n\t\t\tname: n.childNodes[0] as HTMLDivElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class FileListDialog {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.FileListDialog;\n\tconstructor() {\n\t\tlet t = FileListDialog._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div><h1>Print Version</h1><p>Choose the project version you want to print:</p><ul class=\"file-list-dialog-list\">\n\t</ul></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tFileListDialog._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\tlist: n.childNodes[2] as HTMLUListElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class FileListDialog_Item {\n\tpublic static _template : HTMLUListElement;\n\tpublic el : HTMLUListElement;\n\tpublic $ : R.FileListDialog_Item;\n\tconstructor() {\n\t\tlet t = FileListDialog_Item._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<ul><li data-set=\"this\"><input type=\"radio\" name=\"file-list\"/><span/></li></ul>`;\n\t\t\tt = d.firstElementChild.childNodes[0] as HTMLUListElement;\n\t\t\tFileListDialog_Item._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLUListElement;\n\t\tthis.$ = {\n\t\t\tinput: n.childNodes[0] as HTMLInputElement,\n\t\t\ttitle: n.childNodes[1] as HTMLSpanElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class FoundationRevealDialog {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.FoundationRevealDialog;\n\tconstructor() {\n\t\tlet t = FoundationRevealDialog._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div class=\"reveal\" id=\"new-file-dialog\" data-reveal=\"\"><div class=\"content\">\n\t</div><button class=\"close-button\" aria-label=\"Close popup\" type=\"button\" data-close=\"\"><span aria-hidden=\"true\">×</span></button></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tFoundationRevealDialog._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\tcontent: n.childNodes[0] as HTMLDivElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class LoginTokenDisplay {\n\tpublic static _template : HTMLUListElement;\n\tpublic el : HTMLUListElement;\n\tpublic $ : R.LoginTokenDisplay;\n\tconstructor() {\n\t\tlet t = LoginTokenDisplay._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<ul><li data-set=\"this\" class=\"token-display\"><a href=\"\">LINK</a><a href=\"\">X</a></li></ul>`;\n\t\t\tt = d.firstElementChild.childNodes[0] as HTMLUListElement;\n\t\t\tLoginTokenDisplay._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLUListElement;\n\t\tthis.$ = {\n\t\t\tlink: n.childNodes[0] as HTMLAnchorElement,\n\t\t\tdelete: n.childNodes[1] as HTMLAnchorElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class LoginTokenList {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.LoginTokenList;\n\tconstructor() {\n\t\tlet t = LoginTokenList._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div class=\"login-token-list\"><div class=\"token-input\"><input type=\"text\" placeholder=\"name\"/><input type=\"text\" placeholder=\"token\"/><button class=\"btn\">Add</button></div><ul class=\"token-list\">\n\t</ul></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tLoginTokenList._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\tname: n.childNodes[0].childNodes[0] as HTMLInputElement,\n\t\t\ttoken: n.childNodes[0].childNodes[1] as HTMLInputElement,\n\t\t\tadd: n.childNodes[0].childNodes[2] as HTMLButtonElement,\n\t\t\tlist: n.childNodes[1] as HTMLUListElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class MergeEditor {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.MergeEditor;\n\tconstructor() {\n\t\tlet t = MergeEditor._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div class=\"merge-editor\"><div class=\"action-group\"><button data-event=\"click:save\" class=\"btn\">Save</button></div><div class=\"merge-mergely\">\n\t</div></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tMergeEditor._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\tmergely: n.childNodes[1] as HTMLDivElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class PullRequestDiffList_File {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.PullRequestDiffList_File;\n\tconstructor() {\n\t\tlet t = PullRequestDiffList_File._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div>\n</div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tPullRequestDiffList_File._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class RepoEditorPage_NewFileDialog {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.RepoEditorPage_NewFileDialog;\n\tconstructor() {\n\t\tlet t = RepoEditorPage_NewFileDialog._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div><fieldset><label>\n\t\t\tEnter the full path to your new file.\n\t\t\t<input type=\"text\" placeholder=\"book/text/chapter-7.md\" data-event=\"change\"/>\n\t\t</label></fieldset><button class=\"btn\" data-event=\"click\">Create File</button></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tRepoEditorPage_NewFileDialog._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\tfilename: n.childNodes[0].childNodes[0].childNodes[1] as HTMLInputElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class RepoEditorPage_RenameFileDialog {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.RepoEditorPage_RenameFileDialog;\n\tconstructor() {\n\t\tlet t = RepoEditorPage_RenameFileDialog._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div><div class=\"error\">\n\t</div><fieldset><div>Renaming <span> </span></div><label>\n\t\t\tEnter the full path to your new file.\n\t\t\t<input type=\"text\" placeholder=\"/book/text/chapter-7.md\" data-event=\"change\"/>\n\t\t</label></fieldset><button class=\"btn\" data-event=\"click\">Rename</button></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tRepoEditorPage_RenameFileDialog._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\terror: n.childNodes[0] as HTMLDivElement,\n\t\t\tcurrent_name: n.childNodes[1].childNodes[0].childNodes[1] as HTMLSpanElement,\n\t\t\tfilename: n.childNodes[1].childNodes[1].childNodes[1] as HTMLInputElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class RepoFileEditorCM {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.RepoFileEditorCM;\n\tconstructor() {\n\t\tlet t = RepoFileEditorCM._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div class=\"repo-file-editor-workspace\"><div class=\"repo-file-editor\">\n\t</div><div class=\"repo-image-editor\">\n\t</div></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tRepoFileEditorCM._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\ttextEditor: n.childNodes[0] as HTMLDivElement,\n\t\t\timageEditor: n.childNodes[1] as HTMLDivElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class RepoFileViewerFile {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.RepoFileViewerFile;\n\tconstructor() {\n\t\tlet t = RepoFileViewerFile._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div class=\"repo-file-viewer-file\"><div class=\"image\"><img/></div><div class=\"filename\"/></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tRepoFileViewerFile._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\timg: n.childNodes[0].childNodes[0] as HTMLImageElement,\n\t\t\tfilename: n.childNodes[1] as HTMLDivElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class RepoFileViewerPage {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.RepoFileViewerPage;\n\tconstructor() {\n\t\tlet t = RepoFileViewerPage._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div class=\"repo-file-viewer\"><div class=\"searchbar\"><input type=\"text\" placeholder=\"Enter search text to find images.\"/></div><div class=\"data\">\n\t</div></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tRepoFileViewerPage._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\tsearch: n.childNodes[0].childNodes[0] as HTMLInputElement,\n\t\t\tdata: n.childNodes[1] as HTMLDivElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class RepoMergeDialog {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.RepoMergeDialog;\n\tconstructor() {\n\t\tlet t = RepoMergeDialog._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div><h1>Updating a Repo</h1><p>How do you want to try this merge?</p><fieldset><label for=\"resolveOur\"><input type=\"radio\" name=\"resolve\" value=\"our\" id=\"resolveOur\"/>\n\t\t\tI will do the merge.\n\t\t</label><label for=\"resolveGit\"><input type=\"radio\" name=\"resolve\" value=\"git\" id=\"resolveGit\"/>\n\t\t\tGit can try to merge.\n\t\t</label><label for=\"resolveTheir\"><input type=\"radio\" name=\"resolve\" value=\"their\" id=\"resolveTheir\"/>\n\t\t\tChoose their files by preference.\n\t\t</label></fieldset><label for=\"conflicted\"><input type=\"checkbox\" name=\"conflicted\" value=\"only\" id=\"conflicted\"/>\n\t\t\tOnly apply above resolution to conflicted files.\n\t</label><button class=\"btn\" data-event=\"click:\">Do the Merge</button></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tRepoMergeDialog._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\ttitle: n.childNodes[0] as HTMLHeadingElement,\n\t\t\tresolveOur: n.childNodes[2].childNodes[0].childNodes[0] as HTMLInputElement,\n\t\t\tresolveGit: n.childNodes[2].childNodes[1].childNodes[0] as HTMLInputElement,\n\t\t\tresolveTheir: n.childNodes[2].childNodes[2].childNodes[0] as HTMLInputElement,\n\t\t\tconflicted: n.childNodes[3].childNodes[0] as HTMLInputElement,\n\t\t\tmergeButton: n.childNodes[4] as HTMLButtonElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class conflict_ClosePRDialog {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.conflict_ClosePRDialog;\n\tconstructor() {\n\t\tlet t = conflict_ClosePRDialog._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div><h1>Title</h1><div>Instructions</div><fieldset><label for=\"closePR-no\"><input type=\"radio\" name=\"closePR\" id=\"closePR-no\" value=\"no\" data-event=\"change\"/>No\n\t\t</label><label for=\"closePR-yes\"><input type=\"radio\" name=\"closePR\" id=\"closePR-yes\" value=\"yes\" data-event=\"change\"/>Yes\n\t\t</label><label for=\"closeMessage\">Close message\n\t\t<input type=\"text\" name=\"closeMessage\" id=\"closeMessage\"/>\n\t\t</label></fieldset><button class=\"btn\" data-event=\"click:done\">Done</button></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tconflict_ClosePRDialog._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\ttitle: n.childNodes[0] as HTMLHeadingElement,\n\t\t\tinstructions: n.childNodes[1] as HTMLDivElement,\n\t\t\tclosePR_no: n.childNodes[2].childNodes[0].childNodes[0] as HTMLInputElement,\n\t\t\tclosePR_yes: n.childNodes[2].childNodes[1].childNodes[0] as HTMLInputElement,\n\t\t\tcloseMessage: n.childNodes[2].childNodes[2].childNodes[1] as HTMLInputElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class conflict_FileDisplay {\n\tpublic static _template : HTMLLIElement;\n\tpublic el : HTMLLIElement;\n\tpublic $ : R.conflict_FileDisplay;\n\tconstructor() {\n\t\tlet t = conflict_FileDisplay._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<li class=\"file-display\"><span class=\"path\"> </span><span class=\"status\"> </span></li>`;\n\t\t\tt = d.firstElementChild as HTMLLIElement;\n\t\t\tconflict_FileDisplay._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLLIElement;\n\t\tthis.$ = {\n\t\t\tpath: n.childNodes[0] as HTMLSpanElement,\n\t\t\tstatus: n.childNodes[1] as HTMLSpanElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class conflict_FileListDisplay {\n\tpublic static _template : HTMLUListElement;\n\tpublic el : HTMLUListElement;\n\tpublic $ : R.conflict_FileListDisplay;\n\tconstructor() {\n\t\tlet t = conflict_FileListDisplay._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<ul class=\"conflict-file-list-display\">\n</ul>`;\n\t\t\tt = d.firstElementChild as HTMLUListElement;\n\t\t\tconflict_FileListDisplay._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLUListElement;\n\t\tthis.$ = {\n\t\t};\n\t\tthis.el = n;\n\t}\n}\nexport class conflict_MergeInstructions {\n\tpublic static _template : HTMLDivElement;\n\tpublic el : HTMLDivElement;\n\tpublic $ : R.conflict_MergeInstructions;\n\tconstructor() {\n\t\tlet t = conflict_MergeInstructions._template;\n\t\tif (! t ) {\n\t\t\tlet d = document.createElement('div');\n\t\t\td.innerHTML = `<div class=\"merge-instructions\"><div class=\"instructions-button\">?</div><div class=\"instructions-text\"><h1>Working with the merge editor</h1><p>The file being submitted is displayed in the editor on the <span class=\"editor-side\">THEIRSIDE</span> side.</p><p>The final file you will save is displayed in the editor on the <span class=\"editor-side\">OURSIDE</span> side.</p><p>Use the small buttons to the left of lines to transfer changes between sides.</p><p>When you are satisfied with your changes, press 'Save these changes' to save your changes.</p><p>When you have resolved all the issues between all the files, press 'Resolve this merge' to resolve the conflicted state.</p></div></div>`;\n\t\t\tt = d.firstElementChild as HTMLDivElement;\n\t\t\tconflict_MergeInstructions._template = t;\n\t\t}\n\t\tlet n = t.cloneNode(true) as HTMLDivElement;\n\t\tthis.$ = {\n\t\t\tshow: n.childNodes[0] as HTMLDivElement,\n\t\t\ttext: n.childNodes[1] as HTMLDivElement,\n\t\t\ttheirSide: n.childNodes[1].childNodes[1].childNodes[1] as HTMLSpanElement,\n\t\t\tourSide: n.childNodes[1].childNodes[2].childNodes[1] as HTMLSpanElement,\n\t\t};\n\t\tthis.el = n;\n\t}\n}\n\n","export function QuerySelectorAllIterate(el:HTMLElement, query:string) : HTMLElement[] {\n\tlet els :HTMLElement[] = [];\n\tif ('function'==typeof el.matches) {\n\t\tif (el.matches(query)) {\n\t\t\tels.push(el);\n\t\t}\n\t} else if ('function'==typeof (el as any).matchesSelector) {\n\t\tif ((el as any).matchesSelector(query)) {\n\t\t\tels.push(el as HTMLElement);\n\t\t}\n\t}\n\tlet childSelector = el.querySelectorAll(query);\n\tfor (let i=0; i<childSelector.length; i++) {\n\t\tels.push(childSelector.item(i) as HTMLElement);\n\t}\n\treturn els;\n}\t\n\n","import {QuerySelectorAllIterate} from './querySelectorAll-extensions';\n\n/**\n * Eventify adds eventListeners to the given object\n * for each node in the given element and it's sub-elements\n * that has an attribute of the form:\n * data-event=\"event:method,event:method,...\"\n * When the named event occurs on the element, the named\n * method will be called on the object.\n */\nexport function Eventify (el:HTMLElement, methods:any) {\n\n\tfor (let e of QuerySelectorAllIterate(el, `[data-event]`)) {\n\t\tlet evtList = e.getAttribute(`data-event`)\n\t\tfor (let p of evtList.split(`,`)) {\n\t\t\tlet [event, method] = p.split(':');\n\t\t\tif (!method) {\n\t\t\t\tmethod=event;\n\t\t\t}\n\t\t\tif (undefined == methods[method]) {\n\t\t\t\tconsole.error(`No method ${method} (from ${p}) defined on `, methods, \n\t\t\t\t\t` while eventifying `, e);\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\te.addEventListener(event, function(evt) {\n\t\t\t\tmethods[method](evt);\n\t\t\t});\n\t\t}\n\t}\n}","import { AddNewBookDialog as Template } from './Templates';\nimport { Eventify } from './Eventify';\nimport $ = require('jquery');\n\n// AddNewBookDialog steps the user through two pages\n// determining what sort of new book they want to create,\n// and where the original of that book should be found:\n// ie copy the ebw electricbook template, or fork an existing\n// book.\nexport class AddNewBookDialog extends Template {\n\tconstructor(parent:HTMLElement) {\n\t\tsuper();\n\t\tEventify(this.el, {\n\t\t\t'choseType': ()=>{\n\t\t\t\tlet newBook = this.$.newBookRadio.checked;\n\t\t\t\tlet collaborate = this.$.collaborateRadio.checked;\n\t\t\t\tlet adaptation = this.$.adaptationRadio.checked;\n\t\t\t\tif (!newBook && !collaborate && !adaptation) {\n\t\t\t\t\talert(`You need to choose one or the other`);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (newBook) {\n\t\t\t\t\tthis.$.newBook.style.display = 'block';\n\t\t\t\t\tthis.$.repo_name.focus();\n\t\t\t\t} else if (collaborate) {\n\t\t\t\t\tthis.$.collaborate.style.display = 'block';\n\t\t\t\t\tthis.$.collaborate_repo.focus();\n\t\t\t\t} else {\n\t\t\t\t\tthis.$.adaptation.style.display = 'block';\n\t\t\t\t\tthis.$.adaptation_repo_name.focus();\n\t\t\t\t}\n\t\t\t\tthis.$.chooseType.style.display = 'none';\n\t\t\t}\n\t\t});\n\n\t\t$(parent).bind(`open.zf.reveal`, (evt)=>{\n\t\t\tthis.$.chooseType.style.display = 'block';\n\t\t\tthis.$.newBookRadio.checked = false;\n\t\t\tthis.$.collaborateRadio.checked = false;\n\t\t\tthis.$.adaptationRadio.checked = false;\n\n\t\t\tthis.$.newBook.style.display = 'none';\n\t\t\tthis.$.repo_name.value = '';\n\n\t\t\tthis.$.collaborate.style.display = 'none';\n\t\t\tthis.$.collaborate_repo.value = '';\n\n\t\t\tthis.$.adaptation.style.display = 'none';\n\t\t\tthis.$.adaptation_repo_name.value = '';\n\t\t});\n\n\t\tparent.appendChild(this.el);\n\t}\n\tstatic instantiate() {\n\t\tlet list = document.querySelectorAll(`[data-instance='AddNewBookDialog']`);\n\t\tfor (let i=0; i<list.length; i++) {\n\t\t\tlet el = list.item(i) as HTMLElement;\n\t\t\t// console.log(`qsa.forEach(`, el, `)`);\n\t\t\tnew AddNewBookDialog(el);\n\t\t}\n\t}\n}\n\n","import {LoginTokenList as Template, LoginTokenDisplay} from './Templates';\n\ninterface Token {\n\tname:string;\n\ttoken:string;\n}\n\nclass TokenDisplay extends LoginTokenDisplay {\n\tconstructor(parent:HTMLElement, protected t:Token, protected list:LoginTokenList) {\n\t\tsuper();\n\n\t\tthis.$.link.href = `/github/token/${this.t.token}`;\n\t\tthis.$.link.innerText = this.t.name;\n\n\t\tthis.$.delete.addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault();\n\t\t\tthis.el.remove();\n\t\t\tthis.list.RemoveToken(this.t);\n\t\t})\n\t\tparent.appendChild(this.el);\n\t}\n\tstatic removeToken(name:string) {\n\t\tlet d = document.getElementById(`token-list-item-` + t.name);\n\t\tif (d) {\n\t\t\td.remove();\n\t\t}\n\t}\n}\n\nexport class LoginTokenList extends Template {\n\tconstructor(parent:HTMLElement) {\n\t\tsuper();\n\n\t\tthis.GetTokens().map( (t)=>{\n\t\t\tnew TokenDisplay(this.$.list, t, this);\n\t\t});\n\n\t\tthis.$.add.addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault();\n\t\t\tlet name = this.$.name.value;\n\t\t\tlet token = this.$.token.value;\n\t\t\tif (``==name) {\n\t\t\t\talert(`You need to provide a name for the new token`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (``==token) {\n\t\t\t\talert(`You need to provide a token value`);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.AddToken({name:name,token:token});\n\t\t\tthis.$.name.value = ``;\n\t\t\tthis.$.token.value = ``;\n\t\t});\n\t\tparent.appendChild(this.el);\n\t}\n\tGetTokens() : Token[] {\n\t\tlet js = localStorage.getItem(`ebw-token-list`);\n\t\tif (!js) {\n\t\t\treturn [];\n\t\t}\n\t\tlet t = JSON.parse(js) as Token[];\n\t\treturn t;\n\t}\n\tAddToken(t:Token):void {\n\t\tlet tokens = this.GetTokens();\n\t\ttokens.push(t);\n\t\tlocalStorage.setItem(`ebw-token-list`, JSON.stringify(tokens));\n\t\tnew TokenDisplay(this.$.list, t, this);\n\t}\n\tRemoveToken(t:Token):void {\n\t\tlet tokens = this.GetTokens();\n\t\tlet newt = [] as Token[];\n\t\tfor (let ot of tokens) {\n\t\t\tif ((ot.name != t.name) || (ot.token!=t.token)) {\n\t\t\t\tnewt.push(ot);\n\t\t\t}\n\t\t}\n\t\tlocalStorage.setItem(`ebw-token-list`, JSON.stringify(newt));\n\t}\n\tstatic init() {\n\t\tconsole.log(`seeking LoginTokenList`); \n\t\tlet nodes = document.querySelectorAll(`[data-instance=\"LoginTokenList\"]`);\n\t\tfor (let i=0; i<nodes.length; i++) {\n\t\t\tlet l = nodes.item(i) as HTMLElement;\n\t\t\tnew LoginTokenList(l);\n\t\t}\n\t}\n}\n","import {Context} from './Context';\n\nexport class RepoMergeDirectButton {\n\tconstructor(protected context:Context, protected el:HTMLElement) {\n\t\tlet href = `/repo/${context.RepoOwner}/` +\n\t\t\t\t`${context.RepoName}/merge/` + \n\t\t\t\tel.getAttribute('data-repo-merge');\n\t\tconsole.log(`RepoMergeDirectButton: onclick for `, el , `  = `, href);\n\t\tel.addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\tdocument.location.href = `/repo/${context.RepoOwner}/` +\n\t\t\t\t`${context.RepoName}/merge/` + \n\t\t\t\tel.getAttribute('data-repo-merge') ;\n\t\t});\n\t\tel.classList.add(`btn`);\n\t}\n\n\tstatic init(context:Context) {\n\t\tlet els = document.querySelectorAll(`[data-instance=\"RepoMergeButton\"]`);\n\t\tfor(let i=0; i<els.length; i++) {\n\t\t\tnew RepoMergeDirectButton(context, els.item(i) as HTMLElement);\n\t\t}\n\t}\n}","import {Context} from './Context';\nimport {EBW} from './EBW';\nimport {RepoMergeDirectButton} from './RepoMergeDirectButton';\nimport {RepoMergeDialog} from './RepoMergeDialog';\n\nexport class RepoDetailPage {\n\tconstructor(protected context:Context) {\n\t\tRepoMergeDirectButton.init(this.context);\n\n\t\tlet el = document.getElementById(`cancelAllChanges`);\n\t\tif (el) {\n\t\t\tel.addEventListener(`click`, (evt)=>{\n\t\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\t\tEBW.Confirm(`All your changes will be lost. This is non-recoverable. Continue?`)\n\t\t\t\t.then( (b:boolean)=>{\n\t\t\t\t\tif (b) {\n\t\t\t\t\t\tdocument.location.href = `/repo/${context.RepoOwner}/${context.RepoName}/conflict/abort`;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\t\t// let dialog = new RepoMergeDialog(context, undefined);\n\t\t// RepoMergeButton.init(this.context, dialog);\n\t\t// dialog.MergeEvent.add(this.mergeEvent, this);\n\t}\n\t// mergeEvent(dialog:RepoMergeDialog) : void {\n\t// \tlet resolve = dialog.GetResolve();\n\t// \tlet conflicted = dialog.GetConflicted();\n\t// \tlet context = dialog.GetContext();\n\t// \tdocument.location.href = `/repo/${context.RepoOwner}/${context.RepoName}/merge/${dialog.GetRepoRemote()}` +\n\t// \t\t`?resolve=${resolve}&conflicted=${conflicted}`;\n\t// }\n}\n","// A ControlTag controls the appearance of another div, most likely changing\n// it's width or making it appear / disappear\nexport class ControlTag {\n\tconstructor(protected el: HTMLElement, protected callback:(showing:boolean)=>void) {\n\t\tthis.el.addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\tthis.el.classList.toggle(`showing`);\n\t\t\tthis.callback(this.el.classList.contains(`showing`));\n\t\t})\n\t}\n}","/// <reference path=\"./typescript-foundation.d.ts\" />\nimport * as TSFoundation from 'TSFoundation';\nimport {FoundationRevealDialog as Template} from './Templates';\n\nimport jQuery = require('jquery');\nimport signals = require('signals');\n\nexport enum DialogEvents {\n\tOpened = 1,\n\tClosed\n}\n\n/**\n * FoundationRevealDialog is a class that implements\n * a Foundation Reveal dialog. It has a public 'Events' \n * signals.Signal that receives 'opened' and 'closed'\n * events when the respective action happens on the dialog.\n */\nexport class FoundationRevealDialog extends Template {\n\tprotected $el : any;\n\tpublic Events: signals.Signal;\n\n\tconstructor(\n\t\topenElement?:HTMLElement,\n\t\tcontent?:HTMLElement\n\t) {\n\t\tsuper();\n\t\tthis.Events = new signals.Signal();\n\t\tthis.$el = jQuery(this.el);\n\n\t\tif (openElement) {\n\t\t\topenElement.addEventListener('click', (evt)=>{\n\t\t\t\tevt.preventDefault();\n\t\t\t\tevt.stopPropagation();\n\t\t\t\tthis.$el.foundation('open');\n\t\t\t});\n\t\t}\n\t\tthis.$el.bind('open.zf.reveal', (evt:any)=>{\n\t\t\tthis.Events.dispatch(DialogEvents.Opened);\n\t\t});\n\t\tthis.$el.bind('closed.zf.reveal', (evt:any)=>{\n\t\t\tthis.Events.dispatch(DialogEvents.Closed);\n\t\t});\n\t\tif (content) {\n\t\t\tthis.Set(content);\n\t\t}\n\n\t\t// The el must be inserted into the DOM before Foundation is\n\t\t// called on it, otherwise Foundation doesn't properly position\n\t\t// the dialog.\n\t\tdocument.body.appendChild(this.el);\n\t\t// TSFoundation required because Typescript can be really stupid.\n\t\tTSFoundation.Reveal(this.$el);\n\t}\n\t// Set the content of the dialog to the given\n\t// element.\n\tpublic Set(el: HTMLElement):void {\n\t\tthis.$.content.innerText = '';\n\t\tthis.$.content.appendChild(el);\n\t}\n\tpublic Open(): void {\n\t\tthis.$el.foundation('open');\n\t}\n\tpublic Close(): void {\n\t\tthis.$el.foundation('close');\n\t}\n}","import {FileListDialog_Item as Template} from './Templates';\nimport {FileListDialog} from './FileListDialog';\n\nexport class FileListDialogItem extends Template {\n\tconstructor(protected path:string, protected dialog:FileListDialog) {\n\t\tsuper();\n\t\tthis.$.title.textContent = path;\n\t\tthis.$.input.addEventListener('click', (evt)=>{\n\t\t\tevt.preventDefault();\n\t\t\tevt.stopPropagation();\n\t\t\tthis.dialog.Close(this.path);\n\t\t})\n\t}\n\tisSet() {\n\t\treturn (this.$.input.checked);\n\t}\n}","import {DialogEvents as FoundationRevealDialogEvents, FoundationRevealDialog} from './FoundationRevealDialog';\nimport {FileListDialog as Template} from './Templates';\nimport {FileListDialogItem} from './FileListDialog_Item';\nimport {Eventify} from './Eventify';\n\nexport class FileListDialogResult {\n\tFileList?: string;\n\tCancelled: boolean;\n}\n\nexport class FileListDialog extends Template {\n\tprotected resolve: (m:FileListDialogResult)=>void;\n\tprotected dialog: FoundationRevealDialog;\n\tprotected items: Array<FileListDialogItem>;\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis.dialog = new FoundationRevealDialog(undefined, this.el);\n\t\tthis.dialog.Events.add( this.dialogEvent, this );\n\t}\n\n\tClose(filePath:string) {\n\t\tthis.resolve({\n\t\t\tFileList: filePath,\n\t\t\tCancelled: false});\n\t\tthis.resolve = undefined;\n\t\tthis.dialog.Close();\n\t}\n\n\tdialogEvent(evt:FoundationRevealDialogEvents) {\n\t\tswitch (evt) { \n\t\t\tcase FoundationRevealDialogEvents.Closed:\n\t\t\t\t// If the commit button was pressed, we have resolved\n\t\t\t\t// the promise, and have cleared this.resolve\n\t\t\t\tif (this.resolve) {\n\t\t\t\t\tthis.resolve({Cancelled:true});\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\tcase FoundationRevealDialogEvents.Opened:\n\t\t\t\treturn;\n\t\t};\n\t}\n\n\t// Open returns a Promise that will return a string[]. The string[]\n\t// will either contain two elements: \n\tOpen(fileList:string[]) : Promise<FileListDialogResult> {\n\t\tthis.$.list.innerText = ``;\n\t\tthis.items = [];\n\t\tfor (let f of fileList) {\n\t\t\tlet i = new FileListDialogItem(f, this);\n\t\t\tthis.$.list.appendChild(i.el);\n\t\t\tthis.items.push(i);\n\t\t}\n\n\t\treturn new Promise<FileListDialogResult>(\n\t\t\t(resolve,reject)=>{\n\t\t\t\tthis.resolve = resolve;\n\t\t\t\tthis.dialog.Open();\n\t\t\t});\n\t}\n}","import {EBW} from './EBW';\nimport {FileListDialog, FileListDialogResult} from './FileListDialog';\nimport EventSource = require('./sse');\n\nexport class PrintListener {\n\tprotected listDialog: FileListDialog;\n\n\tconstructor(protected repoOwner:string, \n\t\tprotected repoName:string, \n\t\tprotected book:string=`book`,\n\t\tprotected format:string=`print`) {\n\t\tthis.listDialog = new FileListDialog();\n\n\t\tif (``==this.book) {\n\t\t\tthis.book = `book`;\n\t\t}\n\t\tif ((`print`!=format) && (`screen`!=format)) {\n\t\t\tEBW.Error(`PrintListener format parameter must be either 'print' or 'screen'`);\n\t\t\treturn;\n\t\t}\n\t\tEBW.API().FindFileLists(repoOwner, repoName).then(\n\t\t\t([files]:[string[]])=>{\n\t\t\t\t// console.log(`Files directories are `, files);\n\t\t\t\t// debugger;\n\t\t\t\t// files.push(files[0]);\n\t\t\t\tif (2>files.length) {\n\t\t\t\t\treturn Promise.resolve<string>(0==files.length ? `` : files[0]);\n\t\t\t\t}\n\t\t\t\treturn this.listDialog.Open(files)\n\t\t\t\t\t.then(\n\t\t\t\t\t\t(res:FileListDialogResult)=>{\n\t\t\t\t\t\t\tif (res.Cancelled) {\n\t\t\t\t\t\t\t\treturn Promise.resolve<string>(undefined);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn Promise.resolve<string>(res.FileList);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t}).then(\n\t\t\t(filedir?:string)=>{\n\t\t\t\tif ('undefined'==typeof filedir) {\n\t\t\t\t\treturn Promise.resolve<[any]>([undefined]);\n\t\t\t\t}\n\t\t\t\treturn EBW.API().PrintPdfEndpoint(repoOwner, repoName, book, format, filedir);\n\t\t\t}).then(\n\t\t\t([url]:[string])=>{\n\t\t\t\tif ('undefined'==typeof url) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.startListener(url);\n\t\t\t}).catch( EBW.Error );\n\t}\n\tstartListener(key:string) {\n\t\tlet url = document.location.protocol +\n\t\t\t\t \"//\" +\n\t\t\t\t document.location.host + \"/print/sse/\" + key;\n\t\tlet sse = new EventSource(url);\n\t\tsse.addEventListener(`open`, function() {\n\t\t});\n\t\tsse.addEventListener('tick', function(e:any) {\n\t\t\tconsole.log(`tick received: `, e);\n\t\t});\n\t\tsse.addEventListener(`info`, function(e:any) {\n\t\t\t// console.log(`INFO on printListener: `, e.data);\n\t\t\tlet data = JSON.parse(e.data);\n\t\t\tEBW.Toast(`Printing: `, e.data);\n\t\t});\n\t\tsse.addEventListener(`error`, function(e:any) {\n\t\t\tlet err = JSON.parse(e.data);\n\t\t\tEBW.Error(err);\n\t\t\tsse.close();\n\t\t});\n\t\tsse.addEventListener(`output`, (e:any)=> {\n\t\t\tlet data = JSON.parse(e.data);\n\t\t\tlet url = document.location.protocol +\n\t\t\t\t \"//\" +\n\t\t\t\t document.location.host + \n\t\t\t\t `/www/${this.repoOwner}/${this.repoName}/${data}`;\n\t\t\tEBW.Toast(`Your PDF is ready: opening in a new window.`);\n\t\t\twindow.open(url, `${this.repoOwner}-${this.repoName}-pdf`);\n\t\t});\n\t\tsse.addEventListener(`done`, function(e:any) {\n\t\t\tsse.close();\n\t\t});\n\t\tsse.onmessage = (e:any)=>{\n\t\t\tthis.onmessage(e);\n\t\t}\n\t\tsse.onerror = EBW.Error;\n\n\t}\n\tonmessage(e:any) {\n\t\tconsole.log(`PrintListener.onmessage: `, e);\n\t}\n}\n","import {BoundFilename as Template} from './Templates';\n\nexport class BoundFilename extends Template {\n\tconstructor(protected repoOwner:string, protected repoName:string, protected parent:HTMLElement, editorElement: HTMLElement) {\n\t\tsuper();\n\t\tif (!editorElement) {\n\t\t\teditorElement = document.body as HTMLElement;\n\t\t}\n\t\teditorElement.addEventListener('BoundFileChanged', (evt:CustomEvent)=>{\n\t\t\tthis.$.filename.innerText = evt.detail;\n\t\t\tthis.$.a.href = `https://github.com/${this.repoOwner}/${this.repoName}/commits/master/${evt.detail}`;\n\t\t});\n\t\tthis.parent.appendChild(this.el);\n\t\tconsole.log(`BoundFilename: `, this, this.el);\n\t}\n\tstatic SetFilename(name:string):void {\n\t\tlet evt = new CustomEvent(`BoundFileChanged`, {\"detail\":name});\n\t\tdocument.body.dispatchEvent(evt);\n\t}\n\tstatic BindAll(repoOwner:string, repoName:string) : void {\n\t\tlet els = document.querySelectorAll(`[ebw-bind=\"current-filename\"]`);\n\t\tfor (let i = 0; i<els.length; i++) {\n\t\t\tnew BoundFilename(repoOwner, repoName, els.item(i) as HTMLElement, null);\n\t\t}\n\t}\n}","import CodeMirror = require('codemirror');// from 'codemirror';\n\nexport class EditorCodeMirror {\n\tprotected cm : any;\n\tconstructor(parent:HTMLElement) {\n\t\tthis.cm = CodeMirror(parent, {\n\t\t\t'mode': 'markdown',\n\t\t\t'lineNumbers':true,\n\t\t\t'lineWrapping': true\n\t\t});\n\t}\n\tstatic Template() : string {\n\t\treturn 'RepoFileEditor_codemirror';\n\t}\n\tgetValue() : string {\n\t\treturn this.cm.getDoc().getValue();\n\t}\n\tsetValue(s:string) : void {\n\t\tthis.cm.getDoc().setValue(s);\n\t\tthis.cm.refresh();\n\t}\n\tgetHistory() : string {\n\t\treturn JSON.stringify(this.cm.getHistory());\n\t}\n\tsetHistory(hist?:string) : void {\n\t\tif (hist) {\n\t\t\tthis.cm.setHistory(JSON.parse(hist));\n\t\t} else {\n\t\t\tthis.cm.clearHistory();\n\t\t}\n\t}\n\n\t/**\n\t * focus sets the input focus to the editor\n\t */\n\tfocus() : void {\n\t\tthis.cm.focus();\n\t}\n\n\t/**\n\t * setModeOnFilename sets the editor mode / highlighting\n\t * based on the filename of the file you're editing.\n\t */\n\tsetModeOnFilename(filename:string) {\n\t\tlet r = /\\.([^\\.]+)$/;\n\t\tlet res = r.exec(filename);\n\t\tif (2==res.length) {\n\t\t\tlet suffix = res[1];\n\t\t\tlet modes = new Map<string,string>();\n\t\t\tmodes.set('md','markdown');\n\t\t\tmodes.set('js','javascript');\n\t\t\tmodes.set('css','css');\n\t\t\tmodes.set('scss','sass');\n\t\t\tmodes.set('sass','sass');\n\t\t\tmodes.set('yaml','yaml');\n\t\t\tmodes.set('yml','yaml');\n\t\t\tmodes.set('xml','xml');\n\n\t\t\tlet mode = modes.get(res[1]);\n\t\t\tif (mode) {\n\t\t\t\tthis.cm.setOption(`mode`, mode);\n\t\t\t}\n\t\t}\n\t}\n}","export function AddToParent(parent:((el:HTMLElement)=>void)|HTMLElement|undefined, el: HTMLElement) {\n\tif (!parent) {\n\t\treturn;\n\t}\n\tif ('function'==typeof parent) {\n\t\tparent(el);\n\t\treturn;\n\t}\n\tparent.appendChild(el);\n}","import {EditorImage as Template} from './Templates';\nimport {FSFileEdit} from './FS/FSFileEdit';\nimport {AddToParent} from './DOM';\n\nimport signals = require('signals');\n\nexport class EditorImage extends Template {\n\tprotected file: FSFileEdit;\n\tconstructor(\n\t\tprotected parent: HTMLElement, \n\t\tprotected repoOwner: string,\n\t\tprotected repoName: string\n\t\t) {\n\t\tsuper();\n\t\tAddToParent(parent, this.el);\n\t}\n\tsetFile(f:FSFileEdit) {\n\t\tthis.file = f;\n\t\tlet L = document.location;\n\t\tlet imageUrl = `url('/www/` + \n\t\t\t`${this.repoOwner}/${this.repoName}/${f.Name()}')`;\n\t\tthis.el.style.backgroundImage = imageUrl;\n\t}\n}","/**\n * FileStat provides information on the status of a file\n * in a given filesystem.\n */\nexport enum FileStat {\n\t/** The file exists an is unchanged */\n\tExists = 1,\n\t/** The file exists, and has changed */\n\tChanged = 2,\n\t/** The file is a new file */\n\tNew = 3,\n\t/** The file is deleted / marked for deletion */\n\tDeleted = 4,\n\t/** The file does not exist */\n\tNotExist = 5\n};\n\nexport function FileStatString(fs:FileStat) : string {\n\tswitch(fs) {\n\t\tcase FileStat.Exists:\n\t\t\treturn \"Exists\";\n\t\tcase FileStat.Changed:\n\t\t\treturn \"Changed\";\n\t\tcase FileStat.New:\n\t\t\treturn \"New\";\n\t\tcase FileStat.Deleted:\n\t\t\treturn \"Deleted\";\n\t\tcase FileStat.NotExist:\n\t\t\treturn \"NotExist\";\n\t}\n\tdebugger;\n\treturn \"-- ERROR : undefined FileStat ---\";\n}\n\nexport class FileContent {\n\tconstructor(\n\t\tpublic readonly Name:string, \n\t\tpublic readonly Stat:FileStat, \n\t\tpublic readonly Content?:string,\n\t\tpublic Original?: FileContent) {\n\t}\n\tIsContentKnown(): boolean {\n\t\treturn (undefined!=typeof this.Content);\n\t}\n\tSerialize() : string {\n\t\treturn JSON.stringify(this);\n\t}\n\tstatic FromJS(json:string) {\n\t\tlet js = JSON.parse(json);\n\t\treturn new FileContent(js.Name, js.Stat, js.Content);\n\t}\n\tOriginalName() : string {\n\t\tif (this.Original) {\n\t\t\treturn this.Original.OriginalName();\n\t\t}\n\t\treturn this.Name;\n\t}\n};\n\n\n/**\n * FS is the interface implemented by all filesystems.\n */\nexport interface FS {\n\t/**\n\t * Read returns the FileContent of the file, which \n\t * may, or may not, know the file's content. Hence some\n\t * cache FS's might know of a file's existence, but not \n\t * have the content in-cache.\n\t */\n\tRead(path:string) : Promise<FileContent>;\n\t/**\n\t * Remove removes / deletes the file. The Stat of the file\n\t * post Remove depends on the FS. Some FS's, such as\n\t * FSRemote, will report FileStat.NotExist after Remove,\n\t * while others, such as FSSession or FSOverlay, might\n\t * report FileStat.Deleted, indicating that the file is known\n\t * to be deleted, but that this 'deletion' hasn't yet been\n\t * synced to the underlying FS.\n\t *\n\t * Remove takes an option FileStat parameter which is the\n\t * suggested stat for the file post removal. This allows\n\t * an aggregating filesystem to use a caching filesystem\n\t * with a suggestion about how the caching filesystem\n\t * should handle the Removal : eg. NotExist or Deleted.\n\t */\n\tRemove(path:string,stat?:FileStat):Promise<FileContent>;\n\t/** \n\t * Rename renames a file, and returns the FileContent for\n\t * the renamed file.\n\t */\n\tRename(fromPath:string,toPath:string):Promise<[FileContent,FileContent]>;\n\t/**\n\t * Returns the RepoOwner and RepoName's provided for the\n\t * filesystem.\n\t */\n\tRepoOwnerName():[string,string];\n\t/**\n\t * Revert is only supported on some filesystems, and \n\t * reverts the file's content to the underlying filesystem\n\t * content, discarding unsaved local changes.\n\t */\n\tRevert(path:string): Promise<FileContent>;\n\t/**\n\t * Stat returns the stat of the given file.\n\t */\n\tStat(path:string) : Promise<FileStat>;\n\t/** \n\t * Sync is only supported on some filesystems, and \n\t * synchronizes a caching filesystem with an underlying\n\t * filesystem.\n\t */\n\tSync(path?:string):Promise<FileContent[]>;\n\t/** \n\t * Write writes the file. If the content parameter is\n\t * not provided, the existence of the file is marked with some\n\t * FS's, but its content isn't recorded.\n\t */\n\tWrite(path:string, stat:FileStat, content?:string):Promise<FileContent>;\n\t/**\n\t * IsDirty reports whether the given file path is \n\t * dirty. Some file systems don't support Dirty, since they\n\t * are entirely commit-based, while others, such as FSOverlay,\n\t * permit a sense of a Dirty file.\n\t */\n\tIsDirty(path:string):Promise<boolean>;\n}\n","import {BoundFilename} from './BoundFilename';\nimport {Eventify} from './Eventify';\nimport {RepoFileEditorCM as Template} from './Templates';\nimport {EditorCodeMirror} from './EditorCodeMirror';\nimport {EditorImage} from './EditorImage';\nimport {EBW} from './EBW';\nimport {FileContent, FileStat, FileStatString} from './FS/FS';\nimport {FSFileEdit} from './FS/FSFileEdit';\n\nimport signals = require('signals');\n\ninterface RepoFileEditorCallbacks {\n\tRename: ()=>void;\n}\n\nenum EditorEvents {\n\tSAVED = 1,\n\tCHANGED = 2,\n\tLOADED = 3\n}\n\nclass repoEditorActionBar {\n\tprotected saveButton: HTMLButtonElement;\n\tprotected undoButton: HTMLButtonElement;\n\tprotected deleteButton: HTMLButtonElement;\n\tprotected renameButton: HTMLButtonElement;\n\n\tconstructor(protected editor:RepoFileEditorCM) {\n\t\tthis.saveButton = document.getElementById(`editor-save-button`) as HTMLButtonElement;\n\t\tthis.saveButton.addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault();\n\t\t\tthis.editor.saveEditorFile();\n\t\t});\n\t\tthis.undoButton = document.getElementById(`editor-undo-button`) as HTMLButtonElement;\n\t\tthis.undoButton.addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault();\n\t\t\tthis.editor.undoEditorFile();\n\t\t});\n\t\tthis.deleteButton = document.getElementById(`editor-delete-button`) as HTMLButtonElement;\n\t\tthis.deleteButton.addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault();\n\t\t\tthis.editor.deleteEditorFile();\n\t\t});\n\t\tthis.renameButton = document.getElementById(`editor-rename-button`) as HTMLButtonElement;\n\t\tthis.editor.EditEvents.add(this.EditEvents, this);\n\t}\n\tEditEvents(ev:EditorEvents, file:FSFileEdit) : void {\n\t\tif (!file) {\n\t\t\tthis.deleteButton.disabled = true;\n\t\t\tthis.deleteButton.innerText = 'Delete';\n\t\t\tthis.saveButton.disabled = true;\n\t\t\tthis.undoButton.disabled = true;\n\t\t\tthis.renameButton.disabled = true;\n\t\t\treturn;\n\t\t}\n\t\tthis.deleteButton.disabled = false;\n\t\tthis.saveButton.disabled = false;\n\t\tthis.undoButton.disabled = false;\n\t\tthis.renameButton.disabled = false;\n\t\t//console.log(`repoEditorActionBar: file = `, file.FileContent() ? FileStatString(file.FileContent().Stat) : \"\", file );\n\t\tthis.deleteButton.innerText = (file.IsDeleted()) ? \"Undelete\": \"Delete\";\n\t}\n\n}\n\n/**\n * RepoFileEditorCM is a file editor that wraps what was meant to be\n * a generic editor, but in actual fact turns out to have some\n * dependencies upon CodeMirror, and hence isn't entirely generic.\n */\nexport class RepoFileEditorCM extends Template {\n\tprotected textEditor : EditorCodeMirror;\n\tprotected imageEditor: EditorImage;\n\tprotected file: FSFileEdit;\n\tprotected undoKey: string;\n\tpublic EditEvents: signals.Signal;\n\n\tconstructor(\n\t\trepoOwner: string,\n\t\trepoName: string,\n\t\tprotected parent:HTMLElement,\n\t\tprotected callbacks: RepoFileEditorCallbacks\n\t\t) {\n\t\tsuper();\n\t\tthis.undoKey = `RepoFileEditorCM:UndoHistory:${encodeURIComponent(repoOwner)}:${encodeURIComponent(repoName)}:`;\n\t\tthis.EditEvents = new signals.Signal();\n\t\tnew repoEditorActionBar(this);\n\t\tthis.EditEvents.dispatch(EditorEvents.LOADED, undefined);\n\n\t\tthis.textEditor = new EditorCodeMirror(this.$.textEditor);\n\t\tthis.imageEditor = new EditorImage(this.$.imageEditor, repoOwner, repoName);\n\t\tthis.parent.appendChild(this.el);\n\t\tBoundFilename.BindAll(repoOwner, repoName);\n\t}\n\n\tundoEditorFile() {\n\t\tEBW.Confirm(`Undo the changes you've just made to ${this.file.Name()}?`)\n\t\t.then(\n\t\t\t(b:boolean)=>{\n\t\t\t\tif (!b) return;\n\t\t\t\tthis.file.Revert()\n\t\t\t\t.then(\n\t\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\t\tthis.file.SetFileContent(fc);\n\t\t\t\t\t\tthis.textEditor.setValue(fc.Content);\n\t\t\t\t\t\tthis.EditEvents.dispatch(EditorEvents.CHANGED, this.file);\n\t\t\t\t\t});\n\t\t\t});\t\t\n\t}\n\n\t/**\n\t * deleteEditorFile handles file deleting and undeleting.\n\t */\n\tdeleteEditorFile() {\n\t\tif (!this.file) {\n\t\t\tEBW.Alert(`Please choose a file before using delete/undelete`);\n\t\t\treturn;\n\t\t}\n\t\tif (this.file.IsDeleted()) {\n\t\t\tthis.file.Save(this.textEditor.getValue(), FileStat.Changed)\n\t\t\t.then(\n\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\tif (fc.Stat!=FileStat.NotExist) {\n\t\t\t\t\t\tthis.file.SetFileContent(fc);\n\t\t\t\t\t\tthis.EditEvents.dispatch(EditorEvents.CHANGED, this.file);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.file = undefined;\n\t\t\t\t\t\tthis.setFile(undefined);\n\t\t\t\t\t\tthis.EditEvents.dispatch(EditorEvents.LOADED, undefined);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\treturn;\n\t\t}\n\t\tEBW.Confirm(`Are you sure you want to delete ${this.file.Name()}?`)\n\t\t.then(\n\t\t\t()=>{\n\t\t\t\treturn this.file.Remove()\n\t\t\t\t.then( (fc:FileContent)=> {\n\t\t\t\t\tif (fc.Stat == FileStat.NotExist) {\n\t\t\t\t\t\tthis.file = undefined;\n\t\t\t\t\t\tthis.setFile(undefined);\t\n\t\t\t\t\t\tthis.EditEvents.dispatch(EditorEvents.LOADED, undefined);\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.file.SetFileContent(fc);\n\t\t\t\t\t\tthis.EditEvents.dispatch(EditorEvents.CHANGED, this.file);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t})\n\t\t.catch( EBW.Error );\n\t}\n\n\tsaveEditorFile() {\n\t\tthis.file.Save(this.textEditor.getValue())\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tconsole.log(`About to Sync ${this.file.Name()}`);\n\t\t\t\treturn this.file.Sync();\t\t\t\t\n\t\t\t})\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tif (fc.Stat == FileStat.NotExist) {\n\t\t\t\t\tEBW.Toast(`${this.file.Name()} removed`);\n\t\t\t\t\t// By presetting file to undefined, we ensure that\n\t\t\t\t\t// setFile doesn't save the file again\n\t\t\t\t\tthis.file = undefined;\n\t\t\t\t\tthis.setFile(undefined);\t\n\t\t\t\t\tthis.EditEvents.dispatch(EditorEvents.LOADED, undefined);\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t} else {\n\t\t\t\t\tthis.file.SetFileContent(fc);\n\t\t\t\t\tthis.EditEvents.dispatch(EditorEvents.CHANGED, this.file);\n\t\t\t\t\tEBW.Toast(`${this.file.Name()} saved.`);\n\t\t\t\t}\n\t\t\t})\n\t\t.catch(\n\t\t\t(err:any)=>{\n\t\t\t\tconsole.error(err);\n\t\t\t\tEBW.Error(err)\n\t\t\t});\t\t\n\t}\n\tsetText(text:string){\n\t\tif ('string'!=typeof text) {\n\t\t\tdebugger;\n\t\t}\n\t\tthis.textEditor.setValue(text);\n\t}\n\t/**\n\t * saveHistoryFor saves the history for the given path\n\t */\n\tprotected saveHistoryFor(path:string) {\n\t\tlet key = this.undoKey + path;\n\t\tsessionStorage.setItem(key, this.textEditor.getHistory());\n\t}\n\t/**\n\t * restoreHistoryFor restores the history for the given\n\t * path\n\t */\n\tprotected restoreHistoryFor(path:string) {\n\t\tlet key  =this.undoKey + path;\n\t\tthis.textEditor.setHistory(sessionStorage.getItem(key));\n\t}\n\n\tsetFile(file:FSFileEdit) {\n\t\tif (this.file) {\n\t\t\tif (this.file.Name()==file.Name()) {\n\t\t\t\t// Cannot set to the file we're currently editing\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.file.Save(this.textEditor.getValue());\n\t\t\tthis.file.SetEditing(false);\n\t\t\tthis.saveHistoryFor(this.file.Name());\n\t\t}\n\t\tif ('undefined'==typeof file) {\n\t\t\tthis.file = undefined;\n\t\t\tthis.setText('Please select a file to edit.');\n\t\t\tthis.setBoundFilenames();\n\t\t\tthis.EditEvents.dispatch(EditorEvents.LOADED, undefined);\n\t\t\treturn;\n\t\t}\n\t\tlet imgRegexp = new RegExp(`.*\\.(jpg|png|tiff|svg|gif)$`);\n\t\tif (imgRegexp.test(file.Name())) {\n\t\t\tthis.imageEditor.setFile(file);\n\t\t\tthis.showImageEditor();\n\t\t\tthis.file = undefined;\n\t\t\tthis.EditEvents.dispatch(EditorEvents.LOADED, undefined);\n\t\t\treturn;\n\t\t}\n\t\tthis.showTextEditor();\n\n\t\tfile.GetText()\n\t\t.then(\n\t\t\t(t:string)=>{\n\t\t\t\tthis.file = file;\n\t\t\t\tthis.file.SetEditing(true);\n\t\t\t\tthis.setBoundFilenames();\n\t\t\t\tthis.setText(t);\n\t\t\t\tthis.restoreHistoryFor(this.file.Name());\n\t\t\t\tthis.textEditor.setModeOnFilename(file.Name());\n\t\t\t\tthis.textEditor.focus();\n\t\t\t\tthis.EditEvents.dispatch(EditorEvents.CHANGED, this.file);\n\t\t\t})\n\t\t.catch(\n\t\t\t(err:any)=>{\n\t\t\t\tEBW.Error(err);\n\t\t\t});\n\t}\n\tFile() : FSFileEdit {\n\t\treturn this.file;\n\t}\n\tRename(name:string) : Promise<void> {\n\t\treturn this.file.Rename(name)\n\t\t.then( ()=>{\n\t\t\tconsole.log(`Rename is concluded: this.file = `, this.file);\n\t\t\tBoundFilename.SetFilename(name);\n\t\t\treturn Promise.resolve();\n\t\t});\n\t}\n\tprotected setBoundFilenames() {\n\t\tlet filename = 'CHOOSE A FILE';\n\t\tif (this.file) {\n\t\t\tfilename = this.file.Name();\n\t\t}\n\t\tBoundFilename.SetFilename(filename);\n\t}\n\n\tprotected showImageEditor() {\n\t\tthis.$.textEditor.style.display='none';\n\t\tthis.$.imageEditor.style.display='block';\n\t}\n\tprotected showTextEditor() {\n\t\tthis.$.textEditor.style.display='block';\n\t\tthis.$.imageEditor.style.display='none';\n\t}\n}\n","import {EBW} from '../EBW';\nimport {FS,FileStat,FileContent} from './FS';\n\nimport signals = require('signals');\n\n/**\n * FSFileEdit is a wrapper around a file that is being\n * edited.\n */\nexport class FSFileEdit {\n\tpublic DirtySignal: signals.Signal;\n\tpublic EditingSignal : signals.Signal;\n\tprotected editing: boolean;\n\n\tconstructor(\n\t\tprotected fc:FileContent,\n\t\tprotected FS:FS) \n\t{\n\t\tthis.DirtySignal = new signals.Signal();\n\t\tthis.EditingSignal = new signals.Signal();\n\t}\n\tSetFileContent(fc:FileContent):void {\n\t\tthis.fc = fc;\n\t}\n\tFileContent() : FileContent {\n\t\treturn this.fc;\n\t}\n\tRevert():Promise<FileContent> {\n\t\treturn this.FS.Revert(this.fc.Name)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.fc = fc;\n\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t});\n\t}\n\tRename(toPath:string):Promise<[FileContent,FileContent]> {\n\t\tlet oldName = this.fc.Name;\n\t\treturn this.FS.Rename(this.fc.Name,toPath)\n\t\t.then(\n\t\t\t([fOld, fNew]:[FileContent,FileContent])=>{\n\t\t\t\tthis.FS.Sync(oldName);\n\t\t\t\tthis.fc = fNew;\n\t\t\t\tthis.Sync();\n\t\t\t\t// this.signalDirty();\n\t\t\t\treturn Promise.resolve<[FileContent,FileContent]>([fOld, fNew]);\n\t\t\t});\n\t}\n\tRemove(): Promise<FileContent> {\n\t\treturn this.FS.Remove(this.fc.Name)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.fc = fc;\n\t\t\t\tthis.signalDirty();\n\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t});\n\t}\n\tName() : string {\n\t\treturn this.fc.Name;\n\t}\n\tSetEditing(editing: boolean):void {\n\t\tthis.editing = editing;\n\t\tthis.EditingSignal.dispatch(this, editing);\n\t}\n\tIsDeleted():boolean {\n\t\treturn this.fc.Stat == FileStat.Deleted;\n\t}\n\tIsEditing():boolean {\n\t\treturn this.editing;\n\t}\n\tIsDirty():Promise<boolean> {\n\t\treturn this.FS.IsDirty(this.fc.Name);\n\t}\n\tprotected signalDirty() {\n\t\tthis.IsDirty().then(\n\t\t\t(dirty:boolean)=>{\n\t\t\t\tthis.DirtySignal.dispatch(this, dirty);\n\t\t\t})\n\t}\n\tSave(t:string, fs?:FileStat):Promise<FileContent> {\n\t\t// If FileStat is Changed, or Deleted, we want to keep \n\t\t// that stat.\n\t\tif (!fs) {\n\t\t\tfs = this.fc.Stat;\n\t\t\tif (fs==FileStat.New || fs==FileStat.Exists || fs==FileStat.NotExist) {\n\t\t\t\tfs = FileStat.Changed;\n\t\t\t}\n\t\t}\n\t\treturn this.FS.Write(this.fc.Name, fs, t)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.fc = fc;\n\t\t\t\tthis.signalDirty();\n\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t});\n\t}\n\n\tSync():Promise<FileContent> {\n\t\treturn this.FS.Sync(this.fc.Name)\n\t\t.then(\n\t\t\t(fcs:FileContent[])=>{\n\t\t\t\tlet fc = fcs[0];\n\t\t\t\tthis.fc = fc;\n\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t});\t\t\t\t\n\t}\n\tGetText():Promise<string> {\n\t\tif (this.fc.Content) {\n\t\t\treturn Promise.resolve<string>(this.fc.Content);\n\t\t}\n\t\treturn this.FS.Read(this.fc.Name)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tconsole.log(`FSFileEdit.FS.Read returned `, fc);\n\t\t\t\tthis.fc = fc;\n\t\t\t\treturn Promise.resolve<string>(fc.Content);\n\t\t\t});\n\t}\n}","import {EBW} from './EBW';\nimport {Eventify} from './Eventify';\nimport {RepoEditorPage_NewFileDialog as Template} from './Templates';\nimport {RepoFileEditorCM} from './RepoFileEditorCM';\nimport {DialogEvents, FoundationRevealDialog as Dialog} from './FoundationRevealDialog';\nimport {FS,FileStat,FileContent} from './FS/FS';\nimport {FSFileEdit} from './FS/FSFileEdit';\n\nimport jQuery = require('jquery');\n\n/**\n * RepoEditorPage_NewFileDialog displays a new file\n * dialog on the RepoPageEditor page.\n *\n */\nexport class RepoEditorPage_NewFileDialog extends Template {\n\tprotected $el : any;\n\tprotected dialog: Dialog;\n\tprotected repoOwner: string;\n\tprotected repoName: string;\n\tconstructor(\n\t\topenElement:HTMLElement, \n\t\tprotected FS:FS,\n\t\tprotected editor: RepoFileEditorCM,\n\t) {\n\t\tsuper();\n\t\t[this.repoOwner, this.repoName] = this.FS.RepoOwnerName();\n\t\tdocument.body.appendChild(this.el);\n\t\tthis.$el = jQuery(this.el);\n\t\tEventify(this.el, {\n\t\t\t\"click\": (evt:any)=>{\n\t\t\t\tlet filename = this.$.filename.value;\n\t\t\t\tthis.FS.Stat(filename)\n\t\t\t\t.then(\n\t\t\t\t\t(fs:FileStat)=>{\n\t\t\t\t\t\tif (!(fs==FileStat.NotExist || fs==FileStat.Deleted)) {\n\t\t\t\t\t\t\tEBW.Alert(`A file named ${filename} already exists`);\n\t\t\t\t\t\t\treturn;\t\t\t\t\t\t\t\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.FS.Write(filename, FileStat.New, ``)\n\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\t\t\t\tthis.dialog.Close();\n\t\t\t\t\t\t\t\tlet edit = new FSFileEdit(fc, FS);\n\t\t\t\t\t\t\t\tthis.editor.setFile(edit);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t},\n\t\t\t\"change\": (evt:any)=>{\n\n\t\t\t}\n\t\t});\n\n\t\tthis.dialog = new Dialog(openElement, this.el);\n\t\tthis.dialog.Events.add( (act:DialogEvents)=>{\n\t\t\tswitch (act) {\n\t\t\t\tcase DialogEvents.Opened:\n\t\t\t\t\tthis.$.filename.value = '';\n\t\t\t\t\tthis.$.filename.focus();\n\t\t\t\t\tbreak;\n\t\t\t\tcase DialogEvents.Closed:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t}\n}","import {EBW} from './EBW';\nimport {Eventify} from './Eventify';\nimport {DialogEvents, FoundationRevealDialog as Dialog} from './FoundationRevealDialog';\nimport {RepoEditorPage_RenameFileDialog as Template} from './Templates';\nimport {RepoFileEditorCM} from './RepoFileEditorCM';\nimport {FS,FileContent, FileStat} from './FS/FS';\nimport {FSFileEdit} from './FS/FSFileEdit';\n\nimport jQuery = require('jquery');\n\n/**\n * RepoEditorPage_RenameFileDialog displays a Rename file\n * dialog on the RepoPageEditor page.\n */\nexport class RepoEditorPage_RenameFileDialog extends Template {\n\tprotected $el : any;\n\tprotected dialog : Dialog;\n\tprotected repoOwner: string;\n\tprotected repoName: string;\n\tconstructor(\n\t\topenElement:HTMLElement, \n\t\tprotected FS: FS,\n\t\tprotected editor: RepoFileEditorCM\n\t) {\n\t\tsuper();\n\t\t[this.repoOwner, this.repoName] = this.FS.RepoOwnerName();\n\t\tEventify(this.el, {\n\t\t\t\"click\": (evt:any)=>{\n\t\t\t\tlet toName = this.$.filename.value;\n\t\t\t\tthis.editor.Rename(toName)\n\t\t\t\t.then(\n\t\t\t\t\t()=>{\n\t\t\t\t\t\tthis.dialog.Close();\n\t\t\t\t\t})\n\t\t\t\t.catch(EBW.Error);\n\t\t\t},\n\t\t\t\"change\": (evt:any)=>{\n\n\t\t\t}\n\t\t});\n\t\tthis.dialog = new Dialog(openElement, this.el);\n\t\tthis.dialog.Events.add( (act:DialogEvents)=>{\n\t\t\tswitch (act) {\n\t\t\t\tcase DialogEvents.Opened:\n\t\t\t\t\tthis.$.filename.value = this.editor.File().Name();\n\t\t\t\t\tthis.$.filename.focus();\n\t\t\t\t\tthis.$.current_name.innerText = this.editor.File().Name();\n\t\t\t\t\tbreak;\n\t\t\t\tcase DialogEvents.Closed:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\t}\n}","import {FS, FileContent, FileStat} from './FS';\n\nimport signals = require('signals');\n\n/**\n * FSNotify implements a FS that passes all actual\n * functions through to an underlying FS, but that\n * notifies listeners of activities on the FS.\n */\nexport class FSNotify {\n\tpublic Listeners : signals.Signal;\n\n\tconstructor(protected source:FS) {\n\t\tthis.Listeners = new signals.Signal();\n\t}\n\tWrite(path:string, stat:FileStat, content?:string):Promise<FileContent> {\n\t\treturn this.source.Write(path,stat,content)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.Listeners.dispatch(path, fc);\n\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t});\n\t}\n\tRemove(path:string,stat?:FileStat):Promise<FileContent> {\n\t\treturn this.source.Remove(path,stat)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.Listeners.dispatch(path, fc);\n\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t});\n\t}\n\tRename(fromPath:string,toPath:string) : Promise<[FileContent,FileContent]> {\n\t\treturn this.source.Rename(fromPath, toPath)\n\t\t.then(\n\t\t\t([fOld, fNew]:[FileContent,FileContent])=>{\n\t\t\t\tthis.Listeners.dispatch(fromPath, fOld);\n\t\t\t\tthis.Listeners.dispatch(toPath, fNew);\n\t\t\t\treturn Promise.resolve<[FileContent,FileContent]>([fOld,fNew]);\n\t\t\t});\n\t}\n\tRevert(path:string): Promise<FileContent> {\n\t\treturn this.source.Revert(path)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.Listeners.dispatch(path, fc);\n\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t});\n\t}\n\tSync(path?:string):Promise<FileContent[]> { \n\t\treturn this.source.Sync(path)\n\t\t.then(\n\t\t\t(fcs:FileContent[])=>{\n\t\t\t\tfor (let fc of fcs) {\n\t\t\t\t\tthis.Listeners.dispatch(fc.Name, fc);\n\t\t\t\t}\n\t\t\t\treturn Promise.resolve<FileContent[]>(fcs);\n\t\t\t});\n\t}\n\t//=============================================================\n\t//======= all methods below this point simply pass their calls\n\t//======= to the underlying FS, and don't require notification.\n\t//=============================================================\n\tRepoOwnerName():[string,string] { return this.source.RepoOwnerName(); }\t\n\tStat(path:string) : Promise<FileStat> { return this.source.Stat(path); }\n\tRead(path:string) : Promise<FileContent> { return this.source.Read(path); }\n\tIsDirty(path:string):Promise<boolean> { return this.source.IsDirty(path); }\n}","import {FS,FileStat,FileContent} from './FS';\n\nexport class FSOverlay {\n\tprotected changes : Set<string>;\n\tconstructor(protected below:FS, protected above:FS) {\n\t\tthis.changes = new Set<string>();\n\t}\n\n\tIsDirty(path:string) : Promise<boolean> {\n\t\treturn this.above.Stat(path)\n\t\t.then(\n\t\t\t(aboveStat:FileStat)=>{\n\t\t\t\tif (aboveStat==FileStat.Exists || aboveStat==FileStat.NotExist) {\n\t\t\t\t\treturn Promise.resolve<boolean>(false);\n\t\t\t\t}\n\t\t\t\tif (aboveStat==FileStat.New) {\n\t\t\t\t\treturn Promise.resolve<boolean>(true);\n\t\t\t\t}\n\t\t\t\treturn this.below.Stat(path)\n\t\t\t\t.then(\n\t\t\t\t\t(belowStat)=>{\n\t\t\t\t\t\tswitch(belowStat) {\n\t\t\t\t\t\t\tcase FileStat.NotExist:\n\t\t\t\t\t\t\t//fallthrough\n\t\t\t\t\t\t\tcase FileStat.Changed:\n\t\t\t\t\t\t\t//fallthrough\n\t\t\t\t\t\t\tcase FileStat.New:\n\t\t\t\t\t\t\t//fallthrough\n\t\t\t\t\t\t\tcase FileStat.NotExist:\n\t\t\t\t\t\t\t\treturn Promise.resolve<boolean>(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn Promise.all([this.above.Read(path), this.below.Read(path)])\n\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\t(fcs:FileContent[])=>{\n\t\t\t\t\t\t\t\tlet [aboveC, belowC] = fcs;\n\t\t\t\t\t\t\t\t// console.log(`FSOverlay.IsDirty(${path}): aboveC =`);\n\t\t\t\t\t\t\t\t// console.log(aboveC);\n\t\t\t\t\t\t\t\t// console.log(`belowC = `);\n\t\t\t\t\t\t\t\t// console.log(belowC);\n\t\t\t\t\t\t\t\t// console.log(`Resolving aboveC.Content!=belowC.Content = `,\n\t\t\t\t\t\t\t\t\t// aboveC.Content != belowC.Content);\n\t\t\t\t\t\t\t\tif (!aboveC.Content) {\n\t\t\t\t\t\t\t\t\treturn Promise.resolve<boolean>(false);\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\treturn Promise.resolve<boolean>(aboveC.Content!=belowC.Content);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t});\n\t}\n\n\tRepoOwnerName():[string,string] {\n\t\treturn this.below.RepoOwnerName();\n\t}\n\n\tStat(path:string): Promise<FileStat> {\n\t\treturn this.above.Stat(path)\n\t\t\t.then( \n\t\t\t\t(s:FileStat)=>{\n\t\t\t\t\tif (FileStat.NotExist==s) {\n\t\t\t\t\t\treturn this.below.Stat(path);\n\t\t\t\t\t}\n\t\t\t\t\treturn Promise.resolve<FileStat>(s);\n\t\t\t\t});\n\t}\n\n\tRead(path:string) : Promise<FileContent> {\n\t\treturn this.above.Stat(path)\n\t\t.then(\n\t\t\t(s:FileStat)=>{\n\t\t\t\tswitch (s) {\n\t\t\t\t\tcase FileStat.Exists:\n\t\t\t\t\t\treturn this.readAndCachePath(path);\n\t\t\t\t\tcase FileStat.Changed:\n\t\t\t\t\t\t//fallthrough\n\t\t\t\t\tcase FileStat.New:\n\t\t\t\t\t\t//fallthrough\n\t\t\t\t\tcase FileStat.Deleted:\n\t\t\t\t\t\treturn this.above.Read(path);\t\t\t\t\t\n\t\t\t\t\tcase FileStat.NotExist:\n\t\t\t\t\t\treturn this.below.Read(path)\n\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\t(c)=>{\n\t\t\t\t\t\t\t\tthis.above.Write(path, c.Stat, c.Content);\n\t\t\t\t\t\t\t\treturn Promise.resolve<FileContent>(c);\n\t\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t}\n\tprotected readAndCachePath(path:string) : Promise<FileContent> {\n\t\treturn this.above.Read(path)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tif (fc.Content) {\n\t\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t\t}\n\t\t\t\treturn this.below.Read(path)\n\t\t\t\t.then(\n\t\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\t\treturn this.above.Write(path, fc.Stat, fc.Content);\n\t\t\t\t\t});\n\t\t\t});\t\t\n\t}\n\n\tWrite(path:string, stat:FileStat, content?: string): Promise<FileContent> {\n\t\treturn this.above.Write(path, stat, content)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\t// console.log(`FSOverlay.Write(${path}): stat = ${stat}`);\n\t\t\t\tif (!(fc.Stat==FileStat.Exists || fc.Stat==FileStat.NotExist)) {\n\t\t\t\t\tthis.changes.add(path);\n\t\t\t\t}\n\t\t\t\treturn Promise.resolve<FileContent>(fc)\n\t\t\t});\n\t}\n\n\tRemove(path:string, stat?:FileStat) : Promise<FileContent> {\n\t\treturn this.above.Remove(path,stat)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.changes.add(path);\n\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t}\n\t\t);\n\t}\n\n\tRename(fromPath:string, toPath:string) : Promise<[FileContent,FileContent]> {\n\t\treturn this.above.Rename(fromPath, toPath)\n\t\t.then(\n\t\t\t([fOld,fNew]:[FileContent,FileContent])=>{\n\t\t\t\tconsole.log(`FSOverlay.Rename.then : fOld, fNew = `, fOld, fNew);\n\t\t\t\tthis.changes.add(fromPath);\n\t\t\t\tthis.changes.add(toPath);\n\t\t\t\treturn Promise.resolve<[FileContent,FileContent]>([fOld,fNew]);\n\t\t\t});\n\t}\n\n\tRevert(path:string) : Promise<FileContent> {\n\t\t// @TODO NEED TO CONSIDER THE ISSUES AROUND REVERTING\n\t\t// VIA ORIGINALNAME...\n\t\treturn this.above.Read(path)\n\t\t.then(\n\t\t\t(c:FileContent)=>{\n\t\t\t\treturn this.below.Read(c.OriginalName());\n\t\t\t})\n\t\t.then(\n\t\t\t(c:FileContent)=>{\n\t\t\t\treturn this.above.Write(path, c.Stat, c.Content)\n\t\t\t})\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\t// We're reverted path, so it's not longer\n\t\t\t\t// changed.\n\t\t\t\tthis.changes.delete(path);\n\t\t\t\treturn this.above.Read(path);\n\t\t\t});\n\t}\n\tSync(path?:string) : Promise<FileContent[]> {\t\t\n\t\t// If we're given a path name, then we work with\n\t\t// that path only. If we' are not given a path,\n\t\t// we synchronised all changed files.\n\t\tif (path) {\n\t\t\treturn this.above.Read(path)\n\t\t\t.then(\n\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\tswitch(fc.Stat) {\n\t\t\t\t\t\tcase FileStat.New:\n\t\t\t\t\t\t\t// fallthrough\n\t\t\t\t\t\tcase FileStat.Changed:\n\t\t\t\t\t\t\treturn this.below.Write(fc.Name, fc.Stat, fc.Content);\n\t\t\t\t\t\tcase FileStat.Deleted:\n\t\t\t\t\t\t\t// fallthrough\n\t\t\t\t\t\tcase FileStat.NotExist:\n\t\t\t\t\t\t\treturn this.below.Remove(fc.Name, fc.Stat);\n\t\t\t\t\t}\n\t\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t\t})\n\t\t\t.then(\n\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\treturn this.above.Write(fc.Name, fc.Stat, fc.Content);\n\t\t\t\t})\n\t\t\t.then(\n\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\tthis.changes.delete(path);\n\t\t\t\t\tconsole.log(`Returning from FSOverlay single-file sync: fc = `, fc);\n\t\t\t\t\treturn Promise.resolve<FileContent[]>([fc]);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\t// We do two passes through our changes list, first\n\t\t// doing all Writes then doing all Deletes. Therefore,\n\t\t// if any writes fail, the deletes aren't executed, which\n\t\t// can be valuable when managing renames.\n\t\tlet writePromises = new Array<Promise<FileContent>>();\n\t\tfor (let p of this.changes) {\n\t\t\twritePromises.push( \n\t\t\t\tthis.above.Read(p)\n\t\t\t\t.then(\n\t\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\t\tif (fc.Stat==FileStat.New || fc.Stat==FileStat.Changed) {\n\t\t\t\t\t\t\treturn this.below.Write(p, fc.Stat, fc.Content);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\t\tif (fc) {\n\t\t\t\t\t\t\treturn this.above.Write(p, fc.Stat, fc.Content);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t);\n\t\t}\n\t\t\n\t\treturn Promise.all<FileContent>(writePromises)\n\t\t.then(\n\t\t\t(fcsP:FileContent[])=>{\n\t\t\t\tlet removePromises: Promise<FileContent>[] = [] ;\n\t\t\t\tfor (let fc of fcsP) {\n\t\t\t\t\tif (fc.Stat == FileStat.Deleted || fc.Stat==FileStat.NotExist) {\n\t\t\t\t\t\tremovePromises.push(\n\t\t\t\t\t\t\tthis.below.Remove(fc.Name)\n\t\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\t\t\t\t\treturn this.above.Remove(fc.Name, fc.Stat);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tremovePromises.push(Promise.resolve<FileContent>(fc));\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn Promise.all<FileContent>(removePromises);\n\t\t\t})\n\t\t.then(\n\t\t\t(fcs:FileContent[])=>{\n\t\t\t\t// We're synced, so there are not more changes\n\t\t\t\tthis.changes.clear();\n\t\t\t\treturn Promise.resolve<FileContent[]>(fcs);\n\t\t\t});\n\t}\t\n}","import {EBW} from '../EBW';\nimport {FS,FileStat,FileContent} from './FS';\n\n/**\n * FSRemote is a FileSystem stored on a remote\n * server.\n */\nexport class FSRemote {\n\tconstructor(\n\t\tprotected repoOwner:string, \n\t\tprotected repoName:string) \n\t{\n\t}\n\tStat(path:string) : Promise<FileStat> {\n\t\treturn EBW.API()\n\t\t\t.FileExists(this.repoOwner, this.repoName, path)\n\t\t\t.then(\n\t\t\t\t([exists]:[boolean])=>{\n\t\t\t\t\t// Remote system is definitive\n\t\t\t\t\treturn Promise.resolve<FileStat>( exists ? FileStat.Exists : FileStat.NotExist);\n\t\t\t\t}) as Promise<FileStat>;\n\t}\n\tRead(path:string) :Promise<FileContent> {\n\t\treturn EBW.API()\n\t\t.GetFileString(this.repoOwner, this.repoName, path)\n\t\t.then(\n\t\t\t([content]:[string])=>{\n\t\t\t\treturn new FileContent(path, FileStat.Exists, content);\n\t\t\t});\n\t}\n\tWrite(path:string, stat:FileStat, content?: string): Promise<FileContent> {\n\t\tif ('undefined' == typeof content) {\n\t\t\treturn Promise.reject(`FSRemote cannot write file ${path} without content.`);\n\t\t}\n\t\treturn EBW.API()\n\t\t.UpdateFile(this.repoOwner, this.repoName, path, content)\n\t\t.then(\n\t\t\t()=>{\n\t\t\t\treturn new FileContent(path, FileStat.Exists, content);\n\t\t\t}\n\t\t);\n\t}\n\tRename(fromPath:string, toPath: string): Promise<[FileContent,FileContent]> {\n\t\treturn EBW.API().RenameFile(this.repoOwner, this.repoName, fromPath, toPath)\n\t\t.then(\n\t\t\t()=>{\t\t\t\t\n\t\t\t\treturn this.Read(toPath)\n\t\t\t\t.then(\n\t\t\t\t\t(fNew:FileContent)=>{\n\t\t\t\t\t\tlet fOld = new FileContent(fromPath, FileStat.NotExist);\n\t\t\t\t\t\treturn Promise.resolve<[FileContent,FileContent]>([fOld, fNew]);\n\t\t\t\t\t})\n\t\t\t});\n\t}\n\tRemove(path:string, stat?:FileStat) : Promise<FileContent> {\n\t\treturn EBW.API().RemoveFile(this.repoOwner, this.repoName, path)\n\t\t.then(\n\t\t\t()=>{\n\t\t\t\treturn Promise.resolve<FileContent>(new FileContent(path, FileStat.NotExist));\n\t\t\t}\n\t\t);\n\t}\n\tSync(path?:string) :Promise<FileContent[]> {\n\t\treturn Promise.reject(`FSRemote doesn't support Sync()`);\n\t}\n\tRepoOwnerName() : [string,string] {\n\t\treturn [this.repoOwner, this.repoName];\n\t}\n\tRevert(path:string):Promise<FileContent> {\n\t\treturn Promise.reject(`FSRemove doesn't support Revert`);\n\t}\n\tIsDirty(path:string):Promise<boolean> { return Promise.reject(`FSRemote doesn't support IsDirty`); }\n\n}","interface storageInterface {\n\tclear():void;\n\tremoveItem(k:string):void;\n\tgetItem(k:string):string;\n\tsetItem(k:string, v:string):void;\n}\n\nclass store implements storageInterface {\n\tprotected s:Map<string,string>;\n\tconstructor() {\n\t\tthis.s = new Map<string,string>();\n\t}\n\tclear() {\n\t\tthis.s.clear();\n\t}\n\tremoveItem(k:string):void {\n\t\tthis.s.delete(k);\n\t}\n\tgetItem(k:string):string {\n\t\t// console.log(`store::getItem(${k}) = `, this.s.get(k));\n\t\treturn this.s.get(k);\n\t}\n\tsetItem(k:string, v:string) {\n\t\t// console.log(`store::setItem ${k} = ${v}`);\n\t\tthis.s.set(k,v);\n\t}\n}\n\nvar singleton: store;\n\nexport function Store() : storageInterface {\n\tif ('undefined'!=typeof sessionStorage) {\n\t\treturn sessionStorage;\n\t}\n\tif (!singleton) {\n\t\tsingleton = new store();\n\t}\n\treturn singleton;\n}\n\n","import {FileStat, FileContent, FS} from './FS';\nimport {Store} from './Store';\n\nexport class FSSession {\n\tprotected key: string;\n\tconstructor(\n\t\tprotected name: string,\n\t\tprotected repoOwner:string, \n\t\tprotected repoName:string,\n\t\tprotected defaultRemoveStat:FileStat = FileStat.Deleted) \n\t{\n\t\tthis.key = encodeURIComponent(this.name) + `:` +\n\t\t\tencodeURIComponent(this.repoOwner) + `:` +\n\t\t\tencodeURIComponent(this.repoName) + `:`;\n\t}\n\tprotected get(path:string) : FileContent {\n\t\tlet js = Store().getItem(this.key+path);\n\t\tif (!js) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn FileContent.FromJS(js);\t\t\t\t\n\t}\n\tprotected set(c : FileContent) {\n\t\tif (c.Stat==FileStat.NotExist) {\n\t\t\tthis.delete(c.Name);\n\t\t\treturn;\n\t\t}\n\t\tStore().setItem(this.key+c.Name, c.Serialize());\n\t}\n\tprotected delete(path:string) {\n\t\tStore().removeItem(this.key+path);\n\t}\n\n\tStat(path:string) : Promise<FileStat> {\n\t\tlet c = this.get(path);\n\t\treturn Promise.resolve<FileStat>( c ? c.Stat : FileStat.NotExist);\n\t}\n\n\tRead(path:string) : Promise<FileContent> {\n\t\tlet c = this.get(path);\n\t\tif (!c) {\n\t\t\treturn Promise.reject(`${path} does not exist`);\n\t\t}\n\t\treturn Promise.resolve<FileContent>(c);\n\t}\n\n\tWrite(path:string, stat: FileStat, content?: string): Promise<FileContent> {\n\t\tlet f= new FileContent(path, stat, content);\n\t\tthis.set(f);\n\t\treturn Promise.resolve<FileContent>(f);\n\t}\n\n\tRemove(path:string, stat?:FileStat) : Promise<FileContent> {\n\t\tlet c = this.get(path);\n\t\tif (!c) {\n\t\t\tconsole.log(`Tried to remove ${path} which does not appear to exist`);\n\t\t\treturn Promise.resolve<FileContent>(new FileContent(path, FileStat.NotExist));\n\t\t}\n\t\tif (!stat) {\n\t\t\tstat = this.defaultRemoveStat;\n\t\t}\n\t\tlet fc = new FileContent(path, stat, c.Content);\n\t\tthis.set(fc);\n\t\treturn Promise.resolve<FileContent>(fc);\n\t}\n\n\tRename(fromPath:string, toPath:string) : Promise<[FileContent,FileContent]> {\n\t\tif (fromPath==toPath) {\n\t\t\treturn Promise.reject(`Renaming isn't changing name`);\n\t\t}\n\t\tlet f = this.get(fromPath);\n\t\tlet t = this.get(toPath);\n\t\tif (!f) {\n\t\t\treturn Promise.reject(`${fromPath} does not exist`);\n\t\t}\n\t\tif (t) {\n\t\t\treturn Promise.reject(`${toPath} already exists`);\n\t\t}\n\t\tt = new FileContent(toPath, FileStat.Changed, f.Content, f);\n\t\tthis.set(t);\n\n\t\tf = new FileContent(fromPath, this.defaultRemoveStat, f.Content);\n\t\tthis.set(f);\n\n\t\treturn Promise.resolve<[FileContent,FileContent]>([f,t]);\n\t}\n\n\tSync(path?:string):Promise<FileContent[]> {\n\t\treturn Promise.reject(`FSSession doesn't support Sync`);\n\t}\n\n\tRepoOwnerName():[string,string] {\n\t\treturn [this.repoOwner, this.repoName];\n\t}\n\t\n\tRevert(path:string): Promise<FileContent> {\n\t\treturn Promise.reject(`FSSession doesn't support Revert`);\n\t}\n\tIsDirty(path:string):Promise<boolean> { return Promise.reject(`FSSession doesn't support IsDirty`); }\n\n}","import {FSSession} from './FSSession';\nimport {FS,FileStat,FileContent} from './FS';\n\n/**\n * FSReadCache is PURELY a session storage based\n * cache over a resource-intensive remote cache. It\n * caches file existence and file reads, but all\n * writes, renames and removes are handled by the remote\n * content system. It doesn't track any sense of\n * Dirty file state.\n * \n * Because FSReadCache is purely a READ Cache, it cannot\n * do anything like revert, since that requires the underlying\n * FS to handle revert, so Revert is simply passed to the\n * underlying FS.\n */\nexport class FSReadCache {\n\tprotected cache: FSSession;\n\n\tconstructor(protected source: FS)\n\t{\n\t\tlet [owner,name] = this.source.RepoOwnerName();\n\t\tthis.cache = new FSSession(`source-cache`, owner, name);\n\t}\n\n\tRepoOwnerName():[string,string] {\n\t\treturn this.source.RepoOwnerName();\n\t}\n\n\tRead(path:string) : Promise<FileContent> {\n\t\treturn this.cache.Stat(path)\n\t\t.then(\n\t\t\t(s:FileStat)=>{\n\t\t\t\tswitch (s) {\n\t\t\t\t\tcase FileStat.Exists:\n\t\t\t\t\t\treturn this.readAndCachePath(path);\n\t\t\t\t\tcase FileStat.Changed:\n\t\t\t\t\t\t//fallthrough\n\t\t\t\t\tcase FileStat.New:\n\t\t\t\t\t\t//fallthrough\n\t\t\t\t\tcase FileStat.Deleted:\n\t\t\t\t\t\treturn this.cache.Read(path);\t\t\t\t\t\t\n\t\t\t\t\tcase FileStat.NotExist:\n\t\t\t\t\t\treturn this.source.Read(path)\n\t\t\t\t\t\t.then(\n\t\t\t\t\t\t\t(c)=>{\n\t\t\t\t\t\t\t\tthis.cache.Write(path, c.Stat, c.Content);\n\t\t\t\t\t\t\t\treturn Promise.resolve<FileContent>(c);\n\t\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\tprotected readAndCachePath(path:string) : Promise<FileContent> {\n\t\treturn this.cache.Read(path)\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tif (fc.Content) {\n\t\t\t\t\treturn Promise.resolve<FileContent>(fc);\n\t\t\t\t}\n\t\t\t\treturn this.source.Read(path)\n\t\t\t\t.then(\n\t\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\t\treturn this.cache.Write(path, fc.Stat, fc.Content);\n\t\t\t\t\t});\n\t\t\t});\t\t\n\t}\n\n\tRemove(path:string,stat?:FileStat) : Promise<FileContent> {\n\t\treturn this.source.Remove(path,stat).then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tconsole.log(`ReadCache.Remove received ${path}: stat = `, fc.Stat);\n\t\t\t\treturn this.cache.Remove(path, fc.Stat)\n\t\t\t\t.then(\n\t\t\t\t\t(rfc:FileContent)=>{\n\t\t\t\t\t\tconsole.log(`ReadCache.Remove returning `, rfc);\n\t\t\t\t\t\treturn Promise.resolve<FileContent>(rfc);\n\t\t\t\t\t})\n\t\t\t}\n\t\t);\n\t}\n\n\tRename(fromPath:string, toPath:string) : Promise<[FileContent,FileContent]> {\n\t\treturn this.source.Rename(fromPath, toPath).then(\n\t\t\t([fOld, fNew]:[FileContent,FileContent])=>{\n\t\t\t\treturn this.cache.Write(toPath, fNew.Stat, fNew.Content)\n\t\t\t\t.then(\n\t\t\t\t\t(_:FileContent)=>{\n\t\t\t\t\t\treturn this.cache.Remove(fromPath, fOld.Stat);\n\t\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t(_:FileContent)=>{\n\t\t\t\t\t\treturn Promise.resolve<[FileContent,FileContent]>([fOld,fNew]);\n\t\t\t\t\t});\n\t\t\t});\n\t}\n\n\tRevert(path:string) : Promise<FileContent> {\n\t\treturn this.source.Revert(path)\n\t\t.then(\n\t\t\t(c:FileContent)=>{\n\t\t\t\treturn this.cache.Write(c.Name, c.Stat, c.Content);\n\t\t\t});\n\t}\n\n\tStat(path:string): Promise<FileStat> {\n\t\treturn this.cache.Stat(path)\n\t\t\t.then( \n\t\t\t\t(s:FileStat)=>{\n\t\t\t\t\tif (FileStat.NotExist==s) {\n\t\t\t\t\t\treturn this.source.Stat(path);\n\t\t\t\t\t}\n\t\t\t\t\treturn Promise.resolve<FileStat>(s);\n\t\t\t\t});\n\t}\n\n\tSync(path?:string) : Promise<FileContent[]> {\n\t\treturn this.source.Sync(path);\n\t}\n\n\tWrite(path:string, stat:FileStat, content?: string): Promise<FileContent> {\n\t\tif ('undefined'==typeof content) {\n\t\t\treturn this.cache.Write(path,stat);\n\t\t}\n\t\treturn this.source.Write(path, stat, content).then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\treturn this.cache.Write(fc.Name, fc.Stat, fc.Content);\n\t\t\t});\n\t}\t\n\tIsDirty(path:string):Promise<boolean> { return Promise.reject(`FSReadCache doesn't support IsDirty`); }\n\n}","import {FS, FileContent, FileStat} from './FS/FS';\nimport {FSFileList_File as Template} from './Templates';\nimport {AddToParent} from './DOM';\nimport {Eventify} from './Eventify';\nimport {FSNotify} from './FS/FSNotify';\n\nimport signals = require('signals');\n\n/**\n * FSFileList_File implements a single file element in the \n * list of files in the FileSystem.\n *\n * It doesn't listen directly to the FS, but rather gets the\n * FSFileList to trigger it's FSEvent method.\n */\nexport class FSFileList_File extends Template {\n\tconstructor(\n\t\tparent:HTMLElement,\n\t\tprotected file: FileContent,\n\t\tprotected FS: FSNotify,\n\t\tevents: any,\n\t\tprotected ignoreFunction: (name:string)=>boolean\n\t) {\n\t\tsuper();\n\t\tif (this.ignoreFunction(this.file.Name)) {\n\t\t\tthis.el.classList.add('ignore');\n\t\t}\n\t\tthis.$.name.textContent = this.file.Name;\n\t\tEventify(this.el, events);\n\t\t// This method will be triggered by FSFileList.\n\t\t// this.FS.Listeners.add(this.FSEvent, this);\n\t\tAddToParent(parent, this.el as HTMLElement);\n\t}\n\tFSEvent(path:string, fc:FileContent): void {\n\t\t// console.log(`In FSFileList_File.FSEvent(${path}) - stat = ${fc.Stat}`)\n\t\tif (path != this.file.Name) {\n\t\t\t// If path's don't match, this doesn't affect us.\n\t\t\treturn;\n\t\t}\n\t\tswitch (fc.Stat) {\n\t\t\tcase FileStat.Changed:\n\t\t\t\tthis.FS.IsDirty(this.file.Name)\n\t\t\t\t.then(\n\t\t\t\t\t(dirty)=>{\n\t\t\t\t\t\tif (dirty) {\n\t\t\t\t\t\t\tthis.el.classList.add('changed');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.el.classList.remove('changed');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\tthis.el.classList.remove(`removed`);\n\t\t\t\tbreak;\n\t\t\tcase FileStat.Deleted:\n\t\t\t\tthis.el.classList.remove('changed');\n\t\t\t\tthis.el.classList.add('removed');\n\t\t\t\tbreak;\n\t\t\tcase FileStat.Exists:\n\t\t\t\tthis.el.classList.remove('changed','removed');\n\t\t\t\tbreak;\n\t\t\tcase FileStat.NotExist:\n\t\t\t\tthis.el.remove();\n\t\t\t\tthis.FS.Listeners.remove(this.FSEvent, this);\n\t\t\t\tbreak;\n\t\t}\n\t}\n}\n","import {API} from './API';\n// import {Directory} from './Directory';\nimport {EBW} from './EBW';\nimport {RepoFileEditorCM} from './RepoFileEditorCM';\nimport {FSFileList_File} from './FSFileList_File';\nimport {FSNotify} from './FS/FSNotify';\nimport {FileContent, FileStat} from './FS/FS';\nimport {FSFileEdit} from './FS/FSFileEdit';\n\n/**\n * FSFileList shows a list of the files in the \n * given filesystem.\n */\nexport class FSFileList {\n\tprotected api: API;\n\tprotected files: Map<string, FSFileList_File>;\n\tconstructor(\n\t\tprotected parent:HTMLElement,\n\t\tprotected editor: RepoFileEditorCM,\n\t\tprotected FS:FSNotify,\n\t\tprotected ignoreFunction: (name:string)=>boolean) \n\t{\n\t\tthis.api = EBW.API();\n\t\tthis.FS.Listeners.add(this.FSEvent, this);\n\t\tthis.files = new Map<string,FSFileList_File>();\n\t}\n\tFSEvent(path:string, fc:FileContent) {\n\t\tif (!fc) {\n\t\t\tdebugger;\n\t\t}\n\t\t// console.log(`FSFileList.FSEvent -- fileContent = `, fc);\n\t\tlet f = this.files.get(fc.Name);\n\t\tswitch (fc.Stat) {\n\t\t\tcase FileStat.New:\n\t\t\t\t//\tfallthrough\n\t\t\tcase FileStat.Exists:\n\t\t\t\t// fallthrough\n\t\t\tcase FileStat.Changed:\n\t\t\t\tif (!f) {\n\t\t\t\t\tthis.newFile(fc);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase FileStat.Deleted:\n\t\t\t\t// Nothing to do - filelist_file will handle\n\t\t\t\t// css style change.\n\t\t\t\tbreak;\n\t\t\tcase FileStat.NotExist:\n\t\t\t\tif (f) {\n\t\t\t\t\tthis.files.delete(fc.Name);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t}\n\t\t// Trigger the FSFileList_File FSEvent callback.\n\t\tif (f) {\n\t\t\tf.FSEvent(path, fc);\n\t\t}\n\t}\n\tnewFile(fc:FileContent) : FSFileList_File {\n\t\tlet f = new FSFileList_File(this.parent, fc, this.FS, {\n\t\t\tclickFile: (evt:any)=>{\n\t\t\t\tthis.FS.Read(fc.Name)\n\t\t\t\t.then(\n\t\t\t\t\t(fc:FileContent)=>{\n\t\t\t\t\t\tlet edit = new FSFileEdit(fc, this.FS);\n\t\t\t\t\t\tthis.editor.setFile(edit);\n\t\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\tthis.ignoreFunction);\n\t\tthis.files.set(fc.Name, f);\n\t\treturn f;\n\t}\n\n}\n","/**\n * File models a File on the server.\n */\nimport {Directory} from './Directory';\n\nexport class File {\n\tprotected _parent: Directory;\n\tprotected _name: string;\n\tconstructor(parent:Directory, name:string) {\n\t\tthis._parent = parent;\n\t\tthis._name = name;\n\t}\n\tstatic FromJS(parent:Directory, js:any) : File {\n\t\treturn new File(parent, js.N);\n\t}\n\tDebug() {\n\t\tconsole.log(this.Path());\n\t}\n\tPath() : string {\n\t\tlet p = this._parent ? this._parent.Path() : ``;\n\t\treturn p + this._name;\n\t}\n\tIsFile() : boolean {\n\t\treturn true;\n\t}\n\tName() : string {\n\t\treturn this._name;\n\t}\n}\n","import {File} from './File';\n\n/**\n * Directory models a directory on the server. It needs to know\n * its own directory name, and the link to its parent so that it\n * can construct its full name on the parent.\n */\nexport class Directory {\n\tprotected _parent: Directory|undefined;\n\tprotected _name: string;\n\tprotected Files: Array<Directory|File>;\n\t\n\tconstructor(parent:Directory|undefined, name:string) {\n\t\tthis._parent = parent;\n\t\tthis._name = name;\n\t\tthis.Files = [];\n\t}\n\tstatic FromJS(parent:Directory|undefined, js:any) : Directory {\n\t\tlet d = new Directory(parent, js.N as string);\n\t\tfor (let f of js.F) {\n\t\t\tlet e : Directory|File;\n\t\t\tif (f.F) {\n\t\t\t\te = Directory.FromJS(d, f);\n\t\t\t\td.Files.push(e);\n\t\t\t} else {\n\t\t\t\te = File.FromJS(d, f);\n\t\t\t\td.Files.push(e);\n\t\t\t}\n\t\t}\n\t\treturn d;\n\t}\n\tDebug() {\n\t\tconsole.log(this.Path());\n\t\tfor (let f of this.Files) {\n\t\t\tf.Debug();\n\t\t}\n\t}\n\tPath():string {\n\t\tif (this._parent) {\n\t\t\treturn this._parent.Path() + this._name + '/';\n\t\t}\n\t\treturn '';\n\t}\n\tName():string {\n\t\treturn this._name;\n\t}\n\tIsFile():boolean {\n\t\treturn false;\n\t}\n\tFileNamesOnly(filter?:(n:string)=>boolean) : string[] {\n\t\tlet fs: string[] = [];\n\t\tfor (let f of this.Files) {\n\t\t\tif (f.IsFile()) {\n\t\t\t\tlet p = f.Path();\n\t\t\t\tif (!filter || filter(p)) {\n\t\t\t\t\tfs.push(p);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfs = fs.concat((f as Directory).FileNamesOnly(filter));\n\t\t\t}\n\t\t}\n\t\treturn fs.sort();\n\t}\n}","import {Directory} from './Directory';\nimport {FS, FileStat, FileContent} from './FS';\n\n// FSPrimeFromJS adds files to the FileSystem from the \n// Directory and File objects serialized in the given js object.\n// The FileSystem must be able to accomodate empty content\n// Writes.\nexport function FSPrimeFromJS(fs:FS, js:any):void {\n\tlet d = Directory.FromJS(undefined, js);\n\tlet filter = function(n:string):boolean {\n\t\tif (\".\"==n.substr(0,1)) {\n\t\t\treturn false;\n\t\t}\n\t\tif (\"_output\" == n.substr(0,7)) {\n\t\t\treturn false;\n\t\t}\n\t\tif (\"_html\"==n.substr(0,5)) {\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\tfor (let f of d.FileNamesOnly(filter)) {\n\t\tfs.Write(f, FileStat.Exists);\n\t}\n}\n","import {ControlTag} from './ControlTag';\nimport {EBW} from './EBW';\nimport {PrintListener} from './PrintListener';\nimport {RepoFileEditorCM} from './RepoFileEditorCM';\nimport {RepoEditorPage_NewFileDialog} from './RepoEditorPage_NewFileDialog';\nimport {RepoEditorPage_RenameFileDialog} from './RepoEditorPage_RenameFileDialog';\n\nimport {FileContent,FileStat,FS} from './FS/FS';\nimport {FSNotify} from './FS/FSNotify';\nimport {FSOverlay} from './FS/FSOverlay';\nimport {FSRemote} from './FS/FSRemote';\nimport {FSReadCache} from './FS/FSReadCache';\nimport {FSSession} from './FS/FSSession';\n\nimport {FSFileList} from './FSFileList';\nimport {FSPrimeFromJS} from './FS/FSPrimeFromJS';\n\n/**\n * RepoEditorPage is the JS controller for the page that allows\n * editing of a repo.\n *\n */\nexport class RepoEditorPage {\n\tprotected editor: RepoFileEditorCM;\n\tprotected FS: FSNotify;\n\n\tconstructor(\n\t\tprotected repoOwner:string, \n\t\tprotected repoName:string,\n\t\tfilesList: HTMLElement,\n\t\tfilesJson: any,\n\t\tprotected proseIgnoreFunction: (name:string)=>boolean\n\t) {\n\t\tsessionStorage.clear();\n\t\tthis.repoOwner = repoOwner;\n\t\tthis.repoName = repoName;\n\t\tthis.editor = undefined;\n\t\tthis.editor = new RepoFileEditorCM(\n\t\t\trepoOwner, repoName,\n\t\t\tdocument.getElementById('editor'), {\n\t\t\tRename: ():void=>{\n\t\t\t\treturn;\n\t\t\t}\n\t\t});\n\n\t\tlet remoteFS = new FSReadCache(new FSRemote(this.repoOwner, this.repoName));\n\t\tlet localFS = new FSSession(`temp-rootf`, this.repoOwner, this.repoName);\n\t\tlet overlayFS = new FSOverlay(remoteFS, localFS);\n\t\tthis.FS = new FSNotify(overlayFS);\n\t\t\n\t\tnew FSFileList(filesList, this.editor, this.FS, this.proseIgnoreFunction);\n\n\t\tnew RepoEditorPage_NewFileDialog(\n\t\t\tdocument.getElementById('repo-new-file'),\n\t\t\tthis.FS,\n\t\t\tthis.editor);\n\t\tnew RepoEditorPage_RenameFileDialog(\n\t\t\tdocument.getElementById(`editor-rename-button`),\n\t\t\tthis.FS,\n\t\t\tthis.editor);\n\n\t\tnew ControlTag(document.getElementById(`files-show-tag`),\n\t\t\t(showing:boolean)=>{\n\t\t\t\tdocument.getElementById(`new-editor-files-nav`)\n\t\t\t\t.style.width = showing ? \"20%\":\"0px\";\n\t\t\t\tdocument.getElementById(`repo-file-actions`)\n\t\t\t\t.style.visibility = showing ? `visible` : `hidden`;\n\n\t\t\t\tlet f = document.getElementById(`page-footer`);\n\t\t\t\tf.style.display = showing ? 'flex' : 'none';\n\t\t\t\t// console.log(`set footer = `, f);\n\t\t\t});\n\n\t\t\n\t\tFSPrimeFromJS(this.FS, filesJson);\n\n\t\tdocument.getElementById(`repo-print-printer`).addEventListener('click', evt=>{\n\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\tEBW.Toast(`Creating your PDF. We'll open it in a new tab when it's ready.`);\n\t\t\tnew PrintListener(this.repoOwner, this.repoName, `book`, `print`);\n\t\t});\n\t\tdocument.getElementById(`repo-print-screen`).addEventListener(`click`, evt=>{\n\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\tEBW.Toast(`Creating your PDF. We'll open it in a new tab when it's ready.`);\n\t\t\tnew PrintListener(this.repoOwner, this.repoName, `book`, `screen`);\n\t\t});\n\t\tdocument.getElementById(`repo-jekyll`).addEventListener(`click`, evt=>{\n\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\tlet l = document.location;\n\t\t\tlet jekyllUrl = `${l.protocol}//${l.host}/jekyll/${this.repoOwner}/${this.repoName}/`;\n\t\t\tconsole.log(`URL = ${jekyllUrl}`);\n\t\t\twindow.open(jekyllUrl, `${this.repoOwner}-${this.repoName}-jekyll`);\n\t\t});\n\t\t/**\n\t\t * @TODO\n\t\t * Need to catch any attempt to leave RepoEditorPage and\n\t\t * check that the user has saved any changes.\n\t\t */\n\t}\n\tstatic instantiate() {\n\t\tlet el = document.getElementById(`repo-editor-page`);\n\t\tif (el) {\n\t\t\tlet repoOwner = el.getAttribute('repo-owner');\n\t\t\tlet repoName = el.getAttribute('repo-name');\n\t\t\t// let volume = new VolumeElement()\n\t\t\t// let allFilesList = document.querySelector(`[data-instance='AllFilesList']`);\n\n\t\t\tlet filesList = document.querySelector(`[data-instance='AllFilesList']`);\n\t\t\tlet primeFSel = document.getElementById(`volume-element`);\n\t\t\tlet primeFSjs = JSON.parse(primeFSel.innerText);\n\t\t\tnew RepoEditorPage(repoOwner, repoName, \n\t\t\t\tfilesList as HTMLElement,\n\t\t\t\tprimeFSjs, \n\t\t\t\tfunction(name:string) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n}\n\nwindow.RepoEditorPage = RepoEditorPage;\n","export class FileStatus {\n\tconstructor(protected status:string) {\n\t}\n\tStatus() : string {\n\t\tif (this.status) {\n\t\t\treturn this.status;\n\t\t}\n\t\treturn 'undefined';\n\t}\n\tSetStatus(s:string) {\n\t\tthis.status = s;\n\t}\n}","import signals = require('signals');\nimport {Context} from '../Context';\nimport {EBW} from '../EBW';\nimport {FileStatus} from './FileStatus';\n\nexport class FileContent {\n\tpublic Exists: boolean;\n\tpublic Raw: string;\n\tconstructor(exists:boolean, raw:string) {\n\t\tthis.Exists = exists;\n\t\tthis.Raw = raw ? raw : ``;\n\t}\n}\n\nexport enum FileEvent {\n\tWorkingChanged,\n\tTheirChanged,\n\tStatusChanged\n}\n\nexport class MergeFileResolutionState {\n\tState: number;\n\tDescription: string;\n}\n\n// File models a single conflicted file in the repo.\n// All communication with the conflicted file occurs through this single\n// class, which will coordinate any other internal-classes that it might need,\n// like the file status.\nexport class File {\n\tprotected status : FileStatus;\n\tpublic Listen : signals.Signal;\n\t// Signalled when RPC is in progress\n\tpublic ListenRPC: signals.Signal;\n\n\tprotected cache : Map<string,FileContent>;\n\tconstructor(protected context:Context,protected path: string, status:string) {\n\t\tthis.status = new FileStatus(status);\n\t\tthis.Listen = new signals.Signal();\n\t\tthis.ListenRPC = new signals.Signal();\n\t\tthis.cache = new Map<string,FileContent>();\n\t}\n\tStatus(): string {\n\t\tif (this.status) {\n\t\t\treturn this.status.Status();\n\t\t}\n\t\treturn 'undefined';\n\t}\n\tSetStatus(source:any, status:string) {\n\t\tthis.status.SetStatus(status);\n\t\tthis.Listen.dispatch(source, FileEvent.StatusChanged, status);\n\t}\n\tPath() : string {\n\t\treturn this.path;\n\t}\n\n\t/* THE FOLLOWING METHODS HANDLE CONTENT FOR THE FILE */\n\tClearCache() : void {\n\t\tthis.cache.clear();\n\t}\n\tFetchContent(source:any) : Promise<void> {\n\t\tif (this.cache.has(`working`)) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tthis.ListenRPC.dispatch(source, true, `FetchContent`);\n\t\treturn this.context.API()\n\t\t.MergedFileCat(this.context.RepoOwner, this.context.RepoName, this.path)\n\t\t.then(\n\t\t\t([workingExists, working, theirExists, their, gitMerge]:[boolean,string,boolean,string,string])=>{\n\t\t\t\tlet workingFile = new FileContent(workingExists, working);\n\t\t\t\tlet theirFile = new FileContent(theirExists, their);\n\t\t\t\tlet gitFile = new FileContent(true, gitMerge);\n\t\t\t\tthis.cache.set(`working`, workingFile);\n\t\t\t\tthis.cache.set(`their`, theirFile);\n\t\t\t\tthis.cache.set(`git`, gitFile)\n\n\t\t\t\tthis.ListenRPC.dispatch(source, false, `FetchContent`);\n\t\t\t\tthis.Listen.dispatch(source, FileEvent.WorkingChanged, workingFile);\n\t\t\t\tthis.Listen.dispatch(source, FileEvent.TheirChanged, theirFile);\n\t\t\t\treturn Promise.resolve();\n\t\t\t});\n\t}\n\t// FetchGit fetches the git merged content for the file\n\tFetchGit(source:any):Promise<void>{\n\t\tif (this.cache.has(`git`)) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tthis.ListenRPC.dispatch(source, true, `FetchGit`);\n\t\treturn this.context.API()\n\t\t.MergedFileGit(this.context.RepoOwner, this.context.RepoName, this.path)\n\t\t.then(\n\t\t\t([automerged, text]:[boolean,string])=> {\n\t\t\t\tlet gitFile = new FileContent(true, text);\n\t\t\t\tthis.cache.set(`git`, gitFile);\n\t\t\t\tthis.ListenRPC.dispatch(source, false, `FetchGit`);\n\t\t\t\t// TODO: Should it be WorkingChanged that we're sending?\n\t\t\t\tthis.Listen.dispatch(source, FileEvent.WorkingChanged, gitFile);\n\t\t\t\treturn Promise.resolve();\n\t\t});\n\t}\n\tRevertOur(source:any) : Promise<FileContent> {\n\t\tthis.ListenRPC.dispatch(source, true, `RevertOur`);\n\t\treturn this.mergeFileOriginal(\"our\")\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.cache.set(`working`, fc);\n\t\t\t\tthis.ListenRPC.dispatch(source, false, `RevertOur`);\n\t\t\t\tthis.Listen.dispatch(source, FileEvent.WorkingChanged, fc);\n\t\t\t\treturn Promise.resolve(fc);\n\t\t\t});\n\t}\n\tRevertOurToTheir(source:any) : Promise<FileContent> {\n\t\tthis.ListenRPC.dispatch(source, true, `RevertOurToTheir`);\n\t\treturn this.mergeFileOriginal(\"their\")\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.cache.set(`working`, fc);\n\t\t\t\tthis.ListenRPC.dispatch(source, false, `RevertOur`);\n\t\t\t\tthis.Listen.dispatch(source, FileEvent.WorkingChanged, fc);\n\t\t\t\treturn Promise.resolve(fc);\n\t\t\t})\n\t}\n\tRevertOurToGit(source: any) : Promise<FileContent>{ \n\t\tthis.ListenRPC.dispatch(source, true, `RevertOurToGit`);\n\t\treturn this.mergeFileOriginal(\"git\")\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.cache.set(`working`, fc)\n\t\t\t\tthis.ListenRPC.dispatch(source, false, `RevertOurToGit`);\n\t\t\t\tthis.Listen.dispatch(source, FileEvent.WorkingChanged, fc);\n\t\t\t\treturn Promise.resolve(fc);\n\t\t\t})\n\t}\n\tRevertTheir(source:any) : Promise<FileContent> {\n\t\tthis.ListenRPC.dispatch(source, true,`RevertTheir`);\n\t\treturn this.mergeFileOriginal(\"their\")\n\t\t.then(\n\t\t\t(fc:FileContent)=>{\n\t\t\t\tthis.cache.set(`their`, fc);\n\t\t\t\tthis.ListenRPC.dispatch(source, false, `RevertTheir`);\n\t\t\t\tthis.Listen.dispatch(source, FileEvent.TheirChanged, fc);\n\t\t\t\treturn Promise.resolve(fc);\n\t\t\t});\n\t}\n\tmergeFileOriginal(v:string) : Promise<FileContent> {\n\t\treturn this.context.API()\n\t\t.MergeFileOriginal(this.context.RepoOwner, this.context.RepoName, this.path, v)\n\t\t.then(\n\t\t\t([exists,raw]:[boolean,string])=>{\n\t\t\t\treturn Promise.resolve<FileContent>(new FileContent(exists, raw));\n\t\t\t});\n\t}\n\tprotected getCachedContent(key:string) : FileContent {\n\t\treturn this.cache.get(key);\n\t}\n\tprotected setCachedContent(key:string, value:FileContent) : void {\n\t\tthis.cache.set(key,value);\n\t}\n\tTheirFile() : FileContent {\n\t\treturn this.cache.get(`their`);\n\t}\n\tWorkingFile() : FileContent {\n\t\treturn this.cache.get(`working`);\n\t}\n\tRemoveWorkingFile(source:any) : void {\n\t\tlet fc = new FileContent(false, ``);\n\t\tthis.cache.set(`working`, fc);\n\t\tthis.Listen.dispatch(source, FileEvent.WorkingChanged, fc);\n\t\t// Don't need to delete on server as this will happen on file save\n\t}\n\tRemoveTheirFile(source:any) : void {\n\t\tlet fc = new FileContent(false, ``);\n\t\tthis.cache.set(`their`, new FileContent(false, ``));\n\t\tthis.Listen.dispatch(source, FileEvent.TheirChanged, fc);\n\t\t// Don't need to delete on server as this will happen on file save\n\t}\n\tSetWorkingContent(source:any,content:string) : void {\n\t\tlet fc = new FileContent(content!=undefined, content);\n\t\tthis.cache.set(`working`, fc);\n\t\tthis.Listen.dispatch(source, FileEvent.WorkingChanged, fc);\n\t}\n\tSetTheirContent(source:any, content:string) : void {\n\t\tlet fc = new FileContent(content!=undefined, content);\n\t\tthis.cache.set(`their`, fc);\n\t\tthis.Listen.dispatch(source, FileEvent.TheirChanged, fc);\n\t}\n\tSave() : Promise<void> {\n\t\tlet working = this.cache.get(`working`);\n\t\tlet their = this.cache.get(`their`);\n\t\tthis.ListenRPC.dispatch(this, true, `Save`);\n\t\treturn this.context.API()\n\t\t.SaveMergingFile(\n\t\t\tthis.context.RepoOwner, this.context.RepoName,\n\t\t\tthis.Path(),\n\t\t\tworking.Exists, working.Raw,\n\t\t\ttheir.Exists, their.Raw\n\t\t\t)\n\t\t.then(\n\t\t\t([status]:[string])=>{\n\t\t\t\tthis.ListenRPC.dispatch(this, false, `Save`);\n\t\t\t\tthis.SetStatus(undefined, status);\n\t\t\t\treturn Promise.resolve();\n\t\t\t});\n\t}\n\tStage(source:any):Promise<void> {\n\t\tthis.ListenRPC.dispatch(this,true,`Stage`);\n\t\treturn this.context.API()\n\t\t.StageFileAndReturnMergingState(\n\t\t\tthis.context.RepoOwner, \n\t\t\tthis.context.RepoName,\n\t\t\tthis.Path()\n\t\t).then(\n\t\t\t([status]:[string])=>{\n\t\t\t\tthis.ListenRPC.dispatch(this,false, `Stage`);\n\t\t\t\tthis.SetStatus(source, status);\n\t\t\t\treturn Promise.resolve();\n\t\t\t});\n\t}\n}","import {Context} from '../Context';\nimport {File} from './File';\nimport signals = require('signals');\n\nexport enum FileListEvent {\n\tFileNew,\n\tFileChanged\n};\n\nexport class FileList {\n\tprotected files: Array<File>;\n\tpublic Listen: signals.Signal;\n\n\tconstructor(protected context:Context) {\n\t\tthis.files = new Array<File>();\n\t\tthis.Listen = new signals.Signal();\n\t}\n\n\tload(js:any) : void {\n\t\t// I expect js to be an array of {Path:string, Status:string}\n\t\tfor (let j of js) {\n\t\t\tlet f = new File(this.context, j.Path as string, j.Status as string);\n\t\t\tthis.files.push(f);\n\t\t\tthis.Listen.dispatch(FileListEvent.FileNew, f);\n\t\t}\n\t}\n}","import {Context} from '../Context';\nimport {File, FileEvent} from './File';\nimport {conflict_FileDisplay as Template} from '../Templates';\nimport {MergingInfo} from './MergingInfo';\nimport signals = require('signals');\n\nexport enum FileDisplayEvent {\n\tFileClick\n}\n\nexport class FileDisplay extends Template {\n\tpublic Listen: signals.Signal;\n\n\tconstructor(protected context:Context, parent:HTMLElement, protected file:File, protected mergingInfo:MergingInfo) {\n\t\tsuper();\n\t\tthis.Listen = new signals.Signal();\n\n\t\tthis.$.path.innerText = file.Path();\n\t\tthis.fileEvent(undefined, FileEvent.StatusChanged, undefined);\n\n\t\tthis.el.addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\tthis.dispatchEvent(`file-click`);\n\t\t\tthis.Listen.dispatch(FileDisplayEvent.FileClick, this.file);\n\t\t});\n\n\t\tthis.file.Listen.add(this.fileEvent, this);\n\t\tthis.file.ListenRPC.add(this.rpcEvent, this);\n\t\tparent.appendChild(this.el);\n\t}\n\tdispatchEvent(name:string) {\n\t\tlet d = { bubbles: true, detail: { file: this.file } };\n\t\tthis.el.dispatchEvent(new CustomEvent(name, d));\n\t}\n\tfileEvent(source:any, event: FileEvent, data:any) {\n\t\tswitch (event) {\n\t\t\tcase FileEvent.StatusChanged:\n\t\t\t\tthis.$.status.innerText = this.file.Status();\n\t\t\t\tthis.el.classList.remove(`status-new`,`status-modified`,`status-resolved`,`status-deleted`,`status-conflict`,`status-error`);\n\t\t\t\tthis.el.classList.add(`status-${this.file.Status()}`);\t\t\t\t\n\t\t\t\tbreak;\n\t\t}\n\t}\n\trpcEvent(source:any, inProgress:boolean, method:string) {\n\t\tconsole.log(`RPC Event for ${this.file.Path()} inProgress = ${inProgress}, method = ${method}`);\n\t\tlet cl = this.el.classList;\n\t\tif (inProgress) {\n\t\t\tcl.add(`rpc`);\n\t\t} else {\n\t\t\tcl.remove(`rpc`);\n\t\t}\n\t}\n}","import {Context} from '../Context';\nimport {conflict_FileListDisplay as Template} from '../Templates';\nimport {FileListEvent, FileList} from './FileList';\nimport {File} from './File';\nimport {FileDisplayEvent, FileDisplay} from './FileDisplay';\nimport {MergingInfo} from './MergingInfo';\nimport signals = require('signals');\n\nexport enum FileListDisplayEvent {\n\tFileClick\n}\n\nexport class FileListDisplay extends Template {\n\tpublic Listen: signals.Signal;\n\n\tconstructor(protected context:Context, protected parent:HTMLElement, \n\t\tfileList: FileList, protected mergingInfo:MergingInfo) \n\t{\n\t\tsuper();\n\t\tthis.Listen = new signals.Signal();\n\n\t\tfileList.Listen.add(this.fileListEvent, this);\n\t\tthis.parent.appendChild(this.el);\n\t}\n\tfileListEvent(e:FileListEvent, f:File) : void{\n\t\tswitch (e) {\n\t\t\tcase FileListEvent.FileNew:\n\t\t\t\tlet fd = new FileDisplay(this.context, this.el, f, this.mergingInfo);\n\t\t\t\tfd.Listen.add( this.fileDisplayEvent, this );\n\t\t\t\tbreak;\n\t\t}\n\t}\n\tfileDisplayEvent(evt: FileDisplayEvent, f: File) : void {\n\t\tswitch (evt) {\n\t\t\tcase FileDisplayEvent.FileClick:\n\t\t\t\tthis.Listen.dispatch(FileListDisplayEvent, f);\n\t\t\t\tbreak;\n\t\t}\n\t}\n}","import {FileEvent,File} from './File';\nimport signals = require('signals');\n\nexport enum MergeEditorAction {\n\tSave,\n\tResolve,\n\tDelete,\n\tRevertOur,\n\tRevertTheir,\n\tRevertGit,\n\tCopyWorking,\n\tCopyTheir\n}\n// MergeEditorControlBar handles the wiring between the editor controls\n// and any listeners interested in these controls\nexport class MergeEditorControlBar {\n\tpublic Listen : signals.Signal;\n\n\tprotected DeleteButton: HTMLElement;\n\tprotected SaveButton : HTMLElement;\n\tprotected RevertOurButton: HTMLElement;\n\tprotected RevertGitButton: HTMLElement;\n\tprotected RevertTheirButton: HTMLElement;\n\tprotected CopyWorkingButton : HTMLElement;\n\tprotected CopyTheirButton: HTMLElement;\n\n\tprotected RevertSingleOurButton: HTMLElement;\n\tprotected RevertSingleTheirButton: HTMLElement;\n\tprotected RevertSingleGitButton: HTMLElement;\n\n\tprotected buttons: HTMLElement[];\n\n\tprotected file: File;\n\n\tget(key:string) : HTMLElement {\n\t\treturn document.getElementById(`merge-editor-control-${key}`) as HTMLElement;\n\t}\n\tdisable(el:HTMLElement) {\n\t\tthis.enable(el, false);\n\t}\n\tenable(el:HTMLElement, e:boolean=true) {\n\t\tif (e) {\n\t\t\tel.removeAttribute(`disabled`);\n\t\t} else {\n\t\t\tel.setAttribute(`disabled`,`disabled`);\n\t\t}\n\t}\n\n\tconstructor() {\n\t\tthis.Listen = new signals.Signal();\n\n\t\tthis.DeleteButton = this.get(`delete`);\n\t\tthis.SaveButton = this.get(`save`);\n\n\t\tthis.RevertOurButton = this.get(`revert-our`);\n\t\tthis.RevertTheirButton = this.get(`revert-their`);\n\t\tthis.CopyWorkingButton = this.get(`copy-working`);\n\t\tthis.CopyTheirButton = this.get(`copy-their`);\n\n\t\tthis.RevertSingleOurButton =this.get(`single-revert-our`);\n\t\tthis.RevertSingleTheirButton = this.get(`single-revert-their`);\n\t\tthis.RevertSingleGitButton = this.get(`single-revert-git`);\n\n\t\tthis.buttons = new Array<HTMLElement>();\n\n\t\tlet ln = (key:string, act:MergeEditorAction) => {\n\t\t\tlet el = this.get(key);\n\t\t\tif (el) {\n\t\t\t\tel.addEventListener(`click`, (evt)=>{\n\t\t\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\t\t\tthis.Listen.dispatch(act);\n\t\t\t\t});\n\t\t\t\tthis.buttons.push(el);\n\t\t\t} else {\n\t\t\t\tconsole.error(`Failed to find #${key}`);\n\t\t\t}\n\t\t}\n\t\tln(`revert-our`, MergeEditorAction.RevertOur);\n\t\tln(`revert-their`, MergeEditorAction.RevertTheir);\n\t\t// ln(`revert-git`, MergeEditorAction.RevertGit);\n\t\tln(`copy-working`, MergeEditorAction.CopyWorking);\n\t\tln(`copy-their`, MergeEditorAction.CopyTheir);\n\t\tln(`save`, MergeEditorAction.Save);\n\t\tln(`delete`, MergeEditorAction.Delete);\n\t\tln(`resolve`, MergeEditorAction.Resolve);\n\n\t\tln(`single-revert-our`, MergeEditorAction.RevertOur);\n\t\tln(`single-revert-their`, MergeEditorAction.RevertTheir);\n\t\tln(`single-revert-git`, MergeEditorAction.RevertGit);\n\t}\n\tSetFile(f:File) {\n\t\tif (this.file) {\n\t\t\tthis.file.Listen.remove(this.fileEvent,this);\n\t\t}\n\t\tthis.file = f;\n\t\tthis.file.Listen.add(this.fileEvent, this);\n\t}\n\tfileEvent(source:any, e:FileEvent) {\n\t\tfor (let el of this.buttons) {\n\t\t\tthis.enable(el, undefined!=this.file);\n\t\t}\n\t\tif (!this.file) {\n\t\t\treturn;\n\t\t}\n\t\tlet f = this.file;\n\t\tif (f.WorkingFile().Exists || f.TheirFile().Exists) {\n\t\t\t// One or the other exists\n\t\t\tthis.DeleteButton.removeAttribute(`disabled`);\n\t\t} else {\n\t\t\tthis.DeleteButton.setAttribute(`disabled`,`disabled`);\n\t\t}\n\t}\n\n}","import {AddToParent} from '../DOM';\nimport {ConflictEditor} from './ConflictEditor';\nimport {Context} from '../Context';\nimport {EBW} from '../EBW';\nimport {FileContent, FileEvent, File} from './File';\nimport {MergeEditorAction, MergeEditorControlBar} from './MergeEditorControlBar';\nimport jQuery = require('jquery');\n\nimport signals = require('signals');\nimport CodeMirror = require('codemirror');\n\n// MergeEditor controls a Mergely class\nexport class MergeEditor implements ConflictEditor {\n\tprotected mergelyDiv: HTMLDivElement;\n\tpublic Listen : signals.Signal;\n\tprotected file:File;\n\tprotected editLeft = true;\n\tprotected editBoth = true;\n\tprotected controls : MergeEditorControlBar;\n\n\tconstructor(\n\t\tprotected context:Context,\n\t\tprotected parent:HTMLElement\n\t\t) \n\t{\n\t\tthis.Listen = new signals.Signal();\n\t\tthis.controls = new MergeEditorControlBar();\n\t\tthis.controls.Listen.add(this.controlAction, this);\n\t}\n\t// WorkingSide returns a string describing the side on which the\n\t// final version will be displayed.\n\tWorkingSide() : string {\n\t\treturn this.editLeft ? \"left\" : \"right\";\n\t}\n\t// TheirSide returns a string describing the side on which\n\t// the submitted changes will be displayed.\n\tTheirSide() : string {\n\t\treturn this.editLeft ? \"right\" : \"left\";\n\t}\n\n\tcontrolAction(act:MergeEditorAction) {\n\t\tswitch(act) {\n\t\t\tcase MergeEditorAction.Save:\n\t\t\t\tthis.SaveFile()\n\t\t\t\t.catch( EBW.Error );\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.Delete:\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.Resolve:\n\t\t\t\tthis.SaveFile()\n\t\t\t\t.then(\n\t\t\t\t\t()=>{\n\t\t\t\t\t\t// undefined so we receive notifications\n\t\t\t\t\t\treturn this.file.Stage(undefined);\n\t\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t()=>{\n\t\t\t\t\t\tEBW.Toast(`Resolved changes on ${this.file.Path()}`);\n\t\t\t\t\t})\n\t\t\t\t.catch(EBW.Error);\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.RevertOur:\n\t\t\t\tthis.RevertOur();\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.RevertTheir:\n\t\t\t\tthis.RevertTheir();\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.CopyWorking:\n\t\t\t\tthis.CopyWorking();\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.CopyTheir:\n\t\t\t\tthis.CopyTheir();\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.RevertGit:\n\t\t}\n\t}\n\tsetWorkingText(t:string) :void {\n\t\tif (this.editLeft) {\n\t\t\tthis.setLHS(t);\n\t\t} else {\n\t\t\tthis.setRHS(t);\n\t\t}\n\t}\n\tsetTheirText(t:string):void {\n\t\tif (this.editLeft) {\n\t\t\tthis.setRHS(t);\n\t\t} else {\n\t\t\tthis.setLHS(t);\n\t\t}\n\t}\n\tgetWorkingText() : string {\n\t\tif (this.editLeft) {\n\t\t\treturn this.getLHS();\n\t\t}\n\t\treturn this.getRHS();\n\t}\n\tgetTheirText() : string {\n\t\tif (this.editLeft) {\n\t\t\treturn this.getRHS();\n\t\t}\n\t\treturn this.getLHS();\n\t}\n\tgetWorkingContent() : FileContent {\n\t\treturn new FileContent(this.isWorkingDeleted(), this.getWorkingText());\n\t}\n\tgetTheirContent() : FileContent {\t\t\n\t\treturn new FileContent(this.isTheirDeleted(), this.getTheirText());\n\t}\n\tCopyTheir() : void {\n\t\t// We leave source undefined, so that our editor will update\n\t\t// when the change arrives\t\t\n\t\tconsole.log(`isTheirDeleted = ${this.isTheirDeleted()}, text = ${this.getTheirText()}`);\n\t\tthis.file.SetWorkingContent(undefined, this.isTheirDeleted() ? undefined : this.getTheirText());\n\t}\n\tCopyWorking() : void {\n\t\t// We leave source undefined, so that our editor will update\n\t\t// when the change arrives\n\t\tconsole.log(`isWorkingDeleted = ${this.isWorkingDeleted()}`);\n\t\tconsole.log(`working text = ${this.getTheirText()}`);\n\t\tthis.file.SetTheirContent(undefined, this.isWorkingDeleted() ? undefined : this.getWorkingText());\n\t}\n\tRevertOur() : void {\n\t\t// Leave source undefined so that our editor updates when\n\t\t// changes arrive.\n\t\tthis.file.RevertOur(undefined)\n\t\t.catch(EBW.Error);\n\t}\n\tRevertTheir() : void {\n\t\t// Leave source undefined so that our editor updates when\n\t\t// changes arrive.\t\n\t\tthis.file.RevertTheir(undefined)\n\t\t.catch(EBW.Error);\n\t}\n\tisWorkingDeleted() : boolean {\n\t\treturn !this.file.WorkingFile().Exists;\n\t}\n\tisTheirDeleted() : boolean {\n\t\treturn !this.file.TheirFile().Exists;\n\t}\n\tsetText(s:string) {\n\t\tif (this.editLeft) {\n\t\t\tthis.setLHS(s);\n\t\t} else {\n\t\t\tthis.setRHS(s);\n\t\t}\n\t}\n\tgetLeftCM() {\n\t\treturn jQuery(this.mergelyDiv).mergely('cm', 'lhs');\n\t}\n\tgetRightCM() {\n\t\treturn jQuery(this.mergelyDiv).mergely('cm', 'rhs');\n\t}\n\tgetLHS() : string {\n\t\treturn this.getLeftCM().getDoc().getValue();\n\t}\n\tgetRHS() : string {\n\t\treturn this.getRightCM().getDoc().getValue();\n\t}\n\tsetLHS(s:string) {\n\t\tif (!s) s=``;\n\t\tthis.getLeftCM().getDoc().setValue(s);\n\t}\n\tsetRHS(s:string) {\n\t\tif (!s) s=``;\n\t\tthis.getRightCM().getDoc().setValue(s);\n\t}\n\tSaveFile() : Promise<string> {\n\t\tif (this.file) {\n\t\t\tlet f = this.file;\n\t\t\tlet w = this.getWorkingText();\n\t\t\t// We pass ourselves as the source, so that we don't update\n\t\t\t// our editor when the change event arrives\n\t\t\tthis.file.SetWorkingContent(this, this.isWorkingDeleted() ? undefined : this.getWorkingText());\n\t\t\tthis.file.SetTheirContent(this, this.isTheirDeleted() ? undefined : this.getTheirText());\n\t\t\treturn this.file.Save()\n\t\t\t.then(\n\t\t\t\t()=>{\n\t\t\t\t\tEBW.Toast(`Saved ${f.Path()}`);\n\t\t\t\t\treturn Promise.resolve(``);\n\t\t\t\t});\n\t\t}\n\t\treturn Promise.reject(`No file to save`);\n\t}\n\tFileEventListener(source:any, e:FileEvent, fc:FileContent) {\n\t\t// If we were ourselves the source of the event, we ignore it.\n\t\tif (source==this) {\n\t\t\treturn;\n\t\t}\n\t\tswitch (e) {\n\t\t\tcase FileEvent.WorkingChanged:\n\t\t\t\tthis.setWorkingText(fc.Raw);\n\t\t\t\tbreak;\n\t\t\tcase FileEvent.TheirChanged:\n\t\t\t\tthis.setTheirText(fc.Raw);\n\t\t\t\tbreak;\n\t\t\tcase FileEvent.StatusChanged:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\t// Merge starts merging a file.\n\tMerge(file:File) : void {\n\t\tconsole.log(`Merge: ${file.Path()}`);\n\t\tif (this.file && this.file.Path()==file.Path()) {\n\t\t\treturn;\t// Nothing to do if we're selecting the same file\n\t\t}\n\t\t// Save any file we're currently editing\n\t\tif (this.file) {\n\t\t\tthis.SaveFile();\n\t\t\tthis.file.Listen.remove(this.FileEventListener, this);\n\t\t}\n\t\t// Controls must receive update before we do.\n\t\t// TODO : Actually, the controls should listen to US, not to the\n\t\t// file, and we should have an 'EditorStateModel'...\n\t\tthis.controls.SetFile(file);\n\t\t// VERY importantly, we don't listen to the file \n\t\t// until after we've concluded the FetchContent, because\n\t\t// we won't have an editor to populate when FetchContent\n\t\t// sends its signals that the content has changed.\n\t\t// However, because we configure ourselves as the source,\n\t\t// if we were listening, it shouldn't be a problem...\n\t\tlet p = file.FetchContent(this)\n\t\t.then(\n\t\t\t()=>{\n\t\t\t\treturn Promise.all( [file.WorkingFile(), file.TheirFile()] );\n\t\t\t}\n\t\t)\n\t\t.then(\n\t\t\t(args:FileContent[]) => {\n\t\t\t\tlet [working,their] = [ args[0], args[1] ];\t\n\t\t\t\tthis.file = file;\n\n\t\t\t\tthis.file.Listen.add(this.FileEventListener, this);\n\n\t\t\t\tlet lhsText:string, rhsText:string;\n\t\t\t\tif (this.editLeft) {\n\t\t\t\t\tlhsText = working.Raw;\n\t\t\t\t\trhsText = their.Raw;\n\t\t\t\t} else {\n\t\t\t\t\tlhsText = their.Raw;\n\t\t\t\t\trhsText = working.Raw;\n\t\t\t\t}\n\n\t\t\t\t// Create a new Mergely Editor for each file\n\t\t\t\tthis.parent.textContent = ``;\n\t\t\t\tthis.mergelyDiv = document.createElement(`div`) as HTMLDivElement;\n\t\t\t\tthis.parent.appendChild(this.mergelyDiv);\n\t\t\t\tlet m = jQuery(this.mergelyDiv);\n\t\t\t\tm.mergely(\n\t\t\t\t{\n\t\t\t\t\tcmsettings : {\n\t\t\t\t\t\treadOnly: false, \n\t\t\t\t\t\tlineNumbers: true,\n\t\t\t\t\t\tlineWrapping: true,\n\t\t\t\t\t},\n\t\t\t\t\tlhs_cmsettings: {\n\t\t\t\t\t\treadOnly: (!this.editBoth) && (!this.editLeft)\n\t\t\t\t\t},\n\t\t\t\t\trhs_cmsettings: {\n\t\t\t\t\t\treadOnly: (!this.editBoth) && this.editLeft\n\t\t\t\t\t},\n\t\t\t\t\teditor_height: \"100%\",\n\t\t\t\t\tlhs: function(setValue:(v:string)=>void) {\n\t\t\t\t\t\tsetValue(lhsText);\n\t\t\t\t\t},\n\t\t\t\t\trhs: function(setValue:(v:string)=>void) {\n\t\t\t\t\t\tsetValue(rhsText);\n\t\t\t\t\t},\n\t\t\t\t});\t\n\t\t\t}\n\t\t);\n\t}\n\n}","import {MergeEditor} from './MergeEditor';\nimport {conflict_MergeInstructions as Template } from '../Templates';\n\nexport class MergeInstructions extends Template {\n\tconstructor(parent: HTMLElement, editor: MergeEditor) {\n\t\tsuper();\n\t\tif (!parent) {\n\t\t\treturn;\n\t\t}\n\t\tthis.$.theirSide.innerHTML = editor.TheirSide();\n\t\tthis.$.ourSide.innerHTML = editor.WorkingSide();\n\n\t\tthis.$.show.addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\tthis.el.classList.toggle(`showing`);\n\t\t});\n\n\t\tparent.appendChild(this.el);\n\t}\n}","import {CommitMessageDialog as Template} from './Templates';\nimport {DialogEvents as FoundationRevealDialogEvents, FoundationRevealDialog} from './FoundationRevealDialog';\n\nexport class CommitMessageDialogResult {\n\tNotes? : string;\n\tMessage?: string;\n\tCancelled: boolean;\n}\nexport class CommitMessageDialog extends Template {\n\tprotected resolve: (m:CommitMessageDialogResult)=>void;\n\tprotected dialog: FoundationRevealDialog;\n\tprotected clearOnOpen: boolean;\n\n\tconstructor(clearOnOpen: boolean) {\n\t\tsuper();\n\t\t\n\t\tthis.clearOnOpen = clearOnOpen;\n\n\t\tthis.dialog = new FoundationRevealDialog(undefined, this.el);\n\t\tthis.dialog.Events.add( this.dialogEvent, this );\n\n\t\tthis.$.commit.addEventListener(`click`, (evt:Event)=>{\n\t\t\tevt.stopPropagation(); evt.preventDefault();\n\t\t\tthis.resolve({\n\t\t\t\tMessage:this.$.message.value, \n\t\t\t\tNotes:``,\n\t\t\t\tCancelled: false});\n\t\t\tthis.resolve = undefined;\n\t\t\tthis.dialog.Close();\n\t\t});\n\t}\n\n\tdialogEvent(evt:FoundationRevealDialogEvents) {\n\t\tswitch (evt) { \n\t\t\tcase FoundationRevealDialogEvents.Closed:\n\t\t\t\t// If the commit button was pressed, we have resolved\n\t\t\t\t// the promise, and have cleared this.resolve\n\t\t\t\tif (this.resolve) {\n\t\t\t\t\tthis.resolve({Cancelled:true});\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\tcase FoundationRevealDialogEvents.Opened:\n\t\t\t\tif (this.clearOnOpen) {\n\t\t\t\t\tthis.$.message.value = ``;\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t};\n\t}\n\n\t// Open returns a Promise that will return a string[]. The string[]\n\t// will either contain two elements: \n\tOpen(title:string, instructions:string) : Promise<CommitMessageDialogResult> {\n\t\tthis.$.title.innerText = title;\n\t\tthis.$.instructions.innerText = instructions;\n\n\t\treturn new Promise<CommitMessageDialogResult>(\n\t\t\t(resolve,reject)=>{\n\t\t\t\tthis.resolve = resolve;\n\t\t\t\tthis.dialog.Open();\n\t\t\t});\n\t}\n}","import {conflict_ClosePRDialog as Template} from '../Templates';\nimport {DialogEvents as FoundationRevealDialogEvents, FoundationRevealDialog} from '../FoundationRevealDialog';\nimport {Eventify} from '../Eventify';\n\nexport class ClosePRDialogResult {\n\tClose? : boolean;\n\tCloseMessage?: string;\n\tCancelled: boolean;\n}\n\nexport class ClosePRDialog extends Template {\n\tprotected resolve: (m:ClosePRDialogResult)=>void;\n\tprotected dialog: FoundationRevealDialog;\n\tprotected clearOnOpen: boolean;\n\t// firstOpen is set false after the first time the dialog is opened.\n\t// This allows us to initialize default values iff this is the first usage,\n\t// or to go with the user's settings if this is not the first usage.\n\tprotected firstOpen = true;\n\n\tconstructor(clearOnOpen: boolean) {\n\t\tsuper();\n\t\t\n\t\tthis.clearOnOpen = clearOnOpen;\n\n\t\tthis.dialog = new FoundationRevealDialog(undefined, this.el);\n\t\tthis.dialog.Events.add( this.dialogEvent, this );\n\n\t\tEventify(this.el, {\n\t\t\t\"change\": (evt:Event) => {\n\t\t\t\tevt.stopPropagation(); evt.preventDefault();\n\t\t\t\tconsole.log(`Clicked `, evt.target);\n\t\t\t\tlet close = (evt.target as HTMLElement).getAttribute(\"value\")==\"yes\";\n\t\t\t\tif (close) {\n\t\t\t\t\tthis.$.closeMessage.removeAttribute('disabled');\n\t\t\t\t} else {\n\t\t\t\t\tthis.$.closeMessage.setAttribute('disabled','disabled');\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"done\": (evt:Event)=>{\n\t\t\t\tconsole.log(`done event`);\n\t\t\t\tevt.stopPropagation(); evt.preventDefault();\n\t\t\t\tthis.resolve({\n\t\t\t\t\tClose:this.$.closePR_yes.checked,\n\t\t\t\t\tCloseMessage:this.$.closeMessage.value, \n\t\t\t\t\tCancelled: false});\n\t\t\t\tthis.resolve = undefined;\n\t\t\t\tthis.dialog.Close();\n\t\t\t}\t\n\t\t});\n\t}\n\n\tdialogEvent(evt:FoundationRevealDialogEvents) {\n\t\tswitch (evt) { \n\t\t\tcase FoundationRevealDialogEvents.Closed:\n\t\t\t\t// If the commit button was pressed, we have resolved\n\t\t\t\t// the promise, and have cleared this.resolve\n\t\t\t\tif (this.resolve) {\n\t\t\t\t\tthis.resolve({Cancelled:true});\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\tcase FoundationRevealDialogEvents.Opened:\n\t\t\t\tif (this.clearOnOpen) {\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t};\n\t}\n\n\t// Open returns a Promise that will return a string[]. The string[]\n\t// will either contain two elements: \n\tOpen(title:string, instructions:string, defaultSetting?:ClosePRDialogResult) : Promise<ClosePRDialogResult> {\n\t\tthis.$.title.innerText = title;\n\t\tthis.$.instructions.innerText = instructions;\n\n\t\tif (defaultSetting && this.firstOpen) {\n\t\t\tthis.firstOpen = true;\n\t\t\tthis.$.closePR_yes.checked = defaultSetting.Close;\n\t\t\tthis.$.closePR_no.checked = !(this.$.closePR_yes.checked);\n\t\t\tif (this.$.closePR_yes.checked) {\n\t\t\t\tthis.$.closeMessage.removeAttribute(`disabled`);\n\t\t\t} else {\n\t\t\t\tthis.$.closeMessage.setAttribute(`disabled`,`disabled`);\n\t\t\t}\n\t\t}\n\t\tif (this.clearOnOpen) {\n\t\t\tthis.$.closePR_yes.checked = false;\n\t\t\tthis.$.closePR_no.checked = true;\n\t\t\tthis.$.closeMessage.setAttribute('disabled','disabled');\n\t\t}\n\n\t\treturn new Promise<ClosePRDialogResult>(\n\t\t\t(resolve,reject)=>{\n\t\t\t\tthis.resolve = resolve;\n\t\t\t\tthis.dialog.Open();\n\t\t\t});\n\t}\n}","\n// MergingInfo is the typescript equivalent of the EBWRepoStatus which provides\n// some information on how the repo came to be in a conflict state.\nexport class MergingInfo {\n\tpublic PRNumber : number;\n\tpublic Description: string;\n\n\tconstructor(dataEl?:HTMLElement) {\n\t\tif (!dataEl) {\n\t\t\tdataEl = document.getElementById(`merging-info`);\n\t\t}\n\t\tlet js : any = JSON.parse(dataEl.innerText);\n\t\tthis.PRNumber = js.MergingPRNumber;\n\t\tthis.Description = js.MergingDescription;\n\t}\n\n\tIsPRMerge() : boolean {\n\t\treturn (0 < this.PRNumber);\n\t}\n}","import {ConflictEditor} from './ConflictEditor';\nimport {Context} from '../Context';\nimport {EBW} from '../EBW';\nimport {File,FileEvent,FileContent} from './File';\nimport {MergeEditorControlBar,MergeEditorAction} from './MergeEditorControlBar';\n\nimport signals = require('signals');\nimport CodeMirror = require('codemirror');\nimport {EditorCodeMirror} from '../EditorCodeMirror';\n\nexport class SingleEditor implements ConflictEditor {\n\tpublic Listen:signals.Signal;\n\tprotected file:File;\n\tprotected editor:EditorCodeMirror;\n\tprotected isDeleted:boolean;\n\tprotected controls:MergeEditorControlBar;\n\n\tconstructor(protected context:Context,\n\t\tprotected parent:HTMLElement) {\n\t\tthis.Listen = new signals.Signal();\n\t\tthis.editor = new EditorCodeMirror(parent);\n\n\t\tthis.controls = new MergeEditorControlBar();\n\t\tthis.controls.Listen.add(this.controlAction, this);\t\t\n\t}\n\n\tcontrolAction(act:MergeEditorAction) {\n\t\tswitch(act) {\n\t\t\tcase MergeEditorAction.Save:\n\t\t\t\tthis.SaveFile()\n\t\t\t\t.catch( EBW.Error );\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.Delete:\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.Resolve:\n\t\t\t\tthis.SaveFile()\n\t\t\t\t.then(\n\t\t\t\t\t()=>{\n\t\t\t\t\t\t// undefined so we receive notifications\n\t\t\t\t\t\treturn this.file.Stage(undefined);\n\t\t\t\t\t})\n\t\t\t\t.then(\n\t\t\t\t\t()=>{\n\t\t\t\t\t\tEBW.Toast(`Resolved changes on ${this.file.Path()}`);\n\t\t\t\t\t})\n\t\t\t\t.catch(EBW.Error);\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.RevertOur:\n\t\t\t\tthis.file.RevertOur(undefined);\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.RevertTheir:\n\t\t\t\tthis.file.RevertOurToTheir(undefined);\n\t\t\t\tbreak;\n\t\t\tcase MergeEditorAction.RevertGit:\n\t\t\t\tthis.file.RevertOurToGit(undefined);\n\t\t\t\tbreak;\n\t\t}\n\t}\t\n\tWorkingSide():string {\n\t\treturn \"-\";\n\t}\n\tTheirSide():string {\n\t\treturn '-';\n\t}\n\tgetWorkingText() : string {\n\t\treturn this.editor.getValue();\n\t}\n\tsetWorkingText(s:string) : void{\n\t\tthis.editor.setValue(s);\n\t}\n\tisWorkingDeleted() : boolean {\n\t\treturn this.isDeleted;\n\t}\n\tSaveFile() : Promise<string> {\n\t\tif (this.file) {\n\t\t\tlet f = this.file;\n\t\t\tlet w = this.getWorkingText();\n\t\t\t// We pass ourselves as the source, so that we don't update\n\t\t\t// our editor when the change event arrives\n\t\t\tthis.file.SetWorkingContent(this, this.isWorkingDeleted() ? undefined : \n\t\t\t\tthis.getWorkingText());\n\n\t\t\treturn this.file.Save()\n\t\t\t.then(\n\t\t\t\t()=>{\n\t\t\t\t\tEBW.Toast(`Saved ${f.Path()}`);\n\t\t\t\t\treturn Promise.resolve(``);\n\t\t\t\t});\n\t\t}\n\t\treturn Promise.reject(`No file to save`);\n\t}\n\tFileEventListener(source:any, e:FileEvent, fc:FileContent) : void {\n\t\t// If we were ourselves the source of the event, we ignore it.\n\t\tif (source==this) {\n\t\t\treturn;\n\t\t}\n\t\tswitch (e) {\n\t\t\tcase FileEvent.WorkingChanged:\n\t\t\t\tthis.setWorkingText(fc.Raw);\n\t\t\t\tbreak;\n\t\t\tcase FileEvent.StatusChanged:\n\t\t\t\tbreak;\n\t\t}\n\t}\n\t// Merge starts merging a file.\n\tMerge(file:File) : void {\n\t\tconsole.log(`Merge: ${file.Path()}`);\n\t\tif (this.file && this.file.Path()==file.Path()) {\n\t\t\treturn;\t// Nothing to do if we're selecting the same file\n\t\t}\n\t\t// Save any file we're currently editing\n\t\tif (this.file) {\n\t\t\tthis.SaveFile();\n\t\t\tthis.file.Listen.remove(this.FileEventListener, this);\n\t\t\tthis.file = undefined;\n\t\t}\n\t\t// Controls must receive update before we do.\n\t\t// TODO : Actually, the controls should listen to US, not to the\n\t\t// file, and we should have an 'EditorStateModel'...\n\t\t\n\t\t//this.controls.SetFile(file);\n\n\t\t// VERY importantly, we don't listen to the file \n\t\t// until after we've concluded the FetchContent, because\n\t\t// we won't have an editor to populate when FetchContent\n\t\t// sends its signals that the content has changed.\n\t\t// However, because we configure ourselves as the source,\n\t\t// if we were listening, it shouldn't be a problem...\n\t\tlet p = file.FetchContent(this)\n\t\t.then(\n\t\t\t()=>{\n\t\t\t\treturn Promise.all( [file.WorkingFile(), file.TheirFile()] );\n\t\t\t}\n\t\t)\n\t\t.then(\n\t\t\t(args:FileContent[]) => {\n\t\t\t\tlet [working,their] = [ args[0], args[1] ];\t\n\t\t\t\tthis.file = file;\n\n\t\t\t\tthis.file.Listen.add(this.FileEventListener, this);\n\t\t\t\tconsole.log(`About to set file contents to `, working.Raw);\n\t\t\t\tif (working.Exists) {\n\t\t\t\t\tthis.editor.setValue(working.Raw);\n\t\t\t\t} else {\n\t\t\t\t\tthis.editor.setValue(``);\n\t\t\t\t}\n\t\t\t\tthis.editor.setModeOnFilename(file.Path());\n\t\t\t}\n\t\t);\n\t}\n}","\nimport {ConflictEditor} from './conflict/ConflictEditor';\nimport {Context} from './Context';\nimport {ControlTag} from './ControlTag';\nimport {EBW} from './EBW';\nimport {File} from './conflict/File';\nimport {FileList} from './conflict/FileList';\nimport {FileListDisplayEvent, FileListDisplay} from './conflict/FileListDisplay';\nimport {MergeEditor} from './conflict/MergeEditor';\nimport {MergeInstructions} from './conflict/MergeInstructions';\nimport {CommitMessageDialogResult, CommitMessageDialog} from './CommitMessageDialog';\nimport {ClosePRDialog, ClosePRDialogResult} from './conflict/ClosePRDialog';\nimport {MergingInfo} from './conflict/MergingInfo';\nimport {SingleEditor} from './conflict/SingleEditor';\n\n// RepoConflictPage handles conflict-merging for the repo.\n// It's main data is generated in public/repo_conflict.html\nexport class RepoConflictPage {\n\tprotected editor: ConflictEditor;\n\tprotected commitDialog: CommitMessageDialog;\n\tprotected closePRDialog: ClosePRDialog;\n\tprotected mergingInfo: MergingInfo;\n\n\tconstructor(protected context:Context) {\n\t\tthis.mergingInfo = new MergingInfo(document.getElementById(`merging-info`));\n\t\tthis.closePRDialog = new ClosePRDialog(false);\n\n\t\tlet fileList = new FileList(context);\n\t\tlet fileListDisplay = new FileListDisplay(context, document.getElementById(`staged-files-list`), fileList, this.mergingInfo);\n\n\t\tfileListDisplay.el.addEventListener(`file-click`, (evt:CustomEvent)=> {\n\t\t\tthis.fileListEvent(undefined, evt.detail.file);\n\t\t});\n\n\t\tconsole.log(`mergingInfo = `, this.mergingInfo);\n\t\tif (this.mergingInfo.IsPRMerge()) {\n\t\t\tconsole.log(`THIS MERGE IS A PR MERGE`);\n\t\t\tthis.editor = new MergeEditor(context, document.getElementById(`editor-work`));\n\t\t\tnew MergeInstructions(document.getElementById('merge-instructions'), this.editor as MergeEditor);\n\t\t} else {\n\t\t\tlet work = document.getElementById(`editor-work`);\n\t\t\tthis.editor = new SingleEditor(context, work);\n\t\t}\n\t\t// items to be hidden in a PR merge or a not-pr-merge are controlled\n\t\t// by CSS visibility based on whether they have a .pr-merge or .not-pr-merge\n\t\t// class\n\t\t\n\t\tthis.commitDialog = new CommitMessageDialog(false);\n\n\t\tnew ControlTag(document.getElementById(`files-show-tag`),\n\t\t\t(showing:boolean)=>{\n\t\t\t\tlet el = document.getElementById(`files`);\n\t\t\t\tif (showing)\n\t\t\t\t\tel.classList.add(`showing`);\n\t\t\t\telse\n\t\t\t\t\tel.classList.remove(`showing`);\t\t\t\t\n\t\t\t\t// el\n\t\t\t\t// .style.width = showing ? \"30em\":\"0px\";\n\t\t\t});\n\n\n\t\tlet filesEl = document.getElementById('staged-files-data');\n\t\tif (!filesEl) {\n\t\t\tEBW.Error(`FAILED TO FIND #staged-files-data: cannot instantiate RepoConflictPage`);\n\t\t\treturn;\n\t\t}\n\t\tlet listjs = filesEl.innerText;\n\t\tlet fileListData = JSON.parse(listjs);\n\t\tconsole.log(`Loaded fileList: `, fileListData);\n\t\tfileList.load(fileListData);\n\n\t\tdocument.getElementById(`action-commit`).addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\t// TODO: Should check whether editor should save before committing.\n\t\t\tthis.commitDialog.Open(`Resolve Conflict`, `The merge will be resolved.`)\n\t\t\t.then(\n\t\t\t\t(r:CommitMessageDialogResult) => {\n\t\t\t\t\tif (r.Cancelled) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconsole.log(`Result= `, r);\n\t\t\t\t\tthis.context.RepoRedirect(`conflict/resolve`, \n\t\t\t\t\t\tnew Map([[`message`,r.Message],[`notes`,r.Notes]])\n\t\t\t\t\t);\n\t\t\t\t\treturn;\n\t\t\t\t})\n\t\t\t.catch (EBW.Error);\n\t\t});\n\t\tdocument.getElementById(`action-abort`).addEventListener(`click`, (evt)=>{\n\t\t\tevt.preventDefault(); evt.stopPropagation();\n\t\t\tif (this.mergingInfo.IsPRMerge()) {\n\t\t\t\tthis.closePRDialog.Open(`Close PR`,\n\t\t\t\t\t`You have been merging PR ${this.mergingInfo.PRNumber}.\n\t\t\t\t\tDo you want to close the PR?`, \n\t\t\t\t\t{Close: false, CloseMessage:\"\", Cancelled: false})\n\t\t\t\t.then(\n\t\t\t\t\t(r:ClosePRDialogResult)=>{\n\t\t\t\t\t\tif (r.Cancelled) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.context.RepoRedirect(`conflict/abort`, \n\t\t\t\t\t\t\tnew Map([[`message`,r.CloseMessage],\n\t\t\t\t\t\t\t\t[`close`,r.Close]])\n\t\t\t\t\t\t);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t})\n\t\t\t\t.catch( EBW.Error );\n\t\t\t} else {\t\t\t\t\n\t\t\t\tthis.context.RepoRedirect(`conflict/abort`);\n\t\t\t}\n\t\t})\n\t}\n\tfileListEvent(e:FileListDisplayEvent, f:File) : void {\n\t\tthis.editor.Merge(f);\n\t}\n}","import {EBW} from './EBW';\nimport {Eventify} from './Eventify';\nimport {MergeEditor as Template} from './Templates';\nimport {PRDiffModel} from './PRDiffModel';\nimport {AddToParent} from './DOM';\nimport jQuery = require('jquery');\n\nexport class MergeEditor extends Template {\n\tprotected mergelyDiv: HTMLDivElement;\n\n\tconstructor(\n\t\tprotected parent:HTMLElement, \n\t\tprotected model:PRDiffModel) \n\t{\n\t\tsuper();\n\t\tEventify(this.el, {\n\t\t\t'save': (evt:any)=>{\n\t\t\t\tevt.preventDefault();\n\t\t\t\tmodel.Update(this.get())\n\t\t\t\t.catch( err=>{\n\t\t\t\t\tconsole.log(`Error on the save function`);\n\t\t\t\t\tEBW.Error(err);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\tAddToParent(this.parent, this.el);\t\t\n\n\t\tmodel.GetContent()\n\t\t.then( (args)=>this.mergely(args) )\n\t\t.catch( EBW.Error );\n\t}\n\tget() : string {\n\t\tlet cm = jQuery(this.mergelyDiv).mergely('cm', 'lhs');\n\t\treturn cm.getDoc().getValue();\n\t}\n\tmergely([local, remote, diff]:[string,string,string]) : void {\n\t\tthis.$.mergely.textContent= ``;\n\t\tthis.mergelyDiv = document.createElement(`div`) as HTMLDivElement;\n\t\tthis.$.mergely.appendChild(this.mergelyDiv);\n\t\tlet m = jQuery(this.mergelyDiv);\n\t\tm.mergely({\n\t\t\tcmsettings: { \n\t\t\t\treadOnly: false, \n\t\t\t\tlineNumbers: true,\n\t\t\t\twrap_lines: true,\n\t\t\t},\n\t\t\trhs_cmsettings: {\n\t\t\t\t// readOnly: true,\n\t\t\t},\n\t\t\t// editor_height: \"40em\",\n\t\t\tautoresize: true,\n\t\t\teditor_height: \"100%\",\n\t\t\t// editor_width: \"48%\",\n\t\t\twrap_lines: true,\n\t\t\tlhs: function(setValue:(v:string)=>void) {\n\t\t\t\tsetValue(local);\n\t\t\t},\n\t\t\trhs: function(setValue:(v:string)=>void) {\n\t\t\t\tsetValue(remote);\n\t\t\t},\n\t\t\theight: (h:number)=>{\n\t\t\t\treturn this.$.mergely.clientHeight + \"px\";\n\t\t\t},\n\t\t\twidth: (w:number)=>{\n\t\t\t\treturn this.$.mergely.clientWidth + \"px\";\n\t\t\t}\n\t\t});\n\t\tlet right = jQuery(this.mergelyDiv).mergely('cm', 'rhs');\n\t\tconsole.log('right hand cm = ', right);\n\t}\t\n}","import {EBW} from './EBW';\nimport {API} from './API';\nimport {PRArgs} from './PRArgs';\n\nimport signals = require('signals');\n\n/**\n * PRDiffModel provides a model of a single diff\n * between local and remote\n * diff =  Object { \n *    path: \"book/text/01.md\", \n *    remote_path: \"/home/craig/proj/ebw/git_cache/pr_r…\", \n *    remote_hash: \"e9c882ca90909485619b340312151904146…\", \n *    local_path: \"/home/craig/proj/ebw/git_cache/repo…\", \n *    local_hash: \"b73db84fa8269f29c7a5daade4bd21731f5…\",\n *    equal: false \n * }\n */\ninterface Diff {\n\tpath: string;\n\tremote_path: string;\n\tremote_hash: string;\n\tlocal_path: string;\n\tlocal_hash: string;\n\tequal: boolean;\n}\n\nexport class PRDiffModel {\n\tpublic DirtySignal : signals.Signal;\n\tpublic EditingSignal : signals.Signal;\n\n\tconstructor(\n\t\tprotected diff: Diff,\n\t\tprotected prArgs: PRArgs) \n\t{\n\n\t\tthis.DirtySignal = new signals.Signal();\n\t\tthis.EditingSignal = new signals.Signal();\n\t}\n\tpath() : string {\n\t\treturn this.diff.path;\n\t}\n\tkey() : string {\n\t\treturn this.diff.remote_hash + \":\" + this.diff.local_hash;\n\t}\n\torigKey():string {\n\t\treturn this.key + '-original';\n\t}\n\tGetContent() : Promise<any> {\n\t\tconsole.log(`calling API.PullRequestVersions(`,\n\t\t\tJSON.stringify(this.prArgs) , this.diff.path, `)`);\n\n\t\treturn EBW.API().PullRequestVersions(\n\t\t\tthis.prArgs.repoOwner,\n\t\t\tthis.prArgs.repoName,\n\t\t\tthis.prArgs.remoteURL,\n\t\t\tthis.prArgs.remoteSHA,\n\t\t\tthis.diff.path);\n\t}\n\tUpdate(content:string):Promise<void> {\n\t\treturn EBW.API().PullRequestUpdate(\n\t\t\tthis.prArgs.repoOwner,\n\t\t\tthis.prArgs.repoName,\n\t\t\tthis.prArgs.remoteSHA,\n\t\t\tthis.diff.path,\n\t\t\tcontent);\n\t}\n}","import {PullRequestDiffList_File as Template} from './Templates';\nimport {PRDiffModel} from './PRDiffModel';\n\ninterface Callback {\n\t(d:PRDiffModel):void;\n}\n\nexport class PullRequestDiffList_File extends Template {\n\tconstructor(\n\t\tprotected parent:HTMLElement, \n\t\tprotected diff: PRDiffModel,\n\t\tprotected callback: Callback) {\n\t\tsuper();\n\t\tthis.el.textContent = diff.path();\n\t\tthis.el.addEventListener('click', (evt)=>{\n\t\t\tthis.callback(this.diff);\n\t\t});\n\t\tparent.appendChild(this.el);\n\t}\n}","import {MergeEditor} from './MergeEditor';\nimport {PRArgs} from './PRArgs';\nimport {PRDiffModel} from './PRDiffModel';\nimport {PullRequestDiffList_File} from './PullRequestDiffList_File';\n\nexport class PullRequestMergePage {\n\tprotected files: PRDiffModel[];\n\tprotected filesEL: HTMLElement;\n\n\tconstructor(\n\t\t diffs: any[],\n\t\t protected prArgs:any, \n\t\t protected filesParent: HTMLElement,\n\t\t protected mergelyParent:HTMLElement)\n\t{\n\t\tthis.files = [];\n\t\tif (!this.filesParent) {\n\t\t\talert(`PullRequestMergePage called, but filesParent is undefined`);\n\t\t\tdebugger;\n\t\t}\n\t\tfor (let d of diffs) {\n\t\t\tlet diff = new PRDiffModel(d, prArgs);\n\t\t\tthis.files.push(diff);\n\t\t\tnew PullRequestDiffList_File(\n\t\t\t\tthis.filesParent,\n\t\t\t\tdiff,\n\t\t\t\t(d)=>{\n\t\t\t\t\tthis.viewDiff(d);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t}\n\n\tviewDiff(diff:PRDiffModel):void {\n\t\tthis.mergelyParent.textContent='';\n\t\tnew MergeEditor(this.mergelyParent, diff);\n\t}\n\tstatic instantiate():void {\n\t\tlet pr = document.getElementById('pr-merge-page');\n\t\tif (pr) {\n\t\t\tnew PullRequestMergePage(\n\t\t\t\tJSON.parse(pr.textContent),\n\t\t\t\t{\n\t\t\t\t\trepoOwner: pr.getAttribute(`repo-owner`),\n\t\t\t\t\trepoName: pr.getAttribute(`repo-name`),\n\t\t\t\t\tremoteURL: pr.getAttribute(`remote-url`),\n\t\t\t\t\tremoteSHA: pr.getAttribute(`remote-sha`)\n\t\t\t\t}, \n\t\t\t\tdocument.getElementById(`pr-files-list`),\n\t\t\t\tdocument.getElementById(`mergely-container`)\n\t\t\t);\n\t\t}\n\t}\n\n}","type insertFunction = (el:HTMLElement)=>void;\n\n\nexport class DOMInsert {\n\tconstructor(protected parent:HTMLElement|insertFunction) {\n\n\t}\n\tInsert(el:HTMLElement):void {\n\t\tif ('function'==typeof this.parent) {\n\t\t\tthis.parent(el);\n\t\t} else {\n\t\t\tthis.parent.appendChild(el);\n\t\t}\n\t}\n}","import {Context} from './Context';\nimport {EBW} from './EBW';\nimport {DOMInsert} from './DOMInsert';\nimport {RepoFileViewerFile as Template} from './Templates';\nimport {RepoFileViewerPage} from './RepoFileViewerPage';\n\nexport class RepoFileViewerFile extends Template {\n\t// version allows us to force browser-reload\n\tprotected version: number;\n\tRefresh() : void {\n\t\tlet src = `/img/plus.svg`;\n\t\tif (``!=this.filename) {\n\t\t\tsrc = `/www/${this.context.RepoOwner}/${this.context.RepoName}/${this.filename}?v=` + (this.version++);\n\t\t}\n\t\tthis.$.img.setAttribute('src', src);\n\t}\n\tFilename() : string {\n\t\treturn this.filename;\n\t}\n\t// IsAddButton returns true if this RepoFileViewerFile is in fact just the generic\n\t// 'add a new file' button\n\tIsAddButton() : boolean {\n\t\treturn ``==this.filename;\n\t}\n\n\tconstructor(protected context:Context, protected filename:string, parent:DOMInsert, protected page: RepoFileViewerPage) {\n\t\tsuper();\n\t\tthis.version = 1;\n\t\tthis.Refresh();\n\t\tthis.$.filename.textContent = this.filename ? this.filename : `Drop a file to upload.`;\n\t\tparent.Insert(this.el);\n\n\t\tthis.el.addEventListener('drop', (evt)=>{\n\t\t\tevt.preventDefault();\t\n\t\t\t// Necessary so the browser doesn't just display the dropped item\n\t\t\tconsole.log(`Going to run this.page.FileDrop`);\n\t\t\tthis.page.FileDrop(this, evt);\n\t\t});\n\t\tthis.el.addEventListener('drag', (evt)=>{\n\t\t});\n\t\tthis.el.addEventListener('dragover', (evt)=>{\n\t\t\tevt.preventDefault();\n\t\t});\n\t\tthis.el.addEventListener(`dragend`,(evt:DragEvent)=>{\n\t\t\tevt.preventDefault();\n\t\t\tlet dt = evt.dataTransfer;\n\t\t\tconsole.log(`dragend: dt = `, dt);\n\t\t\tif (dt.items) {\n\t\t\t\tfor (let i=0; i<dt.items.length; i++) {\n\t\t\t\t\tdt.items.remove(i);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdt.clearData();\n\t\t\t}\n\t\t});\n\t}\n}","import {Context} from './Context';\nimport {DOMInsert} from './DOMInsert';\nimport {EBW} from './EBW';\nimport {RepoFileViewerPage as Template} from './Templates';\nimport {RepoFileViewerFile} from './RepoFileViewerFile';\n\ninterface EditFieldListener {\n\tValueChanged(v:string):void;\n}\n\nclass EditField {\n\tprotected value:string;\n\tconstructor(protected el:HTMLInputElement, protected page:EditFieldListener) {\n\t\tthis.value = el.value;\n\t\tthis.el.addEventListener(`keyup`, (evt)=>{\n\t\t\tlet v = el.value;\n\t\t\tif (v!=this.value) {\n\t\t\t\tthis.value = v;\n\t\t\t\tpage.ValueChanged(v);\n\t\t\t}\n\t\t});\n\t}\n}\n\ninterface LoadFilesListener {\n\tFilesFound(files:string[]):void;\n}\n\nclass LoadFiles {\n\tprotected searchingFor: string;\n\tconstructor(protected context:Context, protected listener:LoadFilesListener){}\n\tSearch(s:string):void {\n\t\tconsole.log(`LoadFiles.Search(${s})`);\n\t\tthis.searchingFor = s;\n\t\tEBW.API()\n\t\t.SearchForFiles(this.context.RepoOwner, this.context.RepoName, s)\n\t\t.then(\n\t\t\t([search, files]:[string, string[]])=>{\t\t\t\t\n\t\t\t\tif (search!=this.searchingFor) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tthis.listener.FilesFound(files);\n\t\t\t});\n\t}\n}\n\nexport class RepoFileViewerPage extends Template implements EditFieldListener {\n\tprotected loadFiles : LoadFiles;\n\tprotected inserter: DOMInsert;\n\tprotected add: RepoFileViewerFile;\n\n\tconstructor(protected context:Context, parent:HTMLElement) {\n\t\tsuper();\n\t\tthis.add = new RepoFileViewerFile(this.context, ``, new DOMInsert(this.$.data), this);\n\t\tthis.inserter = new DOMInsert( (el:HTMLElement)=>{\n\t\t\tthis.$.data.insertBefore(el, this.add.el);\n\t\t});\n\t\tparent.appendChild(this.el);\n\t\tthis.$.search.focus();\n\t\tthis.loadFiles = new LoadFiles(context, this);\n\t\tnew EditField(this.$.search, this);\n\n\t}\n\tValueChanged(s:string):void {\n\t\ts = s + `.*\\\\.(png|jpg|jpeg|svg|gif|tiff)$`\n\t\tthis.loadFiles.Search(s);\n\t}\n\tFilesFound(files:string[]):void {\n\t\tconsole.log(`FilesFound: `, files);\n\t\tlet e = this.$.data.firstChild;\n\t\twhile (e) {\n\t\t\tlet next = e.nextSibling;\n\t\t\tif (e!=this.add.el) {\n\t\t\t\tthis.$.data.removeChild(e);\n\t\t\t}\n\t\t\te = next;\n\t\t}\n\t\tfor (let f of files) {\n\t\t\tnew RepoFileViewerFile(this.context, f, this.inserter, this);\n\t\t}\n\t}\n\t_uploadFile(src:RepoFileViewerFile, file:any) : void {\n\t\t// READ THE FILE\n\t\tlet reader = new FileReader();\n\t\treader.addEventListener(`loadend`, (evt)=>{\n\t\t\t//console.log(`READ file. result=`, reader.result);\n\t\t\t//console.log(`Replacing file ${this.filename} with result`);\n\t\t\tlet u8 = new Uint8Array(reader.result);\t//Uint8Array.from(reader.result);\n\t\t\t//console.log(`u8 = `, u8);\n\t\t\tlet blen = u8.byteLength;\n\t\t\t//console.log(`blen = `, blen);\n\t\t\tlet binary = ``;\n\t\t\tfor (let i=0; i<blen; i++) {\n\t\t\t\tbinary += String.fromCharCode( u8[i] );\n\t\t\t}\n\t\t\tlet p : Promise<string>;\n\t\t\tif (``!=src.Filename()) {\n\t\t\t\tp = Promise.resolve<string>(src.Filename());\n\t\t\t} else {\n\t\t\t\tp = EBW.Prompt(`Enter full path and filename for uploaded file.`);\n\t\t\t}\n\t\t\tp.then(\n\t\t\t\t(s:string)=>{\n\t\t\t\t\tif (``==s) return Promise.resolve<string>(``);\n\t\t\t\t\treturn EBW.API().UpdateFileBinary(this.context.RepoOwner, this.context.RepoName, s, window.btoa(binary))\n\t\t\t\t\t.then(\n\t\t\t\t\t\t()=>{\n\t\t\t\t\t\t\treturn Promise.resolve<string>(s);\n\t\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t.then(\n\t\t\t\t(s:string)=>{\n\t\t\t\t\tif (``!=s) {\n\t\t\t\t\t\tif (!src.IsAddButton()) {\n\t\t\t\t\t\t\tsrc.Refresh();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnew RepoFileViewerFile(this.context, s, this.inserter, this);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tEBW.Toast(`Image uploaded`);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t.catch(\n\t\t\t\tEBW.Error\n\t\t\t);\n\t\t});\n\t\treader.readAsArrayBuffer(file);\n\t}\n\tFileDrop(src:RepoFileViewerFile, evt:any) {\n\t\tlet dt = evt.dataTransfer;\n\t\tconsole.log(`dt = `, dt);\n\t\tif (dt.items) {\n\t\t\tfor (let i=0; i<dt.items.length; i++) {\n\t\t\t\tlet item = dt.items[i] as DataTransferItem;\n\t\t\t\tif (item.kind == `file`) {\n\t\t\t\t\t//console.log(`filename = `, item.name);\n\t\t\t\t}\n\t\t\t\tthis._uploadFile(src,item.getAsFile());\n\t\t\t}\n\t\t} else {\n\t\t\tconsole.log(`dt.files = `, dt.files);\n\n\t\t\tfor (let i=0; i<dt.files.length; i++) {\n\t\t\t\tlet file = dt.files[i];\n\t\t\t\tlet imageType = /^image\\//;\n\t\t\t\tif (!imageType.test(file.type)) {\n\t\t\t\t\talert(`You can only upload image files with this form.`);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tthis._uploadFile(src, file);\n\t\t\t}\n\t\t}\n\t}\n}","import {API} from './API';\nimport {APIWs} from './APIWs';\nimport {Context} from './Context';\nimport {Toast} from './Toast';\nimport {AddNewBookDialog} from './AddNewBookDialog';\nimport {LoginTokenList} from './LoginTokenList';\nimport {RepoDetailPage} from './RepoDetailPage';\nimport {RepoEditorPage} from './RepoEditorPage';\nimport {RepoConflictPage} from './RepoConflictPage';\nimport {QuerySelectorAllIterate} from './querySelectorAll-extensions';\nimport {PullRequestMergePage} from './PullRequestMergePage';\nimport {RepoFileViewerPage} from './RepoFileViewerPage';\n\nexport class EBW {\n\tstatic instance : EBW;\n\tprotected api : API;\n\tconstructor() {\n\t\tif (null==EBW.instance) {\n\t\t\tEBW.instance = this;\n\t\t\tthis.api = new APIWs();\n\t\t\tjQuery(document).foundation();\n\t\t\tLoginTokenList.init();\n\n\t\t\tlet el = document.getElementById(`ebw-context`);\n\t\t\tlet context : Context;\n\t\t\tif (el) {\n\t\t\t\tcontext = new Context(el, el.getAttribute(`data-repo-owner`),\n\t\t\t\t\tel.getAttribute(`data-repo-name`));\n\t\t\t\tswitch (el.getAttribute('data-page')) {\n\t\t\t\t\tcase 'RepoDetailPage':\n\t\t\t\t\t\tnew RepoDetailPage(context);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'RepoConflictPage':\n\t\t\t\t\t\tnew RepoConflictPage(context);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase 'RepoFileViewerPage':\n\t\t\t\t\t\tconsole.log(`Creating RepoFileViewerPage`); \n\t\t\t\t\t\tnew RepoFileViewerPage(context, document.getElementById(`repo-file-viewer`) as HTMLElement);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\t/* TODO: This should actually use a Router\n\t\t\t   to determine what content we have. */\n\t\t\tAddNewBookDialog.instantiate();\n\t\t\tRepoEditorPage.instantiate();\n\t\t\tPullRequestMergePage.instantiate();\n\t\t}\n\t\treturn EBW.instance;\n\t}\n\tstatic API() : API {\n\t\tlet ebw = new EBW();\n\t\treturn ebw.api;\n\t}\n\tstatic Error(err : any) : void {\n\t\tconsole.error('ERROR: ', err);\n\t\tdebugger;\n\t\talert(err);\n\t}\n\tstatic Alert(msg:string) : Promise<void> {\n\t\talert(msg);\n\t\treturn Promise.resolve();\n\t}\n\tstatic Toast(msg : string, ...args:string[]) : void {\n\t\tToast.Show(msg + args.join(' '));\n\t}\n\tstatic Prompt(msg: string) : Promise<string> {\n\t\tlet r : string = prompt(msg);\n\t\treturn Promise.resolve<string>(r);\n\t}\n\tstatic Confirm(msg:string) : Promise<boolean> {\n\t\treturn Promise.resolve<boolean>(confirm(msg));\n\t}\n\t// flatten takes returns a function that accepts an \n\t// array of arguments, and calls the callback function\n\t// with each array element as a distinct parameter.\n\tstatic flatten(callback:any, context?:any) {\n\t\treturn function(argsArray:any[]) {\n\t\t\tcallback.apply(context, argsArray);\n\t\t}\n\t}\t\t\n}\n\ndocument.addEventListener('DOMContentLoaded', function() {\n\tconsole.log(`DOMContentLoaded - EBW`);\n\tnew EBW();\n});"],"names":["tslib_1.__extends","AddNewBookDialog","Template","LoginTokenList","TSFoundation.Reveal","FoundationRevealDialog","FileListDialog","FoundationRevealDialogEvents","BoundFilename","EditorImage","RepoFileEditorCM","Dialog","FSFileList_File","RepoEditorPage_NewFileDialog","RepoEditorPage_RenameFileDialog","FileContent","File","CommitMessageDialog","MergeEditor","PullRequestDiffList_File","RepoFileViewerFile","RepoFileViewerPage"],"mappings":"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"}